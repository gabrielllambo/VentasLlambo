<div class="flex flex-col md:min-w-200 max -m-6 height-dialog">
    <!-- Header -->
    <div class="flex flex-0 items-center justify-between h-16 pr-3 sm:pr-5 pl-6 sm:pl-8 bg-primary text-on-primary">
        <div class="text-lg font-medium">Detalle Compra Nro. {{numeroCompra}}</div>
        <button mat-icon-button [tabIndex]="-1" (click)="cerrarVentanaEmergente()">
            <mat-icon class="text-current" svgIcon="heroicons_outline:x-mark"></mat-icon>
        </button>
    </div>

    <div class="flex flex-col flex-auto w-full">
        <div class="grid grid-cols-1 xl:grid-cols-1 gap-8 w-full mt-6">

            <!-- Tabla -->
            <div class="xl:col-span-1 flex flex-col flex-auto bg-card shadow rounded-2xl overflow-hidden">
                <div class="overflow-x-auto mx-6">
                    <table class="w-full bg-transparent mb-3" mat-table matSort [dataSource]="pageSlice"
                        [trackBy]="trackByFn" #detalleCompraTable>

                        <!-- Imagen -->
                        <ng-container matColumnDef="urlfotoproducto">
                            <th mat-header-cell *matHeaderCellDef>Imagen</th>
                            <td mat-cell *matCellDef="let item" class="min-w-10">
                                <div class="flex items-center">
                                    <div
                                        class="relative flex items-center justify-center w-12 h-12 mr-6 rounded overflow-hidden border">
                                        <img *ngIf="item.urlFotoProducto" [alt]="'Imagen de ' + item.nombreProducto"
                                            [src]="item.urlFotoProducto" class="w-full h-full object-cover">
                                        <div *ngIf="!item.urlFotoProducto"
                                            class="flex items-center justify-center w-full h-full text-xs font-semibold leading-none text-center uppercase bg-gray-200">
                                            SIN IMAGEN
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </ng-container>

                        <!-- Nombre Producto -->
                        <ng-container matColumnDef="nombreproducto">
                            <th mat-header-cell mat-sort-header *matHeaderCellDef>Nombre Producto</th>
                            <td mat-cell *matCellDef="let item" class="min-w-30">
                                <span class="flex items-center">
                                    <span class="ml-3 leading-4">{{item.nombreProducto}}</span>
                                </span>
                            </td>
                        </ng-container>

                        <!-- Categoría -->
                        <ng-container matColumnDef="nombrecategoria">
                            <th mat-header-cell mat-sort-header *matHeaderCellDef>Categoría</th>
                            <td mat-cell *matCellDef="let item" class="min-w-30">
                                <span class="flex items-center">
                                    <span class="w-2 h-2 rounded-full"
                                        [style.backgroundColor]="item.colorCategoria"></span>
                                    <span class="ml-3">{{item.nombreCategoria}}</span>
                                </span>
                            </td>
                        </ng-container>

                        <!-- Marca -->
                        <ng-container matColumnDef="nombremarca">
                            <th mat-header-cell mat-sort-header *matHeaderCellDef>Marca</th>
                            <td mat-cell *matCellDef="let item" class="min-w-30">
                                <span class="flex items-center">
                                    <span class="w-2 h-2 rounded-full" [style.backgroundColor]="item.colorMarca"></span>
                                    <span class="ml-3">{{item.nombreMarca}}</span>
                                </span>
                            </td>
                        </ng-container>

                        <!-- Precio Compra -->
                        <ng-container matColumnDef="preciocompra">
                            <th mat-header-cell mat-sort-header *matHeaderCellDef>Precio Compra</th>
                            <td mat-cell *matCellDef="let item">
                                <span style="color:#056DB6;" class="pr-2">
                                    {{ item.precioProducto |
                                    currency:monedaInfo.codigoMoneda:'code':'':monedaInfo.cultureInfo }}
                                </span>
                            </td>
                        </ng-container>

                        <!-- Cantidad -->
                        <ng-container matColumnDef="cantidad">
                            <th mat-header-cell mat-sort-header *matHeaderCellDef class="text-center">Cantidad</th>
                            <td mat-cell *matCellDef="let item" class="text-center min-w-10">
                                {{item.cantidad}}
                            </td>
                        </ng-container>

                        <!-- Total -->
                        <ng-container matColumnDef="total">
                            <th mat-header-cell mat-sort-header *matHeaderCellDef>Total</th>
                            <td mat-cell *matCellDef="let item">
                                <span style="color:#056DB6;" class="pr-2">
                                    {{ (item.cantidad * item.precioProducto)
                                    | currency:monedaInfo.codigoMoneda:'code':'':monedaInfo.cultureInfo }}
                                </span>
                            </td>
                        </ng-container>

                        <!-- Rows -->
                        <tr mat-header-row *matHeaderRowDef="detalleCompraTableColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: detalleCompraTableColumns;"></tr>

                    </table>
                </div>

                <!-- Paginador -->
                <div class="paginator" *ngIf="allDetalleCompraDataSource.data.length > 0">
                    <mat-paginator #paginator [length]="allDetalleCompraDataSource.data.length" [pageSize]="10"
                        [pageSizeOptions]="[10, 15, 20]" aria-label="Seleccione página" (page)="onPageChange($event)">
                    </mat-paginator>
                </div>

                <!-- Sin datos -->
                <div class="paginator" *ngIf="allDetalleCompraDataSource.data.length === 0">
                    <img [src]="imgNoDataUltimosRegistros" alt="No hay datos disponibles" class="w-72 mx-auto mt-2" />
                    <div class="mt-4 text-2xl font-semibold text-center">{{textoResultadoTable}}</div>
                    <p class="mt-2 text-gray-500 text-center">Aplique otros filtros de búsqueda</p>
                </div>

            </div>
        </div>
    </div>
</div>