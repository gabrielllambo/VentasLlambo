"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[906],{6906:(Ra,$,u)=>{u.r($),u.d($,{VentasModule:()=>Ma});var h=u(6814),K=u(1389),U=u(3680),D=u(5742),W=u(2787),p=u(5313),I=u(8645),c=u(308),s=u(4740),X=u(4735);class Y{}class _t{}class xt{}var A=u(4690),vt=u(9347),m=u(6223),t=u(9212),tt=u(6278),y=u(4855),R=u(1427),bt=u(5846),q=u(2734),Q=u(9397),Ct=u(4928);let et=(()=>{class o{constructor(e){this.apiService=e}GetAllByFilterAsync(e){return this.apiService.post(q.oM.GetAllByFilterAsync,e).pipe((0,Q.b)(n=>n))}GetAllUsuariosAsync(){return this.apiService.query(q.oM.GetAllUsuariosAsync,{}).pipe((0,Q.b)(e=>e))}InsertAsync(e){return this.apiService.post(q.oM.InsertAsync,e).pipe((0,Q.b)(n=>n))}AnulaAsync(e){return this.apiService.post(q.oM.AnulaAsync,e).pipe((0,Q.b)(n=>n))}static#t=this.\u0275fac=function(n){return new(n||o)(t.LFG(Ct.s))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var G=u(5110),k=u(2032),x=u(5683),ot=u(9488),M=u(5940),V=u(2296),P=u(617),F=u(3566);function Tt(o,i){if(1&o&&t._UZ(0,"img",57),2&o){const e=t.oxw().$implicit;t.Q6J("alt","Imagen de "+e.nombre)("src",e.urlFoto,t.LSH)}}function Vt(o,i){1&o&&(t.TgZ(0,"div",58),t._uU(1," SIN IMAGEN "),t.qZA())}const at=(o,i,e)=>({"bg-red-200 text-red-800 dark:bg-red-600 dark:text-red-50":o,"bg-orange-200 text-orange-800 dark:bg-orange-600 dark:text-orange-50":i,"bg-green-200 text-green-800 dark:bg-green-600 dark:text-green-50":e});function Zt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr",49),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.seleccionarProducto(r))}),t.TgZ(1,"td",50)(2,"div",33)(3,"div",51),t.YNc(4,Tt,1,2,"img",52)(5,Vt,2,0,"div",53),t.qZA()()(),t.TgZ(6,"td",54),t._uU(7),t.qZA(),t.TgZ(8,"td",54),t._uU(9),t.qZA(),t.TgZ(10,"td",54)(11,"span",55)(12,"span",56),t._uU(13),t.qZA()()()()}if(2&o){const e=i.$implicit;t.xp6(4),t.Q6J("ngIf",e.urlFoto),t.xp6(1),t.Q6J("ngIf",!e.urlFoto),t.xp6(2),t.Oqu(e.codigo),t.xp6(2),t.Oqu(e.nombre),t.xp6(2),t.Q6J("ngClass",t.kEZ(6,at,(null==e?null:e.stock)<=0,(null==e?null:e.stock)>0&&(null==e?null:e.stock)<=5,(null==e?null:e.stock)>5)),t.xp6(2),t.Oqu(null==e?null:e.stock)}}function At(o,i){if(1&o&&(t.TgZ(0,"div",44)(1,"table",45)(2,"thead",46)(3,"tr")(4,"th",47),t._uU(5,"Imagen"),t.qZA(),t.TgZ(6,"th",47),t._uU(7,"C\xf3digo"),t.qZA(),t.TgZ(8,"th",47),t._uU(9,"Nombre"),t.qZA(),t.TgZ(10,"th",47),t._uU(11,"Stock"),t.qZA()()(),t.TgZ(12,"tbody"),t.YNc(13,Zt,14,10,"tr",48),t.qZA()()()),2&o){const e=t.oxw();t.xp6(13),t.Q6J("ngForOf",e.allProductoDataSource.data)}}function Ft(o,i){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-button-toggle",59)(2,"span",60),t._uU(3),t.qZA(),t.TgZ(4,"span",61),t._uU(5),t.qZA()(),t.BQk()),2&o){const e=i.$implicit;t.xp6(1),t.Q6J("value",e),t.xp6(2),t.Oqu(e.nombre),t.xp6(2),t.hij("(",e.cantidadProductos,")")}}function wt(o,i){1&o&&(t.TgZ(0,"th",81),t._uU(1,"Imagen"),t.qZA())}function St(o,i){if(1&o&&t._UZ(0,"img",57),2&o){const e=t.oxw().$implicit;t.Q6J("alt","Imagen de "+(null==e?null:e.nombre))("src",null==e?null:e.urlFoto,t.LSH)}}function Dt(o,i){1&o&&(t.TgZ(0,"div",58),t._uU(1," SIN IMAGEN "),t.qZA())}function yt(o,i){if(1&o&&(t.TgZ(0,"td",82)(1,"div",33)(2,"div",51),t.YNc(3,St,1,2,"img",52)(4,Dt,2,0,"div",53),t.qZA()()()),2&o){const e=i.$implicit;t.xp6(3),t.Q6J("ngIf",null==e?null:e.urlFoto),t.xp6(1),t.Q6J("ngIf",!(null!=e&&e.urlFoto))}}function Pt(o,i){1&o&&(t.TgZ(0,"th",83),t._uU(1," Nombre "),t.qZA())}function Ut(o,i){if(1&o&&(t.TgZ(0,"td",84)(1,"span",33)(2,"span",85),t._uU(3),t.qZA()()()),2&o){const e=i.$implicit;t.xp6(3),t.Oqu(e.nombre)}}function It(o,i){1&o&&(t.TgZ(0,"th",86),t._uU(1," Stock "),t.qZA())}function kt(o,i){if(1&o&&(t.TgZ(0,"td",87)(1,"span",55)(2,"span",56),t._uU(3),t.qZA()()()),2&o){const e=i.$implicit;t.xp6(1),t.Q6J("ngClass",t.kEZ(2,at,(null==e?null:e.stock)<=0,(null==e?null:e.stock)>0&&(null==e?null:e.stock)<=5,(null==e?null:e.stock)>5)),t.xp6(2),t.Oqu(null==e?null:e.stock)}}function Mt(o,i){1&o&&(t.TgZ(0,"th",88),t._uU(1," Precio "),t.qZA())}const E=(o,i,e)=>[o,i,"code","",e];function Jt(o,i){if(1&o&&(t.TgZ(0,"td",89)(1,"span",90),t._uU(2),t.ALo(3,"currency"),t.qZA()()),2&o){const e=i.$implicit,n=t.oxw(2);t.xp6(2),t.hij(" ",t.G7q(3,1,t.kEZ(7,E,e.precioVenta,n.monedaInfo.codigoMoneda,n.monedaInfo.cultureInfo))," ")}}function Rt(o,i){1&o&&(t.TgZ(0,"th",81),t._uU(1,"Cantidad"),t.qZA())}function qt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",89)(1,"div",91)(2,"button",92),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.disminuirCantidad(r))}),t.TgZ(3,"mat-icon"),t._uU(4,"remove"),t.qZA()(),t.TgZ(5,"input",93),t.NdJ("ngModelChange",function(a){const l=t.CHM(e).$implicit;return t.KtG(l.cantidad=a)}),t.qZA(),t.TgZ(6,"button",92),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.aumentarCantidad(r))}),t.TgZ(7,"mat-icon"),t._uU(8,"add"),t.qZA()()()()}if(2&o){const e=i.$implicit,n=t.oxw(2);t.xp6(2),t.Q6J("disabled",n.isCallingInsertService),t.xp6(3),t.Q6J("disabled",n.isCallingInsertService)("ngModel",e.cantidad),t.xp6(1),t.Q6J("disabled",n.isCallingInsertService)}}function Qt(o,i){1&o&&(t.TgZ(0,"th",83),t._uU(1," Total "),t.qZA())}function Et(o,i){if(1&o&&(t.TgZ(0,"td",89)(1,"span",90),t._uU(2),t.ALo(3,"currency"),t.qZA()()),2&o){const e=i.$implicit,n=t.oxw(2);t.xp6(2),t.hij(" ",t.G7q(3,1,t.kEZ(7,E,n.calcularTotalProducto(e),n.monedaInfo.codigoMoneda,n.monedaInfo.cultureInfo))," ")}}function Nt(o,i){1&o&&(t.TgZ(0,"th",83),t._uU(1," Acciones "),t.qZA())}function zt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",89)(1,"button",94),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.quitarProducto(r))}),t._UZ(2,"mat-icon",95),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("disabled",e.disabledAcciones||e.isCallingInsertService)}}function Ht(o,i){1&o&&t._UZ(0,"tr",96)}function Bt(o,i){1&o&&t._UZ(0,"tr",97)}function Ot(o,i){if(1&o&&(t.TgZ(0,"table",62,63),t.ynx(2,64),t.YNc(3,wt,2,0,"th",65)(4,yt,5,2,"td",66),t.BQk(),t.ynx(5,67),t.YNc(6,Pt,2,0,"th",68)(7,Ut,4,1,"td",69),t.BQk(),t.ynx(8,70),t.YNc(9,It,2,0,"th",71)(10,kt,4,6,"td",72),t.BQk(),t.ynx(11,73),t.YNc(12,Mt,2,0,"th",74)(13,Jt,4,11,"td",75),t.BQk(),t.ynx(14,76),t.YNc(15,Rt,2,0,"th",65)(16,qt,9,4,"td",75),t.BQk(),t.ynx(17,77),t.YNc(18,Qt,2,0,"th",68)(19,Et,4,11,"td",75),t.BQk(),t.ynx(20,78),t.YNc(21,Nt,2,0,"th",68)(22,zt,3,1,"td",75),t.BQk(),t.YNc(23,Ht,1,0,"tr",79)(24,Bt,1,0,"tr",80),t.qZA()),2&o){const e=t.oxw();t.Q6J("dataSource",e.lstProductosSeleccionados)("trackBy",e.trackByFn),t.xp6(23),t.Q6J("matHeaderRowDef",e.productoTableColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.productoTableColumns)}}function Yt(o,i){if(1&o&&t._UZ(0,"img",107),2&o){const e=t.oxw().$implicit;t.Q6J("src",e.urlFoto,t.LSH)("alt",e.nombre)}}function Gt(o,i){1&o&&(t.TgZ(0,"div",108),t._uU(1," SIN IMAGEN "),t.qZA())}const Lt=(o,i,e)=>({"text-red-600":o,"text-orange-500":i,"text-green-600":e});function jt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",98)(1,"div",99),t.YNc(2,Yt,1,2,"img",100)(3,Gt,2,0,"ng-template",null,101,t.W1O),t.qZA(),t.TgZ(5,"h3",102),t._uU(6),t.qZA(),t.TgZ(7,"p",103)(8,"span",104),t._uU(9),t.ALo(10,"currency"),t.qZA()(),t.TgZ(11,"p",105),t._uU(12),t.qZA(),t.TgZ(13,"button",106),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.seleccionarProducto(r))}),t._uU(14," Agregar "),t.qZA()()}if(2&o){const e=i.$implicit,n=t.MAs(4),a=t.oxw();t.xp6(2),t.Q6J("ngIf",e.urlFoto)("ngIfElse",n),t.xp6(4),t.Oqu(e.nombre),t.xp6(3),t.Oqu(t.G7q(10,7,t.kEZ(13,E,e.precioVenta,a.monedaInfo.codigoMoneda,a.monedaInfo.cultureInfo))),t.xp6(2),t.Q6J("ngClass",t.kEZ(17,Lt,e.stock<=0,e.stock>0&&e.stock<=5,e.stock>5)),t.xp6(1),t.hij(" Stock: ",e.stock," "),t.xp6(1),t.Q6J("disabled",a.isCallingInsertService)}}function $t(o,i){1&o&&(t.TgZ(0,"mat-error"),t._uU(1," Fecha Venta es requerido "),t.qZA())}function Kt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",109)(1,"button",110),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.quitarCliente())}),t._UZ(2,"mat-icon",111),t.qZA(),t.TgZ(3,"div",112),t._uU(4),t.qZA(),t.TgZ(5,"div",113)(6,"div",33),t._UZ(7,"mat-icon",114),t.TgZ(8,"div",115),t._uU(9),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("disabled",e.isCallingInsertService),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:trash"),t.xp6(2),t.hij(" ",(null==e.clienteData?null:e.clienteData.numeroDocumento)||"N/D"," "),t.xp6(3),t.Q6J("svgIcon","heroicons_solid:user"),t.xp6(2),t.lnq(" ",(null==e.clienteData||null==e.clienteData.nombres?null:e.clienteData.nombres.trim())||""," ",(null==e.clienteData||null==e.clienteData.apellidos?null:e.clienteData.apellidos.trim())||""," ",(null==e.clienteData||null==e.clienteData.correoElectronico?null:e.clienteData.correoElectronico.trim())||""," ")}}function Wt(o,i){1&o&&(t.TgZ(0,"span"),t._uU(1," Pagar "),t.qZA())}function Xt(o,i){1&o&&t._UZ(0,"mat-progress-spinner",116),2&o&&t.Q6J("diameter",24)("mode","indeterminate")}let nt=(()=>{class o{get totalVenta(){return this.lstProductosSeleccionados.data.reduce((e,n)=>e+n.precioVenta*n.cantidad,0)}constructor(e,n,a,r,l,d,g){this._fuseConfirmationService=e,this._formBuilder=n,this._securityService=a,this._inventarioService=r,this._clienteService=l,this._ventaService=d,this._toolService=g,this.isCallingInsertService=s.vU.False,this.isCallingSelecClienteService=s.vU.False,this.allProductoDataSource=new p.by,this.lstProductosSeleccionados=new p.by,this.isbuscandoProductosDisabled=!1,this.hayCliente=s.vU.False,this.productoTableColumns=["foto","nombre","stock","precioVenta","cantidad","total","acciones"],this.parametroBusquedaProducto="",this.parametroBusquedaCliente="",this.decodeToken=this.obtenerInfouserInfoLogueado(),this.monedaInfo=this.obtenerInfoMoneda(),this.userInfoLogueado=this.obtenerInfouserInfoLogueado(),this._unsubscribeAll=new I.x,this.imgNoData=s.HZ.noDataGraficos}ngOnInit(){this.lstProductosSeleccionados.data=[],this.allProductoDataSource.data=[],this.formFiltros(),this.GetCategoriesWithProductsCountAsync()}GetCategoriesWithProductsCountAsync(){this._inventarioService.GetCategoriesWithProductsCountAsync().subscribe(e=>{this.allCategoriesDataSource=e},e=>{this._toolService.showError(c.J.Transaction,c.J.Tittle),console.log(e)})}formFiltros(){this.filtroRegistroVentasForm=this._formBuilder.group({fechaRegistroVenta:[this._toolService.getDateTimeNow(),[m.kI.required]]})}aumentarCantidad(e){e.cantidad<e.stock?e.cantidad++:this._toolService.showWarning(c.T.StockLimite,c.J.Tittle)}onSelectCategoryProduct(e){this._inventarioService.GetAllProductsByCategoryAsync(e.value.idCategoria).subscribe(n=>{this.allProductByCategoryDataSource=n},n=>{this._toolService.showError(c.J.Transaction,c.J.Tittle),console.log(n)})}InsertAsync(){const e=this._toolService.getTimeZone(),n=this.userInfoLogueado.idUsuario,a=this.clienteData?.id,r=this.filtroRegistroVentasForm.get("fechaRegistroVenta").value,l=this.lstProductosSeleccionados.data.map(g=>({idProducto:g?.id,urlFotoProducto:g?.urlFoto,nombreProducto:g?.nombre,colorProducto:g?.color,nombreCategoria:g?.categoria.nombre,colorCategoria:g?.categoria.color,nombreMarca:g?.marca.nombre,colorMarca:g?.marca.color,cantidad:g?.cantidad,nombreMedida:g?.categoria.medida.nombre,precioCompra:g?.precioCompra,precioVenta:g?.precioVenta}));this.lstProductosSeleccionados.data.length!=s.Q6.Cero?A.a.isEmptyInputValue(e)?this._toolService.showWarning(c.T.InvalidLocalizacion,c.T.Tittle):A.a.isEmptyInputValue(n)?this._toolService.showWarning(c.T.InvalidUIdUsuario,c.T.Tittle):A.a.isEmptyInputValue(r)?this._toolService.showWarning(c.T.InvalidFechaRegistroVenta,c.T.Tittle):(this.configForm=this._formBuilder.group({title:"Confirmaci\xf3n de la Venta",message:"\xbfConforme con los datos ingresados?",icon:this._formBuilder.group({show:!0,name:"heroicons_outline:exclamation-triangle",color:"primary"}),actions:this._formBuilder.group({confirm:this._formBuilder.group({show:!0,label:"Si",color:"primary"}),cancel:this._formBuilder.group({show:!0,label:"No"})}),dismissible:!0}),this._fuseConfirmationService.open(this.configForm.value).afterClosed().subscribe(g=>{if("confirmed"!=g)return;const f=new xt;f.destinationTimeZoneIdRegistro=e,f.idUsuario=n,f.idCliente=a,f.lstDetalleVenta=l,f.notaAdicional=this.notaAdicional,f.fechaRegistroVenta=r,f.flgEnviarComprobante=this.flgEnviarComprobante,this.isCallingInsertService=s.vU.Show,console.log("Request a enviar:",f),this._ventaService.InsertAsync(f).subscribe(Z=>{if(Z.success)return this.clienteData=new Y,this.hayCliente=s.vU.False,this.lstProductosSeleccionados.data=[],this.allProductoDataSource.data=[],this.allProductByCategoryDataSource=[],this.isCallingInsertService=s.vU.Hide,this.notaAdicional="",window.open(Z.value,"_blank"),void vt.Z.success(Z.titleMessage,Z.message);this._toolService.showError(c.J.Transaction,c.J.Tittle),this.isbuscandoProductosDisabled=s.vU.False,this.isCallingInsertService=s.vU.Hide},Z=>{this._toolService.showError(c.J.Transaction,c.J.Tittle),console.log(Z),this.isbuscandoProductosDisabled=s.vU.False,this.isCallingInsertService=s.vU.Hide,this.clienteData=new Y,this.hayCliente=s.vU.False,this.lstProductosSeleccionados.data=[],this.allProductoDataSource.data=[],this.allProductByCategoryDataSource=[],this.isCallingInsertService=s.vU.Hide,this.notaAdicional=""})})):this._toolService.showWarning(c.T.NohayClienteIngresadoOProductosSeleccionados,c.J.Tittle)}buscarCliente(){if(!this.parametroBusquedaCliente&&""==this.parametroBusquedaCliente.trim())return;const e=new _t;e.idUsuario=this.decodeToken.idUsuario,e.parametro=this.parametroBusquedaCliente,this.isCallingSelecClienteService=s.vU.True,this._clienteService.GetByNumDocumentoCorreoAsync(e).subscribe(n=>{if(this.isCallingSelecClienteService=s.vU.False,n)return this.clienteData=n,this.hayCliente=s.vU.True,void(this.parametroBusquedaCliente="");this.clienteData=new Y,this.hayCliente=s.vU.False,this._toolService.showWarning(c.T.NoExisteCliente,c.T.Tittle)},n=>{this._toolService.showError(c.J.Transaction,c.J.Tittle),console.log(n),this.isCallingSelecClienteService=s.vU.False})}onEnviarComprobanteChange(e){const n=e.target.checked;if(n){const a=this.clienteData;if(!this.hayCliente||!a||!a.correoElectronico||""===a.correoElectronico.trim())return this._toolService.showWarning("Debe seleccionar un cliente con correo v\xe1lido para enviar el comprobante.","Advertencia"),e.target.checked=!1,void(this.flgEnviarComprobante=!1)}this.flgEnviarComprobante=n}quitarCliente(){this.clienteData=null,this.hayCliente=s.vU.False,this.flgEnviarComprobante=s.vU.False}disminuirCantidad(e){e.cantidad>1&&(e.cantidad--,this.lstProductosSeleccionados.data=[...this.lstProductosSeleccionados.data])}quitarProducto(e){this.lstProductosSeleccionados.data=this.lstProductosSeleccionados.data.filter(n=>n.id!==e.id)}calcularTotalProducto(e){return e.cantidad*e.precioVenta}filtrarProductos(e){const n=e.target.value;if(n.length>=s.Q6.Cuatro){const a=new X.H;return a.idUsuario=this.decodeToken.idUsuario,a.parametro=n,void this._inventarioService.GetProductoByCodeAsync(a).subscribe(r=>{r.length>s.Q6.Cero&&(this.allProductoDataSource.data=r)},r=>{this._toolService.showError(c.J.Transaction,c.J.Tittle),console.log(r)})}this.allProductoDataSource.data=[]}keyupEnterProductos(e){const n=e.target.value,a=new X.H;a.idUsuario=this.decodeToken.idUsuario,a.parametro=n,this._inventarioService.GetProductoByCodeAsync(a).subscribe(r=>{r.length>s.Q6.Cero&&(this.allProductoDataSource.data=r)},r=>{this._toolService.showError(c.J.Transaction,c.J.Tittle),console.log(r)})}seleccionarProducto(e){if(e.stock<=s.Q6.Cero)return void this._toolService.showWarning(c.T.StockInsuficiente,c.J.Tittle);const n=this.lstProductosSeleccionados.data.findIndex(a=>a.codigo===e.codigo);if(-1===n)e.cantidad=s.Q6.Uno,this.lstProductosSeleccionados.data=[...this.lstProductosSeleccionados.data,e];else{if(this.lstProductosSeleccionados.data[n].cantidad>=e.stock)return void this._toolService.showWarning(c.T.StockLimite,c.J.Tittle);this.lstProductosSeleccionados.data[n].cantidad++}this.lstProductosSeleccionados._updateChangeSubscription(),this.parametroBusquedaProducto="",this.allProductoDataSource.data=[]}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}obtenerInfouserInfoLogueado(){return this._securityService.getDecodetoken()}obtenerInfoMoneda(){return this._securityService.getMonedaStorage()}trackByFn(e,n){return n.id||e}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(tt.R),t.Y36(m.QS),t.Y36(y.I),t.Y36(R.I),t.Y36(bt.$),t.Y36(et),t.Y36(D.o))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-registro-ventas-page"]],features:[t._Bn([])],decls:62,vars:37,consts:[[1,"flex","flex-col","flex-auto","w-full"],[1,"flex","flex-wrap","w-full","max-w-screen-xl","mx-auto","p-6","md:p-8"],[1,"flex","items-center","justify-between","w-full"],[1,"text-2xl","md:text-3xl","font-semibold","tracking-tight","leading-8"],[1,"w-full","xl:col-span-2","mt-6","relative"],[1,"relative"],["maxlength","50","type","text","placeholder","Buscar Producto",1,"w-full","p-3","pl-10","border","border-gray-300","rounded-xl","bg-card","shadow","focus:ring","focus:ring-primary-300","focus:outline-none","placeholder:text-gray-500",3,"disabled","ngModel","ngModelChange","keyup.enter","input"],[1,"absolute","left-3","top-3","text-gray-500",3,"svgIcon","click"],["class","absolute w-auto mt-2 bg-white shadow-lg rounded-xl border border-gray-300 overflow-hidden max-h-72 overflow-y-auto z-50 transition-all duration-200 ease-in-out",4,"ngIf"],[1,"flex","flex-wrap","-m-2",3,"change"],[4,"ngFor","ngForOf"],[1,"grid","grid-cols-1","xl:grid-cols-4","gap-8","w-full","mt-8"],[1,"xl:col-span-3","flex","flex-col","flex-auto","bg-card","shadow","rounded-2xl","overflow-hidden","px-6","pt-6","pb-10"],[1,"overflow-x-auto","md:overflow-visible","mx-6"],["class","w-full bg-transparent","mat-table","","matSort","",3,"dataSource","trackBy",4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","lg:grid-cols-4","xl:grid-cols-5","gap-5","mt-6"],["class","bg-white rounded-2xl shadow-lg p-4 flex flex-col items-center transform transition-transform hover:scale-105 hover:shadow-xl border border-gray-200",4,"ngFor","ngForOf"],[1,"xl:col-span-1","flex","flex-col","flex-auto","p-6","bg-card","rounded-2xl","shadow-lg"],[1,"flex","flex-col"],[1,"grid","grid-cols-2","gap-4"],[1,"col-span-2","flex","flex-col","items-center","justify-center","py-6","px-4","rounded-2xl","bg-green-100","text-green-700","dark:bg-green-900","dark:text-green-300"],[1,"mt-1","text-2xl","font-semibold"],[1,"text-4xl","font-bold","leading-none","tracking-tight"],[3,"formGroup"],[1,"flex","items-center","mt-3"],[1,"text","font-medium","tracking-tight"],[1,"mt-3","relative"],[1,"w-full"],["required","","autocomplete","off","matInput","","autocomplete","false",3,"disabled","formControlName","matDatetimepicker","click"],["matPrefix","",3,"disabled","for"],["type","datetime","openOnFocus","true","timeInterval","5"],["fechaRegistroVenta",""],[4,"ngIf"],[1,"flex","items-center"],["type","text","placeholder","N\xfam. de Documento o Correo",1,"w-full","p-3","pl-12","border","border-gray-300","rounded-xl","bg-white","shadow","focus:ring","focus:ring-primary-300","focus:outline-none","dark:bg-gray-800","dark:text-white",3,"ngModel","disabled","ngModelChange","keyup.enter"],[1,"absolute","left-3","top-3","text-gray-500","cursor-pointer",3,"svgIcon","click"],["class","mt-3 p-2 border-t border-gray-300 bg-gray-100 rounded-lg shadow-md dark:bg-gray-800 relative"],["id","notaAdicional","rows","3","placeholder","Nota adicional",1,"w-full","p-3","border","border-gray-300","rounded-xl","bg-white","shadow","focus:ring","focus:ring-primary-300","focus:outline-none","dark:bg-gray-800","dark:text-white",3,"disabled","ngModel","ngModelChange"],[1,"col-span-4"],[1,"flex","flex-wrap","gap-4","mt-4"],["type","checkbox","id","envioSunat",1,"w-5","h-5","text-primary-600","border-gray-300","rounded","focus:ring","focus:ring-primary-300",3,"checked","disabled","change"],[1,"flex","justify-center","mt-6"],["mat-flat-button","","type","button",1,"w-full","sm:inline-flex","ml-3","sm:w-full","sm:h-10","sm:items-center","sm:justify-center","transition","duration-300","ease-in-out","transform","hover:scale-105","hover:bg-primary-600","focus:outline-none","focus:ring-2","focus:ring-primary-300",3,"disabled","color","click"],[3,"diameter","mode",4,"ngIf"],[1,"absolute","w-auto","mt-2","bg-white","shadow-lg","rounded-xl","border","border-gray-300","overflow-hidden","max-h-72","overflow-y-auto","z-50","transition-all","duration-200","ease-in-out"],[1,"w-auto","text-left"],[1,"bg-gray-100"],[1,"p-2","text-sm","font-semibold"],["class","cursor-pointer hover:bg-gray-200",3,"click",4,"ngFor","ngForOf"],[1,"cursor-pointer","hover:bg-gray-200",3,"click"],[1,"min-w-10"],[1,"relative","flex","items-center","justify-center","w-12","h-12","mr-6","rounded","overflow-hidden","border"],["class","w-full h-full object-cover",3,"alt","src",4,"ngIf"],["class","flex items-center justify-center w-full h-full text-xs font-semibold leading-none text-center uppercase bg-gray-200",4,"ngIf"],[1,"p-2","text-sm"],[1,"inline-flex","items-center","font-bold","text-xs","px-2.5","py-0.5","rounded-full","tracking-wide","uppercase",3,"ngClass"],[1,"leading-relaxed","whitespace-nowrap"],[1,"w-full","h-full","object-cover",3,"alt","src"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","leading-none","text-center","uppercase","bg-gray-200"],[1,"m-2",3,"value"],[1,"text-secondary"],[1,"ml-1.5","font-medium","text-secondary"],["mat-table","","matSort","",1,"w-full","bg-transparent",3,"dataSource","trackBy"],["productosSeleccionados",""],["matColumnDef","foto"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","min-w-10",4,"matCellDef"],["matColumnDef","nombre"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","min-w-30",4,"matCellDef"],["matColumnDef","stock"],["mat-header-cell","","mat-sort-header","","class","text-center",4,"matHeaderCellDef"],["mat-cell","","class","min-w-10 text-center",4,"matCellDef"],["matColumnDef","precioVenta"],["mat-header-cell","","mat-sort-header","","class","min-w-10",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","cantidad"],["matColumnDef","total"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["class","order-row h-16","mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"min-w-10"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"min-w-30"],[1,"ml-3","break-words","max-w-[150px]"],["mat-header-cell","","mat-sort-header","",1,"text-center"],["mat-cell","",1,"min-w-10","text-center"],["mat-header-cell","","mat-sort-header","",1,"min-w-10"],["mat-cell",""],[1,"pr-6","w-auto","h-auto","rounded-full",2,"color","#056DB6"],[1,"flex","items-center","space-x-2"],["mat-icon-button","","color","primary",3,"disabled","click"],["type","number","min","1","readonly","",1,"w-16","text-center","border","rounded-md",3,"disabled","ngModel","ngModelChange"],["mat-icon-button","","color","warn",1,"p-1",3,"disabled","click"],["svgIcon","feather:trash-2"],["mat-header-row",""],["mat-row","",1,"order-row","h-16"],[1,"bg-white","rounded-2xl","shadow-lg","p-4","flex","flex-col","items-center","transform","transition-transform","hover:scale-105","hover:shadow-xl","border","border-gray-200"],[1,"w-24","h-24","mb-4","rounded-xl","overflow-hidden","border","border-gray-300"],["class","w-full h-full object-cover",3,"src","alt",4,"ngIf","ngIfElse"],["noImagen",""],[1,"text-base","font-semibold","text-center","text-gray-800"],[1,"text-sm","font-medium","text-gray-700","mt-1"],[2,"color","#056DB6"],[1,"text-xs","font-medium","mt-1",3,"ngClass"],[1,"mt-4","px-4","py-2","bg-blue-600","text-white","text-sm","font-medium","rounded-xl","shadow","hover:bg-blue-700","transition-colors",3,"disabled","click"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","text-center","uppercase","bg-gray-200","text-gray-600"],[1,"mt-3","p-2","border-t","border-gray-300","bg-gray-100","rounded-lg","shadow-md","dark:bg-gray-800","relative"],["mat-icon-button","","color","warn",1,"absolute","top-3","right-3","cursor-pointer","text-red-600","hover:text-red-700",3,"disabled","click"],[3,"svgIcon"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"flex","flex-col","sm:flex-row","sm:items-center","mt-3","space-y-2","sm:space-y-0","sm:space-x-4"],[1,"icon-size-5","text-primary-500",3,"svgIcon"],[1,"ml-2","text-md","text-gray-700","dark:text-gray-300"],[3,"diameter","mode"]],template:function(n,a){if(1&n){const r=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4,"Nueva Venta"),t.qZA()(),t.TgZ(5,"div",4)(6,"div",5)(7,"input",6),t.NdJ("ngModelChange",function(d){return a.parametroBusquedaProducto=d})("keyup.enter",function(d){return a.keyupEnterProductos(d)})("input",function(d){return a.filtrarProductos(d)}),t.qZA(),t.TgZ(8,"mat-icon",7),t.NdJ("click",function(d){return a.keyupEnterProductos(d)}),t.qZA()(),t.YNc(9,At,14,1,"div",8),t.qZA(),t.TgZ(10,"div",4)(11,"mat-button-toggle-group",9),t.NdJ("change",function(d){return a.onSelectCategoryProduct(d)}),t.YNc(12,Ft,6,3,"ng-container",10),t.qZA()(),t.TgZ(13,"div",11)(14,"div",12)(15,"div",13),t.YNc(16,Ot,25,4,"table",14),t.TgZ(17,"div",15),t.YNc(18,jt,15,21,"div",16),t.qZA()()(),t.TgZ(19,"div",17)(20,"div",18)(21,"div",19)(22,"div",20)(23,"div",21),t._uU(24,"Total"),t.qZA(),t.TgZ(25,"div",22),t._uU(26),t.ALo(27,"currency"),t.qZA()()()(),t.TgZ(28,"form",23)(29,"div",24)(30,"div",25),t._uU(31,"Fecha De Venta"),t.qZA()(),t.TgZ(32,"div",26)(33,"div",5)(34,"mat-form-field",27)(35,"input",28),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(38);return t.KtG(d.open())}),t.qZA(),t._UZ(36,"mat-datetimepicker-toggle",29)(37,"mat-datetimepicker",30,31),t.YNc(39,$t,2,0,"mat-error",32),t.qZA()()()(),t.TgZ(40,"div",33)(41,"div",25),t._uU(42,"Buscar Cliente"),t.qZA()(),t.TgZ(43,"div",26)(44,"div",5)(45,"input",34),t.NdJ("ngModelChange",function(d){return a.parametroBusquedaCliente=d})("keyup.enter",function(){return a.buscarCliente()}),t.qZA(),t.TgZ(46,"mat-icon",35),t.NdJ("click",function(){return a.buscarCliente()}),t.qZA()()(),t.YNc(47,Kt,10,7,"div",36),t.TgZ(48,"div",24)(49,"div",25),t._uU(50,"Nota adicional"),t.qZA()(),t.TgZ(51,"div",26)(52,"textarea",37),t.NdJ("ngModelChange",function(d){return a.notaAdicional=d}),t.qZA()(),t.TgZ(53,"div",38)(54,"div",39)(55,"input",40),t.NdJ("change",function(d){return a.onEnviarComprobanteChange(d)}),t.qZA(),t.TgZ(56,"div",25),t._uU(57,"Enviar Comprobante"),t.qZA()()(),t.TgZ(58,"div",41)(59,"button",42),t.NdJ("click",function(){return a.InsertAsync()}),t.YNc(60,Wt,2,0,"span",32)(61,Xt,1,2,"mat-progress-spinner",43),t.qZA()()()()()()}if(2&n){const r=t.MAs(38);t.xp6(7),t.Q6J("disabled",a.isbuscandoProductosDisabled||a.isCallingInsertService)("ngModel",a.parametroBusquedaProducto),t.xp6(1),t.Q6J("svgIcon","heroicons_mini:magnifying-glass"),t.xp6(1),t.Q6J("ngIf",a.allProductoDataSource.data.length>0),t.xp6(3),t.Q6J("ngForOf",a.allCategoriesDataSource),t.xp6(4),t.Q6J("ngIf",(null==a.lstProductosSeleccionados?null:a.lstProductosSeleccionados.data.length)>0),t.xp6(2),t.Q6J("ngForOf",a.allProductByCategoryDataSource),t.xp6(8),t.hij(" ",t.G7q(27,27,t.kEZ(33,E,a.totalVenta,a.monedaInfo.codigoMoneda,a.monedaInfo.cultureInfo))," "),t.xp6(2),t.Q6J("formGroup",a.filtroRegistroVentasForm),t.xp6(7),t.Q6J("disabled",a.isCallingInsertService)("formControlName","fechaRegistroVenta")("matDatetimepicker",r),t.xp6(1),t.Q6J("disabled",a.isCallingInsertService)("for",r),t.xp6(3),t.Q6J("ngIf",a.filtroRegistroVentasForm.get("fechaRegistroVenta").hasError("required")),t.xp6(6),t.Q6J("ngModel",a.parametroBusquedaCliente)("disabled",a.isCallingInsertService),t.xp6(1),t.Q6J("svgIcon","heroicons_mini:magnifying-glass"),t.xp6(1),t.um2(47,a.hayCliente?47:-1),t.xp6(5),t.Q6J("disabled",a.isCallingInsertService)("ngModel",a.notaAdicional),t.xp6(3),t.Q6J("checked",a.flgEnviarComprobante)("disabled",a.isCallingInsertService),t.xp6(4),t.Q6J("disabled",a.isCallingInsertService||0==a.lstProductosSeleccionados.data.length||!a.filtroRegistroVentasForm.get("fechaRegistroVenta").value)("color","primary"),t.xp6(1),t.Q6J("ngIf",!a.isCallingInsertService),t.xp6(1),t.Q6J("ngIf",a.isCallingInsertService)}},dependencies:[h.mk,h.sg,h.O5,G._R,G.C,G.RZ,m._Y,m.Fj,m.wV,m.JJ,m.JL,m.Q7,m.nD,m.qQ,m.sg,m.u,m.On,k.Nt,x.KE,x.TO,x.qo,ot.A9,ot.Yi,M.Ou,V.lW,V.RK,P.Hw,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,F.YE,F.nU,h.H9]})}return o})();var N=u(9315),w=u(1476),z=u(937);let te=(()=>{class o extends w.ye{constructor(){super(...arguments),this.itemsPerPageLabel="Ventas por p\xe1gina:",this.nextPageLabel="Siguiente p\xe1gina",this.previousPageLabel="P\xe1gina anterior",this.getRangeLabel=(e,n,a)=>0===a?"P\xe1gina 1 de 1":`P\xe1gina ${e+1} de ${Math.ceil(a/n)}`}static#t=this.\u0275fac=(()=>{let e;return function(a){return(e||(e=t.n5z(o)))(a||o)}})();static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();class ee{}class oe{}class ae{}var L=u(7700);let ne=(()=>{class o extends w.ye{constructor(){super(...arguments),this.itemsPerPageLabel="Detalle por p\xe1gina:",this.nextPageLabel="Siguiente p\xe1gina",this.previousPageLabel="P\xe1gina anterior",this.getRangeLabel=(e,n,a)=>0===a?"P\xe1gina 1 de 1":`P\xe1gina ${e+1} de ${Math.ceil(a/n)}`}static#t=this.\u0275fac=(()=>{let e;return function(a){return(e||(e=t.n5z(o)))(a||o)}})();static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var ie=u(2599),b=u(7988);const re=["detalleVentaTable"];function se(o,i){1&o&&(t.TgZ(0,"th",31),t._uU(1,"Imagen"),t.qZA())}function le(o,i){if(1&o&&t._UZ(0,"img",37),2&o){const e=t.oxw().$implicit;t.Q6J("alt","Imagen de "+e.nombreProducto)("src",e.urlFotoProducto,t.LSH)}}function ce(o,i){1&o&&(t.TgZ(0,"div",38),t._uU(1," SIN IMAGEN "),t.qZA())}function de(o,i){if(1&o&&(t.TgZ(0,"td",32)(1,"div",33)(2,"div",34),t.YNc(3,le,1,2,"img",35)(4,ce,2,0,"div",36),t.qZA()()()),2&o){const e=i.$implicit;t.xp6(3),t.Q6J("ngIf",e.urlFotoProducto),t.xp6(1),t.Q6J("ngIf",!e.urlFotoProducto)}}function ue(o,i){1&o&&(t.TgZ(0,"th",39),t._uU(1," Nombre Producto "),t.qZA())}function me(o,i){if(1&o&&(t.TgZ(0,"td",40)(1,"span",33),t._UZ(2,"span",41),t.TgZ(3,"span",42),t._uU(4),t.qZA()()()),2&o){const e=i.$implicit;t.xp6(2),t.Udp("background-color",e.colorProducto),t.xp6(2),t.Oqu(e.nombreProducto)}}function pe(o,i){1&o&&(t.TgZ(0,"th",39),t._uU(1," Categor\xeda Producto "),t.qZA())}function ge(o,i){if(1&o&&(t.TgZ(0,"td",40)(1,"span",33),t._UZ(2,"span",41),t.TgZ(3,"span",42),t._uU(4),t.qZA()()()),2&o){const e=i.$implicit;t.xp6(2),t.Udp("background-color",e.colorCategoria),t.xp6(2),t.Oqu(e.nombreCategoria)}}function he(o,i){1&o&&(t.TgZ(0,"th",39),t._uU(1," Marca Producto "),t.qZA())}function fe(o,i){if(1&o&&(t.TgZ(0,"td",40)(1,"span",33),t._UZ(2,"span",41),t.TgZ(3,"span",42),t._uU(4),t.qZA()()()),2&o){const e=i.$implicit;t.xp6(2),t.Udp("background-color",e.colorMarca),t.xp6(2),t.Oqu(e.nombreMarca)}}function _e(o,i){1&o&&(t.TgZ(0,"th",39),t._uU(1," Categor\xeda "),t.qZA())}function xe(o,i){if(1&o&&(t.TgZ(0,"td",40)(1,"span",33),t._UZ(2,"span",41),t.TgZ(3,"span",42),t._uU(4),t.qZA()()()),2&o){const e=i.$implicit;t.xp6(2),t.Udp("background-color",e.categoria.color),t.xp6(2),t.Oqu(e.categoria.nombre)}}function ve(o,i){1&o&&(t.TgZ(0,"th",39),t._uU(1," Precio"),t.qZA())}const it=(o,i,e)=>[o,i,"code","",e];function be(o,i){if(1&o&&(t.TgZ(0,"td",43)(1,"span",44),t._uU(2),t.ALo(3,"currency"),t.qZA()()),2&o){const e=i.$implicit,n=t.oxw();t.xp6(2),t.hij(" ",t.G7q(3,1,t.kEZ(7,it,e.precioProducto,n.monedaInfo.codigoMoneda,n.monedaInfo.cultureInfo))," ")}}function Ce(o,i){1&o&&(t.TgZ(0,"th",45),t._uU(1," Cantidad "),t.qZA())}function Te(o,i){if(1&o&&(t.TgZ(0,"td",46)(1,"span",47),t._uU(2),t.qZA()()),2&o){const e=i.$implicit;t.xp6(2),t.Oqu(null==e?null:e.cantidad)}}function Ve(o,i){1&o&&(t.TgZ(0,"th",39),t._uU(1," Total"),t.qZA())}function Ze(o,i){if(1&o&&(t.TgZ(0,"td",43)(1,"span",44),t._uU(2),t.ALo(3,"currency"),t.qZA()()),2&o){const e=i.$implicit,n=t.oxw();t.xp6(2),t.hij(" ",t.G7q(3,1,t.kEZ(7,it,e.precioTotal,n.monedaInfo.codigoMoneda,n.monedaInfo.cultureInfo))," ")}}function Ae(o,i){1&o&&(t.TgZ(0,"th",39),t._uU(1,"Activo"),t.qZA())}function Fe(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",43)(1,"mat-slide-toggle",48),t.NdJ("change",function(a){const l=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.UpdateActivoProductoAsync(l,a.checked))}),t.qZA()()}if(2&o){const e=i.$implicit,n=t.oxw();t.xp6(1),t.Q6J("checked",e.activo)("disabled",n.disabledAcciones)}}function we(o,i){1&o&&(t.TgZ(0,"th",39),t._uU(1," Acciones "),t.qZA())}function Se(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",43)(1,"button",49)(2,"mat-icon"),t._uU(3,"more_vert"),t.qZA()(),t.TgZ(4,"mat-menu",null,50)(6,"button",51),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.onShowFormDetalleProducto(r))}),t._UZ(7,"mat-icon",52),t._uU(8," Ver "),t.qZA(),t.TgZ(9,"button",51),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.onShowFormModificaProducto(r))}),t._UZ(10,"mat-icon",53),t._uU(11," Editar "),t.qZA(),t.TgZ(12,"button",51),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.DeleteAsync(r))}),t._UZ(13,"mat-icon",54),t._uU(14," Eliminar "),t.qZA()()()}if(2&o){const e=t.MAs(5),n=t.oxw();t.xp6(1),t.Q6J("matMenuTriggerFor",e)("disabled",n.disabledAcciones)}}function De(o,i){1&o&&t._UZ(0,"tr",55)}function ye(o,i){1&o&&t._UZ(0,"tr",56)}const Pe=()=>[10,15,20];function Ue(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",57)(1,"mat-paginator",58,59),t.NdJ("page",function(a){t.CHM(e);const r=t.oxw();return t.KtG(r.onPageChange(a))}),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("length",e.allDetalleVentaDataSource.data.length)("pageSize",10)("pageSizeOptions",t.DdM(3,Pe))}}function Ie(o,i){if(1&o&&(t.TgZ(0,"div",57),t._UZ(1,"img",60),t.TgZ(2,"div",61),t._uU(3),t.qZA(),t.TgZ(4,"div")(5,"p",62),t._uU(6,"Aplique otros filtros de b\xfasqueda"),t.qZA()()()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("src",e.imgNoDataUltimosRegistros,t.LSH),t.xp6(2),t.hij(" ",e.textoResultadoTable,"")}}let rt=(()=>{class o{constructor(e,n,a,r){this.matDialogRef=e,this.paramsForms=n,this._toolService=a,this._securityService=r,this.pageSlice=new p.by,this.detalleVentaTableColumns=["urlfotoproducto","nombreproducto","categoriaproducto","marcaproducto","precioproducto","cantidad","total"],this.allDetalleVentaDataSource=new p.by,this.isCallingService=s.vU.False,this.sortingActivoData=(l,d)=>this._toolService.sortingActivoData(l,d)}ngOnInit(){this.monedaInfo=this.paramsForms.monedaInfo,this.allDetalleVentaDataSource.data=this.paramsForms.lstDetalleVenta,this.numeroVenta=this.paramsForms.numeroVenta,this.setPageSlice(this.paramsForms.lstDetalleVenta)}cerrarVentanaEmergente(){this.matDialogRef.close()}isMobilSize(){return this._toolService.isMobilSize()}obtenerInfouserInfoLogueado(){return this._securityService.getDecodetoken()}trackByFn(e,n){return n.id||e}onPageChange(e){const n=e.pageIndex*e.pageSize;let a=n+e.pageSize;a>this.allDetalleVentaDataSource.data.length&&(a=this.allDetalleVentaDataSource.data.length),this.pageSlice.data=this.allDetalleVentaDataSource.data.slice(n,a)}setPageSlice(e){this.pageSlice.data=e.slice(s.Q6.Cero,s.Q6.Diez),this._paginator&&(this._paginator.pageIndex=s.Q6.Cero,this._paginator.pageSize=s.Q6.Diez)}ngAfterViewInit(){this.allDetalleVentaDataSource.sort=this.detalleVentaTableeMatSort,this.allDetalleVentaDataSource.paginator=this._paginator}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(L.so),t.Y36(L.WI),t.Y36(D.o),t.Y36(y.I))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-detalle-venta-page"]],viewQuery:function(n,a){if(1&n&&(t.Gf(w.NW,5),t.Gf(re,5,F.YE)),2&n){let r;t.iGM(r=t.CRH())&&(a._paginator=r.first),t.iGM(r=t.CRH())&&(a.detalleVentaTableeMatSort=r.first)}},features:[t._Bn([{provide:w.ye,useClass:ne}])],decls:46,vars:9,consts:[[1,"flex","flex-col","md:min-w-200","max","-m-6","height-dialog"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","",3,"tabIndex","click"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","w-full"],[1,"grid","grid-cols-1","xl:grid-cols-1","gap-8","w-full","mt-6"],[1,"xl:col-span-1","flex","flex-col","flex-auto","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"overflow-x-auto","mx-6"],["mat-table","","matSort","",1,"w-full","bg-transparent","mb-3",3,"dataSource","trackBy"],["detalleVentaTable",""],["matColumnDef","urlfotoproducto"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","min-w-10",4,"matCellDef"],["matColumnDef","nombreproducto"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","min-w-30",4,"matCellDef"],["matColumnDef","categoriaproducto"],["matColumnDef","marcaproducto"],["matColumnDef","categoria"],["matColumnDef","precioproducto"],["mat-cell","",4,"matCellDef"],["matColumnDef","cantidad"],["mat-header-cell","","mat-sort-header","","class","text-center",4,"matHeaderCellDef"],["mat-cell","","class","min-w-10 text-center",4,"matCellDef"],["matColumnDef","total"],["matColumnDef","activarDesactivar"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","paginator",4,"ngIf"],["mat-header-cell",""],["mat-cell","",1,"min-w-10"],[1,"flex","items-center"],[1,"relative","flex","items-center","justify-center","w-12","h-12","mr-6","rounded","overflow-hidden","border"],["class","w-full h-full object-cover",3,"alt","src",4,"ngIf"],["class","flex items-center justify-center w-full h-full text-xs font-semibold leading-none text-center uppercase bg-gray-200",4,"ngIf"],[1,"w-full","h-full","object-cover",3,"alt","src"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","leading-none","text-center","uppercase","bg-gray-200"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"min-w-30"],[1,"w-2","h-2","rounded-full"],[1,"ml-3","leading-4"],["mat-cell",""],[1,"pr-2","w-auto","h-auto","rounded-full",2,"color","#056DB6"],["mat-header-cell","","mat-sort-header","",1,"text-center"],["mat-cell","",1,"min-w-10","text-center"],[1,"leading-relaxed","whitespace-nowrap"],["color","primary",3,"checked","disabled","change"],["mat-icon-button","",3,"matMenuTriggerFor","disabled"],["menu","matMenu"],["mat-menu-item","",3,"click"],["svgIcon","feather:eye"],["svgIcon","feather:edit-2"],["svgIcon","feather:trash-2"],["mat-header-row",""],["mat-row",""],[1,"paginator"],["aria-label","Seleccione p\xe1gina",3,"length","pageSize","pageSizeOptions","page"],["paginator",""],["alt","No hay datos disponibles",1,"w-72","mx-auto","mt-2",3,"src"],[1,"mt-4","sm:mt-8","text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-tight","md:leading-none","text-center"],[1,"mt-2","text-gray-500","text-center"]],template:function(n,a){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return a.cerrarVentanaEmergente()}),t._UZ(5,"mat-icon",4),t.qZA()(),t.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"table",9,10),t.ynx(12,11),t.YNc(13,se,2,0,"th",12)(14,de,5,2,"td",13),t.BQk(),t.ynx(15,14),t.YNc(16,ue,2,0,"th",15)(17,me,5,3,"td",16),t.BQk(),t.ynx(18,17),t.YNc(19,pe,2,0,"th",15)(20,ge,5,3,"td",16),t.BQk(),t.ynx(21,18),t.YNc(22,he,2,0,"th",15)(23,fe,5,3,"td",16),t.BQk(),t.ynx(24,19),t.YNc(25,_e,2,0,"th",15)(26,xe,5,3,"td",16),t.BQk(),t.ynx(27,20),t.YNc(28,ve,2,0,"th",15)(29,be,4,11,"td",21),t.BQk(),t.ynx(30,22),t.YNc(31,Ce,2,0,"th",23)(32,Te,3,1,"td",24),t.BQk(),t.ynx(33,25),t.YNc(34,Ve,2,0,"th",15)(35,Ze,4,11,"td",21),t.BQk(),t.ynx(36,26),t.YNc(37,Ae,2,0,"th",15)(38,Fe,2,2,"td",21),t.BQk(),t.ynx(39,27),t.YNc(40,we,2,0,"th",15)(41,Se,15,2,"td",21),t.BQk(),t.YNc(42,De,1,0,"tr",28)(43,ye,1,0,"tr",29),t.qZA()(),t.YNc(44,Ue,3,4,"div",30)(45,Ie,7,2,"div",30),t.qZA()()()()),2&n&&(t.xp6(3),t.hij("Detalle Venta Nro. ",a.numeroVenta,""),t.xp6(1),t.Q6J("tabIndex",-1),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:x-mark"),t.xp6(5),t.Q6J("dataSource",a.pageSlice)("trackBy",a.trackByFn),t.xp6(32),t.Q6J("matHeaderRowDef",a.detalleVentaTableColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.detalleVentaTableColumns),t.xp6(1),t.Q6J("ngIf",a.allDetalleVentaDataSource.data.length>0),t.xp6(1),t.Q6J("ngIf",0===a.allDetalleVentaDataSource.data.length))},dependencies:[h.O5,ie.Rr,b.VK,b.OP,b.p6,V.RK,P.Hw,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,w.NW,F.YE,F.nU,h.H9]})}return o})();var H=u(8358),B=u(6670),ke=u(2228),S=u(8525),C=u(2651),T=u(8034),O=u(2268);const Me=["selectUsuarioItem"],Je=["historialVentaTable"],Re=["matDrawer"];function qe(o,i){1&o&&(t.ynx(0),t._uU(1,", "),t.BQk())}function Qe(o,i){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.YNc(2,qe,2,0,"ng-container",13),t.qZA()),2&o){const e=i.$implicit,n=i.index;t.oxw(2);const a=t.MAs(16);t.xp6(1),t.hij(" ",e.correoElectronico||"",""),t.xp6(1),t.Q6J("ngIf",n<a.value.length-1)}}function Ee(o,i){if(1&o&&(t.ynx(0),t.YNc(1,Qe,3,2,"span",44),t.BQk()),2&o){t.oxw();const e=t.MAs(16);t.xp6(1),t.Q6J("ngForOf",e.value)}}function Ne(o,i){if(1&o&&(t.TgZ(0,"mat-option",45),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.correoElectronico,"")}}function ze(o,i){1&o&&t._UZ(0,"mat-icon",46),2&o&&t.Q6J("svgIcon","heroicons_solid:magnifying-glass")}function He(o,i){1&o&&(t.TgZ(0,"span",47),t._uU(1,"Buscar"),t.qZA())}function Be(o,i){1&o&&t._UZ(0,"mat-progress-spinner",48),2&o&&t.Q6J("diameter",24)("mode","indeterminate")}function Oe(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",49),t._UZ(1,"mat-icon",6),t.qZA(),t.TgZ(2,"mat-menu",null,50)(4,"button",51),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onExportar())}),t._UZ(5,"mat-icon",6),t.TgZ(6,"span",52),t._uU(7,"Exportar"),t.qZA()(),t.TgZ(8,"button",51),t.NdJ("click",function(){t.CHM(e),t.oxw();const a=t.MAs(2);return t.KtG(a.open())}),t._UZ(9,"mat-icon",6),t.TgZ(10,"span",52),t._uU(11,"Filtrar"),t.qZA()()()}if(2&o){const e=t.MAs(3);t.Q6J("matMenuTriggerFor",e),t.xp6(1),t.Q6J("svgIcon","heroicons_mini:ellipsis-vertical"),t.xp6(4),t.Q6J("svgIcon","heroicons_solid:arrow-up-tray"),t.xp6(4),t.Q6J("svgIcon","heroicons_solid:adjustments-horizontal")}}function Ye(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",53),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onExportar())}),t._UZ(1,"mat-icon",54),t.TgZ(2,"span",47),t._uU(3,"Exportar"),t.qZA()(),t.TgZ(4,"button",55),t.NdJ("click",function(){t.CHM(e),t.oxw();const a=t.MAs(2);return t.KtG(a.open())}),t._UZ(5,"mat-icon",54),t.TgZ(6,"span",47),t._uU(7,"Filtrar"),t.qZA()()}2&o&&(t.Q6J("color","primary")("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:arrow-up-tray"),t.xp6(4),t.Q6J("svgIcon","heroicons_solid:adjustments-horizontal"))}const Ge=()=>({"border-radius":"0",height:"50px"});function Le(o,i){if(1&o&&(t.TgZ(0,"div",56),t._UZ(1,"ngx-skeleton-loader",57),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("count",e.skeletonNumber)("theme",t.DdM(2,Ge))}}function je(o,i){1&o&&(t.TgZ(0,"th",78),t._uU(1," N\xfamero de Venta "),t.qZA())}function $e(o,i){if(1&o&&(t.TgZ(0,"td",79)(1,"span",80)(2,"span",81),t._uU(3),t.qZA()()()),2&o){const e=i.$implicit;t.xp6(3),t.Oqu(e.numeroVenta)}}function Ke(o,i){1&o&&(t.TgZ(0,"th",78),t._uU(1," Nombre Cliente "),t.qZA())}function We(o,i){if(1&o&&(t.TgZ(0,"td",82)(1,"span",83),t._uU(2),t.qZA()()),2&o){const e=i.$implicit;t.xp6(2),t.hij(" ",e.nombreCliente," ")}}function Xe(o,i){1&o&&(t.TgZ(0,"th",78),t._uU(1," Correo Usuario "),t.qZA())}function to(o,i){if(1&o&&(t.TgZ(0,"td",82)(1,"span",83)(2,"a",84),t._uU(3),t.ALo(4,"lowercase"),t.qZA()()()),2&o){const e=i.$implicit;t.xp6(2),t.Q6J("href","mailto:"+e.correoUsuario,t.LSH),t.xp6(1),t.hij(" ",t.lcZ(4,2,e.correoUsuario)," ")}}function eo(o,i){1&o&&(t.TgZ(0,"th",78),t._uU(1," Fecha Venta "),t.qZA())}function oo(o,i){if(1&o&&(t.TgZ(0,"td",85)(1,"span",83),t._uU(2),t.ALo(3,"date"),t.qZA()()),2&o){const e=i.$implicit;t.xp6(2),t.hij(" ",t.xi3(3,1,e.fechaVenta,"dd/MM/yyyy HH:mm")," ")}}function ao(o,i){1&o&&(t.TgZ(0,"th",86),t._uU(1," Total Venta "),t.qZA())}const no=(o,i,e)=>[o,i,"code","",e];function io(o,i){if(1&o&&(t.TgZ(0,"td",82)(1,"span",87),t._uU(2),t.ALo(3,"currency"),t.qZA()()),2&o){const e=i.$implicit,n=t.oxw(2);t.xp6(2),t.hij(" ",t.G7q(3,1,t.kEZ(7,no,e.totalVenta,n.monedaInfo.codigoMoneda,n.monedaInfo.cultureInfo))," ")}}function ro(o,i){1&o&&(t.TgZ(0,"th",86),t._uU(1," Estado "),t.qZA())}const so=(o,i)=>({"bg-red-200 text-red-800 dark:bg-red-600 dark:text-red-50":o,"bg-green-200 text-green-800 dark:bg-green-600 dark:text-green-50":i});function lo(o,i){if(1&o&&(t.TgZ(0,"td",88)(1,"span",89)(2,"span",90),t._uU(3),t.qZA()()()),2&o){const e=i.$implicit;t.xp6(1),t.Q6J("ngClass",t.WLB(2,so,!1===(null==e?null:e.estado),!0===(null==e?null:e.estado))),t.xp6(2),t.hij(" ",!0===(null==e?null:e.estado)?"Completado":"Anulado"," ")}}function co(o,i){1&o&&(t.TgZ(0,"th",78),t._uU(1," Acciones "),t.qZA())}function uo(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",51),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.AnulaAsync(a))}),t._UZ(1,"mat-icon",95),t._uU(2," Anular "),t.qZA()}}function mo(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",82)(1,"button",91)(2,"mat-icon"),t._uU(3,"more_vert"),t.qZA()(),t.TgZ(4,"mat-menu",null,92)(6,"button",51),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.showFormDetalleVentaDialog(r))}),t._UZ(7,"mat-icon",93),t._uU(8," Ver "),t.qZA(),t.TgZ(9,"button",51),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.verComprobante(r))}),t._UZ(10,"mat-icon",6),t._uU(11," Ver PDF "),t.qZA(),t.YNc(12,uo,3,0,"button",94),t.qZA()()}if(2&o){const e=i.$implicit,n=t.MAs(5),a=t.oxw(2);t.xp6(1),t.Q6J("matMenuTriggerFor",n)("disabled",a.disabledAcciones),t.xp6(9),t.Q6J("svgIcon","feather:file"),t.xp6(2),t.Q6J("ngIf",!0===e.estado)}}function po(o,i){1&o&&t._UZ(0,"tr",96)}function go(o,i){1&o&&t._UZ(0,"tr",97)}const ho=()=>[10,15,20];function fo(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",98)(1,"mat-paginator",99,100),t.NdJ("page",function(a){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onPageChange(a))}),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("length",e.allHistorialVentaDataSource.data.length)("pageSize",5)("pageSizeOptions",t.DdM(3,ho))}}function _o(o,i){if(1&o&&(t.TgZ(0,"div",98),t._UZ(1,"img",101),t.TgZ(2,"div",102),t._uU(3),t.qZA(),t.TgZ(4,"div")(5,"p",103),t._uU(6,"Aplique otros filtros de b\xfasqueda"),t.qZA()()()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.imgNoDataUltimosRegistros,t.LSH),t.xp6(2),t.hij(" ",e.textoResultadoTable,"")}}function xo(o,i){if(1&o&&(t.TgZ(0,"div",58)(1,"div",59)(2,"table",60,61),t.ynx(4,62),t.YNc(5,je,2,0,"th",63)(6,$e,4,1,"td",64),t.BQk(),t.ynx(7,65),t.YNc(8,Ke,2,0,"th",63)(9,We,3,1,"td",66),t.BQk(),t.ynx(10,67),t.YNc(11,Xe,2,0,"th",63)(12,to,5,4,"td",66),t.BQk(),t.ynx(13,68),t.YNc(14,eo,2,0,"th",63)(15,oo,4,4,"td",69),t.BQk(),t.ynx(16,70),t.YNc(17,ao,2,0,"th",71)(18,io,4,11,"td",66),t.BQk(),t.ynx(19,72),t.YNc(20,ro,2,0,"th",71)(21,lo,4,5,"td",73),t.BQk(),t.ynx(22,74),t.YNc(23,co,2,0,"th",63)(24,mo,13,4,"td",66),t.BQk(),t.YNc(25,po,1,0,"tr",75)(26,go,1,0,"tr",76),t.qZA()(),t.YNc(27,fo,3,4,"div",77)(28,_o,7,2,"div",77),t.qZA()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("dataSource",e.pageSlice)("trackBy",e.trackByFn),t.xp6(23),t.Q6J("matHeaderRowDef",e.historialVentaTableColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.historialVentaTableColumns),t.xp6(1),t.Q6J("ngIf",e.allHistorialVentaDataSource.data.length>0),t.xp6(1),t.Q6J("ngIf",0===e.allHistorialVentaDataSource.data.length)}}let st=(()=>{class o{constructor(e,n,a,r,l,d,g){this._matDialog=e,this._fuseConfirmationService=n,this._formBuilder=a,this._securityService=r,this._ventaService=l,this._detalleventaService=d,this._toolService=g,this.decodeToken=this.obtenerInfouserInfoLogueado(),this.monedaInfo=this.obtenerInfoMoneda(),this.disabledAcciones=s.vU.False,this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.False,this.skeleton=s.vU.False,this.skeletonNumber=s.Q6.Ocho,this.textoResultadoTable="",this.imgNoDataUltimosRegistros=s.HZ.noDataUltimosRegistros,this.minDate=this._toolService.getMinDateFIlter(),this.maxDate=this._toolService.getMaxDateFIlter(),this.pageSlice=new p.by,this.allHistorialVentaDataSource=new p.by,this.historialVentaTableColumns=["numeroVenta","nombreCliente","correoUsuario","fechaVenta","totalVenta","estado","acciones"],this._unsubscribeAll=new I.x,this.sortingActivoData=(f,Z)=>this._toolService.sortingActivoData(f,Z)}ngAfterViewInit(){this.allHistorialVentaDataSource.sort=this.historialVentaTableMatSort,this.allHistorialVentaDataSource.paginator=this._paginator}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}ngOnInit(){this.formFiltros(),this.showSkeleton(),this.getFilterComboConsulta()}formFiltros(){this.decodeToken=this.obtenerInfouserInfoLogueado(),this.filtroVentaForm=this._formBuilder.group({usuarios:[""],numeroVenta:[""],fechaVentaInicio:[this._toolService.getStartDateOfMonth()],fechaVentaFin:[this._toolService.getEndDateOfMonth()],montoVentaInicio:[""],montoVentaFin:[""]})}getFilterComboConsulta(){const e=this.obtenerRequest();(0,N.D)({dataUsuarios:this._ventaService.GetAllUsuariosAsync(),dataVentas:this._ventaService.GetAllByFilterAsync(e)}).subscribe({next:n=>{if(this.allUsuarioSource=n.dataUsuarios,this.allHistorialVentaDataSource.data=n.dataVentas,this.pageSlice.data=[],this.filtroVentaForm.get("usuarios")?.setValue(this.allUsuarioSource),this.allHistorialVentaDataSource.data.length>s.Q6.Cero)return this.disabledExportar=s.vU.False,this.setPageSlice(this.allHistorialVentaDataSource.data),this.disabledBuscar=s.vU.False,void this.hideSkeleton();this.textoResultadoTable=s.RO.NoDataResult,this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.True,this.hideSkeleton()},error:n=>{this.hideSkeleton(),this._toolService.showError(c.J.Transaction,c.J.Tittle),this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.True,console.log(n)}})}GetAllHistorialVentasByFilterAsync(e,n){const a=this.obtenerRequest();this.disabledBuscar=e,this._ventaService.GetAllByFilterAsync(a).subscribe(r=>{if(this.allHistorialVentaDataSource.data=r,this.pageSlice.data=[],this.allHistorialVentaDataSource.data.length>s.Q6.Cero)return this.disabledExportar=s.vU.False,this.setPageSlice(this.allHistorialVentaDataSource.data),this.disabledBuscar=s.vU.False,this.hideSkeleton(),void(n&&this.closedDrawer());this.textoResultadoTable=s.RO.NoDataResult,this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.True,this.hideSkeleton(),n&&this.closedDrawer()},r=>{this.hideSkeleton(),this._toolService.showError(c.J.Transaction,c.J.Tittle),this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.True,console.log(r),n&&this.closedDrawer()})}showFormDetalleVentaDialog(e){const n=new ae,a=this._toolService.getTimeZone(),r=this.decodeToken.idUsuario,l=e.idVenta;A.a.isEmptyInputValue(l)?this._toolService.showWarning(c.T.InvalidVenta,c.T.Tittle):A.a.isEmptyInputValue(a)?this._toolService.showWarning(c.T.InvalidLocalizacion,c.T.Tittle):A.a.isEmptyInputValue(r)?this._toolService.showWarning(c.T.InvalidUIdUsuario,c.T.Tittle):(this.disabledAcciones=s.vU.True,n.destinationTimeZoneId=a,n.idUsuario=r,n.idVenta=l,this._detalleventaService.GetDetalleAsync(n).subscribe(d=>{this.disabledAcciones=s.vU.False,this._matDialog.open(rt,{autoFocus:s.vU.False,data:{lstDetalleVenta:d,monedaInfo:this.monedaInfo,numeroVenta:e.numeroVenta}})},d=>{this.hideSkeleton(),this._toolService.showError(c.J.Transaction,c.J.Tittle),this.disabledBuscar=s.vU.False,this.disabledAcciones=s.vU.False}))}AnulaAsync(e){this.configForm=this._formBuilder.group({title:"Anular Venta",message:"\xbfSeguro que quieres anular la venta "+e.numeroVenta+"?.",icon:this._formBuilder.group({show:!0,name:"heroicons_outline:exclamation-triangle",color:"warn"}),actions:this._formBuilder.group({confirm:this._formBuilder.group({show:!0,label:"Borrar",color:"warn"}),cancel:this._formBuilder.group({show:!0,label:"Cancelar"})}),dismissible:!0}),this._fuseConfirmationService.open(this.configForm.value).afterClosed().subscribe(a=>{if("confirmed"!=a)return;const r=this._toolService.getTimeZone(),l=this.decodeToken.idUsuario,d=e.idVenta;if(A.a.isEmptyInputValue(d))return void this._toolService.showWarning(c.T.InvalidMarca,c.T.Tittle);if(A.a.isEmptyInputValue(r))return void this._toolService.showWarning(c.T.InvalidLocalizacion,c.T.Tittle);if(A.a.isEmptyInputValue(l))return void this._toolService.showWarning(c.T.InvalidUIdUsuario,c.T.Tittle);const g=new oe;g.destinationTimeZoneIdActualizacion=r,g.id=d,g.idUsuario=l,this.disabledAcciones=s.vU.True,this._ventaService.AnulaAsync(g).subscribe(f=>f.code==s.Pc.Advertencia?(this._toolService.showWarning(f.message,f.titleMessage),this.disabledAcciones=s.vU.False,void this.hideSkeleton()):f.success?(this._toolService.showSuccess(f.message,f.titleMessage),this.setPageSlice(this.allHistorialVentaDataSource.data),this.disabledAcciones=s.vU.False,this.getSkeletonCount(),this.showSkeleton(),void this.GetAllHistorialVentasByFilterAsync(s.vU.True,s.vU.True)):(this._toolService.showError(c.J.Transaction,c.J.Tittle),void(this.disabledAcciones=s.vU.False)),f=>{this.hideSkeleton(),this.disabledAcciones=s.vU.False,this._toolService.showError(c.J.Transaction,c.J.Tittle),console.log(f)})})}btnBuscar(){this.getSkeletonCount(),this.showSkeleton(),this.GetAllHistorialVentasByFilterAsync(s.vU.True,s.vU.True)}onExportar(){if(this.pageSlice.data.length===s.Q6.Cero)return;const e=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda),n=s.Dq.NombreExcelExportarVentas,a=s.Dq.NombreHojaExcelVentas,l=[];this.allHistorialVentaDataSource.data.forEach(_=>{const v={"N\xfamero Venta":_.numeroVenta,"Nombre Cliente":_.nombreCliente,"Correo Usuario":_.correoUsuario,"Fecha Venta":this._toolService.formatoFecha(_.fechaVenta),"Total Venta":e.format(_.totalVenta),"\xbfAnulado?":_.estado==s.vU.False?"No":"Si"};l.push(v)});const d=z.utils.json_to_sheet(l,{header:["N\xfamero Venta","Nombre Cliente","Correo Usuario","Fecha Venta","Total Venta","\xbfAnulado?"]}),g=l.reduce((_,v)=>(Object.keys(v).forEach((J,ft)=>{const Ja=v[J]?v[J].toString().length:20;_[ft]=Math.max(_[ft]||20,Ja)}),_),[]);d["!cols"]=g.map(_=>({width:_+s.Q6.Cuatro})),["A1","B1","C1","D1","E1","F1","G1","H1","I1"].forEach(_=>{d[_]&&(d[_].s={fill:{fgColor:{rgb:"4f46e5"}},font:{bold:!0,color:{rgb:"ffffff"}},alignment:{horizontal:"center",vertical:"center"},border:{bottom:{style:"thin",color:{rgb:"000000"}}}})}),Object.keys(d).forEach(_=>{const v=_[0],J=parseInt(_.substring(1),10);!isNaN(J)&&J>1&&("A"===v||"B"===v||"C"===v||"D"===v||"E"===v||"F"===v||"G"===v||"H"===v||"J"===v||"K"===v||"I"===v)&&d[_]&&(d[_].s={alignment:{horizontal:"center",vertical:"center"}})});const Z=z.utils.book_new();z.utils.book_append_sheet(Z,d,a),z.writeFile(Z,n)}verComprobante(e){e&&window.open(e.urlBoletaFactura,"_blank")}obtenerRequest(){const e=new ee;return e.destinationTimeZoneId=this._toolService.getTimeZone(),e.idUsuario=this.decodeToken.idUsuario,e.lstUsuario=[],e.numeroVenta=""==this.filtroVentaForm.get("numeroVenta").value?null:this.filtroVentaForm.get("numeroVenta").value,e.fechaVentaInicio=""==this.filtroVentaForm.get("fechaVentaInicio").value?null:this.filtroVentaForm.get("fechaVentaInicio").value,e.fechaVentaFin=""==this.filtroVentaForm.get("fechaVentaFin").value?null:this.filtroVentaForm.get("fechaVentaFin").value,e.montoVentaInicio=""==this.filtroVentaForm.get("montoVentaInicio").value?null:this.filtroVentaForm.get("montoVentaInicio").value,e.montoVentaFin=""==this.filtroVentaForm.get("montoVentaFin").value?null:this.filtroVentaForm.get("montoVentaFin").value,this.selectUsuarioItem&&this.selectUsuarioItem.options.filter(a=>1==a.selected&&0!=a.value).forEach(a=>{e.lstUsuario?.push(a.value.correoElectronico)}),e}obtenerInfouserInfoLogueado(){return this._securityService.getDecodetoken()}obtenerInfoMoneda(){return this._securityService.getMonedaStorage()}trackByFn(e,n){return n.id||e}onPageChange(e){const n=e.pageIndex*e.pageSize;let a=n+e.pageSize;a>this.allHistorialVentaDataSource.data.length&&(a=this.allHistorialVentaDataSource.data.length),this.pageSlice.data=this.allHistorialVentaDataSource.data.slice(n,a)}setPageSlice(e){this.pageSlice.data=e.slice(s.Q6.Cero,s.Q6.Cinco),this._paginator&&(this._paginator.pageIndex=s.Q6.Cero,this._paginator.pageSize=s.Q6.Cinco)}isMobilSize(){return this._toolService.isMobilSize()}closedDrawer(){this.matDrawer.close()}getSkeletonCount(){this.skeletonNumber=this.allHistorialVentaDataSource.data.length==s.Q6.Cero?s.Q6.Ocho:this.allHistorialVentaDataSource.data.length+s.Q6.Uno}showSkeleton(){this.skeleton=s.vU.Show}hideSkeleton(){this.skeleton=s.vU.Hide}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(L.uw),t.Y36(tt.R),t.Y36(m.QS),t.Y36(y.I),t.Y36(et),t.Y36(H.n),t.Y36(D.o))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-historial-ventas-page"]],viewQuery:function(n,a){if(1&n&&(t.Gf(Me,5),t.Gf(Je,5,F.YE),t.Gf(Re,5),t.Gf(w.NW,5)),2&n){let r;t.iGM(r=t.CRH())&&(a.selectUsuarioItem=r.first),t.iGM(r=t.CRH())&&(a.historialVentaTableMatSort=r.first),t.iGM(r=t.CRH())&&(a.matDrawer=r.first),t.iGM(r=t.CRH())&&(a._paginator=r.first)}},features:[t._Bn([{provide:w.ye,useClass:te}])],decls:74,vars:33,consts:[[1,"flex-auto","h-full"],["autoFocus","false",1,"w-90",3,"mode"],["matDrawer",""],[1,"flex","items-center","justify-between","m-4","mr-3","sm:my-5"],[1,"text-3xl","font-semibold","tracking-tight","leading-8"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"flex","flex-col","flex-auto","h-full","dark:bg-default"],[1,"flex","flex-col","flex-auto","shrink-0","pt-6","bg-card","dark:bg-transparent"],[1,"flex","flex-col","px-6",3,"formGroup"],[1,"w-full",3,"appearance"],["multiple","",3,"formControlName"],["selectUsuarioItem",""],[4,"ngIf"],[3,"model","values"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","numeroVenta","maxlength","50","autocomplete","off"],["autocomplete","off","matInput","",3,"min","max","matDatepicker","formControlName","click"],["matSuffix","",3,"for"],["pickerInicio",""],["pickerFin",""],["autocomplete","off","matInput","","appTwoDigitDecimaNumber","","formControlName","montoVentaInicio"],["autocomplete","off","matInput","","appTwoDigitDecimaNumber","","formControlName","montoVentaFin"],["mat-flat-button","",1,"mt-4","mb-8",3,"color","disabled","click"],["class","icon-size-2",3,"svgIcon",4,"ngIf"],["class","ml-2",4,"ngIf"],[3,"diameter","mode",4,"ngIf"],[1,"flex","flex-col"],[1,"flex","flex-col","flex-auto","w-full"],[1,"flex","flex-wrap","w-full","max-w-screen-xl","mx-auto","p-6","md:p-8"],[1,"flex","items-center","justify-between","w-full"],[1,"flex-1","min-w-0"],[1,"mt-2"],[1,"text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-8"],[1,"flex","flex-wrap","items-center","font-medium"],[1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"flex","items-center","ml-6"],[1,"w-full"],["class","skeleton-default  bg-card shadow rounded-2xl overflow-hidden ",4,"ngIf"],[1,"grid","grid-cols-1","xl:grid-cols-1","gap-8","w-full","mt-6"],["class","xl:col-span-1 flex flex-col flex-auto bg-card shadow rounded-2xl overflow-hidden",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"value"],[1,"icon-size-2",3,"svgIcon"],[1,"ml-2"],[3,"diameter","mode"],["mat-icon-button","",3,"matMenuTriggerFor"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"ml-1"],["mat-flat-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"color","click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"click"],[1,"skeleton-default","bg-card","shadow","rounded-2xl","overflow-hidden"],[3,"count","theme"],[1,"xl:col-span-1","flex","flex-col","flex-auto","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"overflow-x-auto","mx-6"],["mat-table","","matSort","",1,"w-full","bg-transparent","mb-3",3,"dataSource","trackBy"],["historialVentaTable",""],["matColumnDef","numeroVenta"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","min-w-40",4,"matCellDef"],["matColumnDef","nombreCliente",1,"min-w-50"],["mat-cell","",4,"matCellDef"],["matColumnDef","correoUsuario"],["matColumnDef","fechaVenta"],["mat-cell","","style","min-width: 180px",4,"matCellDef"],["matColumnDef","totalVenta"],["mat-header-cell","","mat-sort-header","","class","min-w-10",4,"matHeaderCellDef"],["matColumnDef","estado"],["mat-cell","","class","min-w-10 text-center",4,"matCellDef"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","paginator",4,"ngIf"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"min-w-40"],[1,"flex","items-center"],[1,"ml-3","leading-4"],["mat-cell",""],[1,"pr-6","whitespace-nowrap"],[1,"text-blue-500","hover:underline",3,"href"],["mat-cell","",2,"min-width","180px"],["mat-header-cell","","mat-sort-header","",1,"min-w-10"],[1,"pr-6","w-auto","h-auto","rounded-full",2,"color","#056DB6"],["mat-cell","",1,"min-w-10","text-center"],[1,"inline-flex","items-center","font-bold","text-xs","px-2.5","py-0.5","rounded-full","tracking-wide","uppercase",3,"ngClass"],[1,"leading-relaxed","whitespace-nowrap"],["mat-icon-button","",3,"matMenuTriggerFor","disabled"],["menu","matMenu"],["svgIcon","feather:eye"],["mat-menu-item","",3,"click",4,"ngIf"],["svgIcon","feather:trash-2"],["mat-header-row",""],["mat-row",""],[1,"paginator"],["aria-label","Seleccione p\xe1gina",3,"length","pageSize","pageSizeOptions","page"],["paginator",""],["alt","No hay datos disponibles",1,"w-72","mx-auto","mt-2",3,"src"],[1,"mt-4","sm:mt-8","text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-tight","md:leading-none","text-center"],[1,"mt-2","text-gray-500","text-center"]],template:function(n,a){if(1&n){const r=t.EpF();t.TgZ(0,"mat-drawer-container",0)(1,"mat-drawer",1,2)(3,"div",3)(4,"div",4),t._uU(5,"Filtrar por:"),t.qZA(),t.TgZ(6,"div")(7,"button",5),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(2);return t.KtG(d.close())}),t._UZ(8,"mat-icon",6),t.qZA()()(),t.TgZ(9,"div",7)(10,"div",8)(11,"form",9)(12,"mat-form-field",10)(13,"mat-label"),t._uU(14,"Usuarios"),t.qZA(),t.TgZ(15,"mat-select",11,12)(17,"mat-select-trigger"),t.YNc(18,Ee,2,1,"ng-container",13),t.qZA(),t._UZ(19,"app-selectAll",14),t.YNc(20,Ne,2,2,"mat-option",15),t.qZA()(),t.TgZ(21,"mat-form-field",10)(22,"mat-label"),t._uU(23,"N\xfamero de Venta"),t.qZA(),t._UZ(24,"input",16),t.qZA(),t.TgZ(25,"mat-form-field",10)(26,"mat-label"),t._uU(27,"Fecha Venta Inicio"),t.qZA(),t.TgZ(28,"input",17),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(31);return t.KtG(d.open())}),t.qZA(),t._UZ(29,"mat-datepicker-toggle",18)(30,"mat-datepicker",null,19),t.qZA(),t.TgZ(32,"mat-form-field",10)(33,"mat-label"),t._uU(34,"Fecha Venta Fin"),t.qZA(),t.TgZ(35,"input",17),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(38);return t.KtG(d.open())}),t.qZA(),t._UZ(36,"mat-datepicker-toggle",18)(37,"mat-datepicker",null,20),t.qZA(),t.TgZ(39,"mat-form-field",10)(40,"mat-label"),t._uU(41,"Monto Venta Inicio"),t.qZA(),t._UZ(42,"input",21),t.qZA(),t.TgZ(43,"mat-form-field",10)(44,"mat-label"),t._uU(45,"Monto Venta Fin"),t.qZA(),t._UZ(46,"input",22),t.qZA(),t.TgZ(47,"button",23),t.NdJ("click",function(){return a.btnBuscar()}),t.YNc(48,ze,1,1,"mat-icon",24)(49,He,2,0,"span",25)(50,Be,1,2,"mat-progress-spinner",26),t.qZA()()()()(),t.TgZ(51,"mat-drawer-content",27)(52,"div",28)(53,"div",29)(54,"div",30)(55,"div",31)(56,"div",32)(57,"h2",33),t._uU(58,"Historial "),t.qZA()(),t.TgZ(59,"div",34)(60,"div")(61,"a",35),t._uU(62,"Ventas"),t.qZA()(),t.TgZ(63,"div",36),t._UZ(64,"mat-icon",37),t.TgZ(65,"a",38),t._uU(66,"Historial"),t.qZA()()()(),t.TgZ(67,"div",39),t.YNc(68,Oe,12,4)(69,Ye,8,4),t.qZA()(),t.TgZ(70,"div",40),t.YNc(71,Le,2,3,"div",41),t.TgZ(72,"div",42),t.YNc(73,xo,29,6,"div",43),t.qZA()()()()()()}if(2&n){const r=t.MAs(16),l=t.MAs(31),d=t.MAs(38);t.xp6(1),t.Q6J("mode","over"),t.xp6(7),t.Q6J("svgIcon","heroicons_outline:x-mark"),t.xp6(3),t.Q6J("formGroup",a.filtroVentaForm),t.xp6(1),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("formControlName","usuarios"),t.xp6(3),t.Q6J("ngIf",(null==r.value?null:r.value.length)>0),t.xp6(1),t.Q6J("model",a.filtroVentaForm.get("usuarios"))("values",a.allUsuarioSource),t.xp6(1),t.Q6J("ngForOf",a.allUsuarioSource),t.xp6(1),t.Q6J("appearance","outline"),t.xp6(4),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",l)("formControlName","fechaVentaInicio"),t.xp6(1),t.Q6J("for",l),t.xp6(3),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",d)("formControlName","fechaVentaFin"),t.xp6(1),t.Q6J("for",d),t.xp6(3),t.Q6J("appearance","outline"),t.xp6(4),t.Q6J("appearance","outline"),t.xp6(4),t.Q6J("color","primary")("disabled",a.filtroVentaForm.invalid||a.disabledBuscar),t.xp6(1),t.Q6J("ngIf",!a.disabledBuscar),t.xp6(1),t.Q6J("ngIf",!a.disabledBuscar),t.xp6(1),t.Q6J("ngIf",a.disabledBuscar),t.xp6(14),t.Q6J("svgIcon","heroicons_mini:chevron-right"),t.xp6(4),t.um2(68,a.isMobilSize()?68:69),t.xp6(3),t.Q6J("ngIf",a.skeleton),t.xp6(2),t.Q6J("ngIf",!a.skeleton)}},dependencies:[h.mk,h.sg,h.O5,B.K,ke.f,m._Y,m.Fj,m.JJ,m.JL,m.nD,m.sg,m.u,k.Nt,x.KE,x.hX,x.R9,b.VK,b.OP,b.p6,S.gD,S.$L,U.ey,M.Ou,C.jA,C.kh,C.LW,V.lW,V.RK,P.Hw,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,w.NW,F.YE,F.nU,T.Mq,T.hl,T.nW,O.xr,h.i8,h.H9,h.uU]})}return o})();var vo=u(2993),lt=u(3362),ct=u(2025),j=u(6903);const bo=["selectCategoriaItem"],Co=["matDrawer"];function To(o,i){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Fecha Venta inicio es requerido"),t.qZA())}function Vo(o,i){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Fecha Venta fin es requerido"),t.qZA())}function Zo(o,i){1&o&&(t.ynx(0),t._uU(1,", "),t.BQk())}function Ao(o,i){if(1&o&&(t.TgZ(0,"span"),t._UZ(1,"span",35),t._uU(2),t.YNc(3,Zo,2,0,"ng-container",14),t.qZA()),2&o){const e=i.$implicit,n=i.index;t.oxw(2);const a=t.MAs(32);t.xp6(1),t.Udp("background-color",null==e?null:e.color),t.xp6(1),t.hij(" ",e.nombre||"",""),t.xp6(1),t.Q6J("ngIf",n<a.value.length-1)}}function Fo(o,i){if(1&o&&(t.ynx(0),t.YNc(1,Ao,4,4,"span",34),t.BQk()),2&o){t.oxw();const e=t.MAs(32);t.xp6(1),t.Q6J("ngForOf",e.value)}}function wo(o,i){if(1&o&&(t.TgZ(0,"mat-option",36),t._UZ(1,"span",35),t._uU(2),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.Udp("background-color",e.color),t.xp6(1),t.hij(" ",e.nombre,"")}}function So(o,i){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Categor\xeda es requerido"),t.qZA())}function Do(o,i){1&o&&t._UZ(0,"mat-icon",37),2&o&&t.Q6J("svgIcon","heroicons_solid:magnifying-glass")}function yo(o,i){1&o&&(t.TgZ(0,"span",38),t._uU(1,"Buscar"),t.qZA())}function Po(o,i){1&o&&t._UZ(0,"mat-progress-spinner",39),2&o&&t.Q6J("diameter",24)("mode","indeterminate")}function Uo(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",40),t._UZ(1,"mat-icon",6),t.qZA(),t.TgZ(2,"mat-menu",null,41)(4,"button",42),t.NdJ("click",function(){t.CHM(e),t.oxw();const a=t.MAs(2);return t.KtG(a.open())}),t._UZ(5,"mat-icon",6),t.TgZ(6,"span",43),t._uU(7,"Filtrar"),t.qZA()(),t.TgZ(8,"button",44),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.getReportePorCategoriaAsync())}),t._UZ(9,"mat-icon",6),t.TgZ(10,"span",43),t._uU(11,"Exportar"),t.qZA()()()}if(2&o){const e=t.MAs(3),n=t.oxw();t.Q6J("matMenuTriggerFor",e),t.xp6(1),t.Q6J("svgIcon","heroicons_mini:ellipsis-vertical"),t.xp6(4),t.Q6J("svgIcon","heroicons_solid:adjustments-horizontal"),t.xp6(3),t.Q6J("disabled",n.filtroAnalisisVentasForm.invalid||n.isExportingReport||n.disabledExportar),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:arrow-up-tray")}}function Io(o,i){1&o&&t._UZ(0,"mat-icon",46),2&o&&t.Q6J("svgIcon","heroicons_solid:arrow-up-tray")}function ko(o,i){1&o&&(t.TgZ(0,"span",38),t._uU(1,"Exportar"),t.qZA())}function Mo(o,i){1&o&&t._UZ(0,"mat-progress-spinner",39),2&o&&t.Q6J("diameter",24)("mode","indeterminate")}function Jo(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",45),t.NdJ("click",function(){t.CHM(e),t.oxw();const a=t.MAs(2);return t.KtG(a.open())}),t._UZ(1,"mat-icon",46),t.TgZ(2,"span",38),t._uU(3,"Filtrar"),t.qZA()(),t.TgZ(4,"button",47),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.getReportePorCategoriaAsync())}),t.YNc(5,Io,1,1,"mat-icon",48)(6,ko,2,0,"span",22)(7,Mo,1,2,"mat-progress-spinner",23),t.qZA()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("svgIcon","heroicons_solid:adjustments-horizontal"),t.xp6(3),t.Q6J("color","primary")("disabled",e.filtroAnalisisVentasForm.invalid||e.isExportingReport||e.disabledExportar),t.xp6(1),t.Q6J("ngIf",!e.isExportingReport),t.xp6(1),t.Q6J("ngIf",!e.isExportingReport),t.xp6(1),t.Q6J("ngIf",e.isExportingReport)}}const Ro=()=>({"border-radius":"0",height:"50px"});function qo(o,i){1&o&&t._UZ(0,"ngx-skeleton-loader",49),2&o&&t.Q6J("theme",t.DdM(1,Ro))}function Qo(o,i){if(1&o&&(t.TgZ(0,"div",52)(1,"div",53)(2,"div",54)(3,"div",55),t._UZ(4,"img",56),t.TgZ(5,"div",57),t._uU(6),t.qZA(),t.TgZ(7,"div")(8,"p",58),t._uU(9,"Aplique otros filtros de b\xfasqueda "),t.qZA()()()()()()),2&o){const e=t.oxw(2);t.xp6(4),t.Q6J("src",e.imgNoDataHome,t.LSH),t.xp6(2),t.hij(" ",e.textoResultado,"")}}function Eo(o,i){if(1&o&&(t.TgZ(0,"div",59)(1,"div",60)(2,"div",61),t._uU(3,"Evoluci\xf3n por Categorias y Fechas"),t.qZA()(),t.TgZ(4,"div",53)(5,"div",54)(6,"div",54),t._UZ(7,"apx-chart",62),t.qZA()()()(),t.TgZ(8,"div",63)(9,"div",60)(10,"div",64),t._uU(11," Totalizado por Categor\xeda "),t.qZA(),t._UZ(12,"button",65),t.qZA(),t.TgZ(13,"div",54),t._UZ(14,"apx-chart",66),t.qZA()(),t.TgZ(15,"div",63)(16,"div",60)(17,"div",64),t._uU(18," Categor\xedas Destacadas "),t.qZA()(),t.TgZ(19,"div",54),t._UZ(20,"apx-chart",67),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(7),t.Q6J("plotOptions",e.chartEvolucionVentasCategoriaFecha.plotOptions)("series",e.chartEvolucionVentasCategoriaFecha.series)("chart",e.chartEvolucionVentasCategoriaFecha.chart)("xaxis",e.chartEvolucionVentasCategoriaFecha.xaxis)("yaxis",e.chartEvolucionVentasCategoriaFecha.yaxis)("tooltip",e.chartEvolucionVentasCategoriaFecha.tooltip)("dataLabels",e.chartEvolucionVentasCategoriaFecha.dataLabels)("labels",e.chartEvolucionVentasCategoriaFecha.labels)("noData",e.chartEvolucionVentasCategoriaFecha.noData)("grid",e.chartEvolucionVentasCategoriaFecha.grid),t.xp6(7),t.Q6J("series",e.chartTotalizadoCategoria.series)("chart",e.chartTotalizadoCategoria.chart)("labels",e.chartTotalizadoCategoria.labels)("responsive",e.chartTotalizadoCategoria.responsive)("noData",e.chartTotalizadoCategoria.noData)("colors",e.chartTotalizadoCategoria.colors)("tooltip",e.chartTotalizadoCategoria.tooltip)("dataLabels",e.chartTotalizadoCategoria.dataLabels)("plotOptions",e.chartTotalizadoCategoria.plotOptions),t.xp6(6),t.Q6J("series",e.chartTopDiezCategorias.series)("chart",e.chartTopDiezCategorias.chart)("colors",e.chartTopDiezCategorias.colors)("dataLabels",e.chartTopDiezCategorias.dataLabels)("plotOptions",e.chartTopDiezCategorias.plotOptions)("tooltip",e.chartTopDiezCategorias.tooltip)("noData",e.chartTopDiezCategorias.noData)("xaxis",e.chartTopDiezCategorias.xaxis)}}function No(o,i){if(1&o&&(t.TgZ(0,"div",50),t.YNc(1,Qo,10,2,"div",51)(2,Eo,21,27),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.um2(1,0==e.ventasAnalisisDataSource.distribucionVentasCategoria.totalVentasCategorias.length?1:2)}}let dt=(()=>{class o{constructor(e,n,a,r,l){this._securityService=e,this._formBuilder=n,this._toolService=a,this._detalleVentasService=r,this._inventarioService=l,this.disabledExportar=s.vU.False,this.decodeToken=this.obtenerInfouserInfoLogueado(),this.monedaInfo=this.obtenerInfoMoneda(),this.isExportingReport=s.vU.False,this.chartEvolucionVentasCategoriaFecha={},this.chartTotalizadoCategoria={},this.chartTopDiezCategorias={},this.chartEvolucionVentasFecha={},this.disabledBuscar=s.vU.False,this._unsubscribeAll=new I.x,this.skeleton=s.vU.False,this.minDate=this._toolService.getMinDateFIlter(),this.maxDate=this._toolService.getMaxDateFIlter(),this.imgNoDataHome=s.HZ.noDataHome,this.textoResultado=s.RO.NoDataResult,this.filtroRangoFecha=""}ngOnInit(){this.formFiltros(),this.showSkeleton(),this.getResumen(s.vU.False),this.getFilterComboConsulta()}formFiltros(){this.filtroAnalisisVentasForm=this._formBuilder.group({fechaVentaInicio:[this._toolService.getStartDateOfMonth(),[m.kI.required]],fechaVentaFin:[this._toolService.getEndDateOfMonth(),[m.kI.required]],categoria:[""]}),this.currencyNumberFormat=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda)}getFilterComboConsulta(){const e=new lt.Z;e.nombre="",e.idUsuario=this.decodeToken.idUsuario;const n=new vo.l;n.nombre="",n.idUsuario=this.decodeToken.idUsuario,(0,N.D)({dataCategorias:this._inventarioService.GetAllCategoriaByFilterAsync(n),dataMarcas:this._inventarioService.GetAllMarcaByFilterAsync(e)}).subscribe({next:a=>{this.allCategoriaDataSource=a.dataCategorias,this.allMarcasDataSource=a.dataMarcas,this.filtroAnalisisVentasForm.get("categoria")?.setValue(this.allCategoriaDataSource),this.filtroAnalisisVentasForm.get("marca")?.setValue(this.allMarcasDataSource)},error:a=>{this._toolService.showError(c.J.Transaction,c.J.Tittle),this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.True,console.log(a)}})}getResumen(e){this.showSkeleton();const n=this.obtenerRequest();this.disabledBuscar=s.vU.True,this._detalleVentasService.GetAnalisisCategoriasByFilterAsync(n).subscribe(a=>{this.ventasAnalisisDataSource=a,this.disabledBuscar=s.vU.False,this.getFechaFiltroCadena(),this.generateCharts(),e&&this.closedDrawer(),this.hideSkeleton(),this.disabledExportar=a.distribucionVentasCategoria.totalVentasCategorias.length>s.Q6.Cero?s.vU.False:s.vU.True},a=>{this._toolService.showError(c.J.Transaction,c.J.Tittle),this.disabledBuscar=s.vU.False,console.log(a),e&&this.closedDrawer()})}generateCharts(){this.rangoFecha=this.getRangeDate(),this.generarchartEvolucionVentasCategoriaFecha(),this.generarchartTotalizadoCategorias(),this.generarChartTopDiezCategorias(),this.generarChartEvolucionFecha()}generarchartEvolucionVentasCategoriaFecha(){const e=this.ventasAnalisisDataSource.lstEvolucionVentasCategoriaFecha.map(n=>({color:n.colorCategoria,name:n.nombreCategoria,data:this.rangoFecha.map(a=>{const r=n.datosVentasAgrupados.find(l=>this._toolService.formatoFecha(l.fechaVenta)===a);return r?r.montoVentaTotal:s.Q6.Cero})}));this.chartEvolucionVentasCategoriaFecha={series:e,chart:{type:"bar",height:350,stacked:!0,toolbar:{show:!1}},noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},plotOptions:{bar:{horizontal:!1,columnWidth:"55%"}},dataLabels:{enabled:!1,style:{fontSize:"12px"}},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:this.rangoFecha,labels:{rotateAlways:!0,rotate:-45}},yaxis:{labels:{formatter:n=>this.currencyNumberFormat.format(n),style:{fontSize:"12px"}}},fill:{opacity:1},tooltip:{enabled:!0,y:{formatter:n=>this.currencyNumberFormat.format(n)}}}}generarchartTotalizadoCategorias(){const e=this.isMobilSize(),n=this.ventasAnalisisDataSource.distribucionVentasCategoria.totalVentasCategorias.reduce((a,r)=>a+r,0);this.chartTotalizadoCategoria={chart:{type:"donut",fontFamily:"inherit",foreColor:"inherit",height:"95%"},responsive:[{breakpoint:600,options:{chart:{width:"100%",height:350},legend:{position:"bottom"}}}],labels:this.ventasAnalisisDataSource.distribucionVentasCategoria.nombreCategorias,series:this.ventasAnalisisDataSource.distribucionVentasCategoria.totalVentasCategorias,noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},colors:this.ventasAnalisisDataSource.distribucionVentasCategoria.coloresCategorias,tooltip:{enabled:!0,y:{formatter:a=>this.currencyNumberFormat.format(a)}},dataLabels:{enabled:!0},plotOptions:{pie:{donut:{labels:{show:!0,name:{show:!1},value:{show:!0,fontSize:e?"19px":"22px",color:"#494949",offsetY:0,formatter:()=>this.currencyNumberFormat.format(n)},total:{show:!0,showAlways:!0,label:"",fontSize:e?"19px":"22px",color:"#494949",formatter:()=>this.currencyNumberFormat.format(n)}}}}}}}generarChartTopDiezCategorias(){const e=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda);this.chartTopDiezCategorias={series:[{name:"Total",data:this.ventasAnalisisDataSource.topDiezCategoriasVentas.totalMontos}],noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},colors:this.ventasAnalisisDataSource.topDiezCategoriasVentas.colores,chart:{type:"bar",height:350,toolbar:{show:!1}},plotOptions:{bar:{barHeight:"100%",distributed:!0,horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,textAnchor:"middle",formatter:function(n){return e.format(n)},offsetY:-6,style:{colors:["#FFFFFF"],fontSize:"12px",fontWeight:"bold"},dropShadow:{enabled:!0,top:1,left:1,blur:2,color:"#000000",opacity:.5}},stroke:{width:1,colors:["#fff"]},tooltip:{enabled:!0,y:{formatter:n=>e.format(n)}},xaxis:{categories:this.ventasAnalisisDataSource.topDiezCategoriasVentas.categorias,labels:{show:!1,style:{fontSize:"12px"},formatter:function(n){return"number"==typeof n?e.format(n):n}}}}}generarChartEvolucionFecha(){const e=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda);this.chartEvolucionVentasFecha={series:[{color:"#056DB6",name:"Total",data:this.ventasAnalisisDataSource.evolucionVentasFecha.totalVenta}],noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},chart:{height:350,type:"line",zoom:{enabled:!1},toolbar:{show:!1}},dataLabels:{enabled:!0,textAnchor:"start",formatter:function(n){return e.format(n)},offsetX:0,dropShadow:{enabled:!0}},stroke:{show:!0,width:2,colors:["transparent"]},tooltip:{enabled:!0,y:{formatter:n=>e.format(n)}},yaxis:{labels:{formatter:n=>this.currencyNumberFormat.format(n),style:{fontSize:"12px"}}},xaxis:{categories:this.rangoFecha,labels:{show:!0,style:{fontSize:"12px"},formatter:function(n){return"number"==typeof n?e.format(n):n},rotateAlways:!0,rotate:-45}},fill:{opacity:1}}}getReportePorCategoriaAsync(){if(this.ventasAnalisisDataSource.distribucionVentasCategoria.totalVentasCategorias.length==s.Q6.Cero&&this.ventasAnalisisDataSource.distribucionVentasCategoria.totalVentasCategorias.length==s.Q6.Cero||this.filtroAnalisisVentasForm.invalid)return;const e=this.obtenerRequestReporte();this.isExportingReport=s.vU.True,this._detalleVentasService.GetReportePorCategoriasAsync(e).subscribe(n=>{if(this.isExportingReport=s.vU.False,n){const a=window.URL.createObjectURL(new Blob([n],{type:"application/vnd.ms-excel"})),r=document.createElement("a");r.download=`Reporte_Venta_Por_Categorias_${this.getFechaFiltroCadenaReporte()}.xlsx`,r.href=a,r.click(),r.parentNode?.removeChild(r)}},n=>{if(n.status==s.GL.Forbidden)return this._toolService.showWarning(c.T.InvalidPermisos,c.T.Tittle),this.isExportingReport=s.vU.False=s.vU.False,void console.log(n);this._toolService.showError(c.J.Transaction,c.J.Tittle),this.isExportingReport=s.vU.False,console.log(n)})}getFechaFiltroCadenaReporte(){return`del_${this._toolService.formatoFecha(this.fechaInicio)}_hasta_${this._toolService.formatoFecha(this.fechaFin)}`.trim()}getRangeDate(){return this.ventasAnalisisDataSource.evolucionVentasFecha.fechaVenta.map(e=>this._toolService.formatoFecha(e))}isMobilSize(){return this._toolService.isMobilSize()}obtenerRequest(){const e=new ct.I;return e.destinationTimeZoneId=this._toolService.getTimeZone(),e.idUsuario=this.decodeToken.idUsuario,e.fechaVentaInicio=""==this.filtroAnalisisVentasForm.get("fechaVentaInicio").value?null:this.filtroAnalisisVentasForm.get("fechaVentaInicio").value,e.fechaVentaFin=""==this.filtroAnalisisVentasForm.get("fechaVentaFin").value?null:this.filtroAnalisisVentasForm.get("fechaVentaFin").value,e.lstCategorias=[],this.selectCategorias&&this.selectCategorias.options.filter(a=>1==a.selected&&0!=a.value).forEach(a=>{e.lstCategorias?.push(a.value.id)}),this.fechaInicio=e.fechaVentaInicio,this.fechaFin=e.fechaVentaFin,e}obtenerRequestReporte(){const e=new ct.I;return e.destinationTimeZoneId=this._toolService.getTimeZone(),e.idUsuario=this.decodeToken.idUsuario,e.fechaVentaInicio=""==this.filtroAnalisisVentasForm.get("fechaVentaInicio").value?null:this.filtroAnalisisVentasForm.get("fechaVentaInicio").value,e.fechaVentaFin=""==this.filtroAnalisisVentasForm.get("fechaVentaFin").value?null:this.filtroAnalisisVentasForm.get("fechaVentaFin").value,e.lstCategorias=[],this.fechaInicio=e.fechaVentaInicio,this.fechaFin=e.fechaVentaFin,this.selectCategorias&&this.selectCategorias.options.filter(a=>1==a.selected&&0!=a.value).forEach(a=>{e.lstCategorias?.push(a.value.id)}),e}getFechaFiltroCadena(){const e=this._toolService.formatoFecha(this.fechaInicio),n=this._toolService.formatoFecha(this.fechaFin);this.filtroRangoFecha=`Desde ${e} Hasta ${n}`.trim()}obtenerInfouserInfoLogueado(){return this._securityService.getDecodetoken()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closedDrawer(){this.matDrawer.close()}showSkeleton(){this.skeleton=s.vU.Show}hideSkeleton(){this.skeleton=s.vU.Hide}obtenerInfoMoneda(){return this._securityService.getMonedaStorage()}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(y.I),t.Y36(m.QS),t.Y36(D.o),t.Y36(H.n),t.Y36(R.I))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-reporte-ventas-categorias-page"]],viewQuery:function(n,a){if(1&n&&(t.Gf(bo,5),t.Gf(Co,5)),2&n){let r;t.iGM(r=t.CRH())&&(a.selectCategorias=r.first),t.iGM(r=t.CRH())&&(a.matDrawer=r.first)}},decls:57,vars:33,consts:[[1,"flex-auto","h-full"],["autoFocus","false",1,"w-90",3,"mode"],["matDrawer",""],[1,"flex","items-center","justify-between","m-4","mr-3","sm:my-5"],[1,"text-3xl","font-semibold","tracking-tight","leading-8"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"flex","flex-col","flex-auto","h-full","dark:bg-default"],[1,"flex","flex-col","flex-auto","shrink-0","pt-6","bg-card","dark:bg-transparent"],[1,"flex","flex-col","px-6",3,"formGroup"],[1,"w-full",3,"appearance"],["autocomplete","off","matInput","",3,"min","max","matDatepicker","formControlName","click"],["matSuffix","",3,"for"],["pickerInicio",""],[4,"ngIf"],["pickerFin",""],["multiple","",3,"formControlName"],["selectCategoriaItem",""],[3,"model","values"],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","",1,"mt-4","mb-8",3,"color","disabled","click"],["class","icon-size-2",3,"svgIcon",4,"ngIf"],["class","ml-2",4,"ngIf"],[3,"diameter","mode",4,"ngIf"],[1,"flex","flex-col"],[1,"flex","flex-col","flex-auto","w-full"],[1,"flex","flex-wrap","w-full","max-w-screen-xl","mx-auto","p-6","md:p-8"],[1,"flex","items-center","justify-between","w-full"],[1,"text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-8"],[1,"font-medium","tracking-tight","text-secondary"],[1,"flex","items-center","ml-6"],[1,"grid","grid-cols-1","xl:grid-cols-1","gap-8","w-full","mt-6"],["class"," sm:col-span-2 md:col-span-4 flex flex-col flex-auto p-6 bg-card shadow rounded-2xl overflow-hidden","count","40",3,"theme",4,"ngIf"],["class","grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 w-full min-w-0",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"color-indicator"],[3,"value"],[1,"icon-size-2",3,"svgIcon"],[1,"ml-2"],[3,"diameter","mode"],["mat-icon-button","",3,"matMenuTriggerFor"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"ml-1"],["mat-menu-item","",3,"disabled","click"],["mat-stroked-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-flat-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"color","disabled","click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],["count","40",1,"sm:col-span-2","md:col-span-4","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden",3,"theme"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-4","gap-6","w-full","min-w-0"],["class","sm:col-span-2 md:col-span-4 flex flex-col    overflow-hidden"],[1,"sm:col-span-2","md:col-span-4","flex","flex-col","overflow-hidden"],[1,"grid","grid-cols-1","lg:grid-cols-1","grid-flow-row","gap-6","w-full","mt-8","sm:mt-4"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","items-center"],["alt","No hay datos disponibles",1,"w-72","object-cover",3,"src"],[1,"mt-4","sm:mt-8","text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-tight","md:leading-none","text-center"],[1,"mt-2","text-gray-500","text-center"],[1,"sm:col-span-2","md:col-span-4","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"flex","justify-between","items-center"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate"],[3,"plotOptions","series","chart","xaxis","yaxis","tooltip","dataLabels","labels","noData","grid"],[1,"sm:col-span-2","lg:col-span-2","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate","text-black"],["mat-icon-button","","color","primary"],[1,"flex-auto","w-full","h-80",3,"series","chart","labels","responsive","noData","colors","tooltip","dataLabels","plotOptions"],[3,"series","chart","colors","dataLabels","plotOptions","tooltip","noData","xaxis"]],template:function(n,a){if(1&n){const r=t.EpF();t.TgZ(0,"mat-drawer-container",0)(1,"mat-drawer",1,2)(3,"div",3)(4,"div",4),t._uU(5,"Filtrar por:"),t.qZA(),t.TgZ(6,"div")(7,"button",5),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(2);return t.KtG(d.close())}),t._UZ(8,"mat-icon",6),t.qZA()()(),t.TgZ(9,"div",7)(10,"div",8)(11,"form",9)(12,"mat-form-field",10)(13,"mat-label"),t._uU(14,"Fecha Venta Inicio"),t.qZA(),t.TgZ(15,"input",11),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(18);return t.KtG(d.open())}),t.qZA(),t._UZ(16,"mat-datepicker-toggle",12)(17,"mat-datepicker",null,13),t.YNc(19,To,2,0,"mat-error",14),t.qZA(),t.TgZ(20,"mat-form-field",10)(21,"mat-label"),t._uU(22,"Fecha Venta Fin"),t.qZA(),t.TgZ(23,"input",11),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(26);return t.KtG(d.open())}),t.qZA(),t._UZ(24,"mat-datepicker-toggle",12)(25,"mat-datepicker",null,15),t.YNc(27,Vo,2,0,"mat-error",14),t.qZA(),t.TgZ(28,"mat-form-field",10)(29,"mat-label"),t._uU(30,"Categor\xedas"),t.qZA(),t.TgZ(31,"mat-select",16,17)(33,"mat-select-trigger"),t.YNc(34,Fo,2,1,"ng-container",14),t.qZA(),t._UZ(35,"app-selectAll",18),t.YNc(36,wo,3,4,"mat-option",19),t.qZA(),t.YNc(37,So,2,0,"mat-error",14),t.qZA(),t.TgZ(38,"button",20),t.NdJ("click",function(){return a.getResumen(!0)}),t.YNc(39,Do,1,1,"mat-icon",21)(40,yo,2,0,"span",22)(41,Po,1,2,"mat-progress-spinner",23),t.qZA()()()()(),t.TgZ(42,"mat-drawer-content",24)(43,"div",25)(44,"div",26)(45,"div",27)(46,"div")(47,"h2",28),t._uU(48,"Reporte de Ventas por Categor\xedas "),t.qZA(),t.TgZ(49,"div",29),t._uU(50),t.qZA()(),t.TgZ(51,"div",30),t.YNc(52,Uo,12,5)(53,Jo,8,6),t.qZA()(),t.TgZ(54,"div",31),t.YNc(55,qo,1,2,"ngx-skeleton-loader",32)(56,No,3,1,"div",33),t.qZA()()()()()}if(2&n){const r=t.MAs(18),l=t.MAs(26),d=t.MAs(32);t.xp6(1),t.Q6J("mode","over"),t.xp6(7),t.Q6J("svgIcon","heroicons_outline:x-mark"),t.xp6(3),t.Q6J("formGroup",a.filtroAnalisisVentasForm),t.xp6(1),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",r)("formControlName","fechaVentaInicio"),t.xp6(1),t.Q6J("for",r),t.xp6(3),t.Q6J("ngIf",a.filtroAnalisisVentasForm.get("fechaVentaInicio").hasError("required")),t.xp6(1),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",l)("formControlName","fechaVentaFin"),t.xp6(1),t.Q6J("for",l),t.xp6(3),t.Q6J("ngIf",a.filtroAnalisisVentasForm.get("fechaVentaFin").hasError("required")),t.xp6(1),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("formControlName","categoria"),t.xp6(3),t.Q6J("ngIf",(null==d.value?null:d.value.length)>0),t.xp6(1),t.Q6J("model",a.filtroAnalisisVentasForm.get("categoria"))("values",a.allCategoriaDataSource),t.xp6(1),t.Q6J("ngForOf",a.allCategoriaDataSource),t.xp6(1),t.Q6J("ngIf",a.filtroAnalisisVentasForm.get("categoria").hasError("required")),t.xp6(1),t.Q6J("color","primary")("disabled",a.filtroAnalisisVentasForm.invalid||a.disabledBuscar),t.xp6(1),t.Q6J("ngIf",!a.disabledBuscar),t.xp6(1),t.Q6J("ngIf",!a.disabledBuscar),t.xp6(1),t.Q6J("ngIf",a.disabledBuscar),t.xp6(9),t.hij("",a.filtroRangoFecha," "),t.xp6(2),t.um2(52,a.isMobilSize()?52:53),t.xp6(3),t.Q6J("ngIf",a.skeleton),t.xp6(1),t.Q6J("ngIf",!a.skeleton)}},dependencies:[h.sg,h.O5,B.K,m._Y,m.Fj,m.JJ,m.JL,m.sg,m.u,k.Nt,x.KE,x.hX,x.TO,x.R9,b.VK,b.OP,b.p6,S.gD,S.$L,U.ey,j.x,M.Ou,C.jA,C.kh,C.LW,V.lW,V.RK,P.Hw,T.Mq,T.hl,T.nW,O.xr]})}return o})();var ut=u(8725);const zo=["selectMarcaItem"],Ho=["matDrawer"];function Bo(o,i){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Fecha Venta inicio es requerido"),t.qZA())}function Oo(o,i){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Fecha Venta fin es requerido"),t.qZA())}function Yo(o,i){1&o&&(t.ynx(0),t._uU(1,", "),t.BQk())}function Go(o,i){if(1&o&&(t.TgZ(0,"span"),t._UZ(1,"span",35),t._uU(2),t.YNc(3,Yo,2,0,"ng-container",14),t.qZA()),2&o){const e=i.$implicit,n=i.index;t.oxw(2);const a=t.MAs(32);t.xp6(1),t.Udp("background-color",null==e?null:e.color),t.xp6(1),t.hij(" ",e.nombre||"",""),t.xp6(1),t.Q6J("ngIf",n<a.value.length-1)}}function Lo(o,i){if(1&o&&(t.ynx(0),t.YNc(1,Go,4,4,"span",34),t.BQk()),2&o){t.oxw();const e=t.MAs(32);t.xp6(1),t.Q6J("ngForOf",e.value)}}function jo(o,i){if(1&o&&(t.TgZ(0,"mat-option",36),t._UZ(1,"span",35),t._uU(2),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.Udp("background-color",e.color),t.xp6(1),t.hij(" ",e.nombre,"")}}function $o(o,i){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Marca es requerido"),t.qZA())}function Ko(o,i){1&o&&t._UZ(0,"mat-icon",37),2&o&&t.Q6J("svgIcon","heroicons_solid:magnifying-glass")}function Wo(o,i){1&o&&(t.TgZ(0,"span",38),t._uU(1,"Buscar"),t.qZA())}function Xo(o,i){1&o&&t._UZ(0,"mat-progress-spinner",39),2&o&&t.Q6J("diameter",24)("mode","indeterminate")}function ta(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",40),t._UZ(1,"mat-icon",6),t.qZA(),t.TgZ(2,"mat-menu",null,41)(4,"button",42),t.NdJ("click",function(){t.CHM(e),t.oxw();const a=t.MAs(2);return t.KtG(a.open())}),t._UZ(5,"mat-icon",6),t.TgZ(6,"span",43),t._uU(7,"Filtrar"),t.qZA()(),t.TgZ(8,"button",44),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.getReportePorMarcaAsync())}),t._UZ(9,"mat-icon",6),t.TgZ(10,"span",43),t._uU(11,"Exportar"),t.qZA()()()}if(2&o){const e=t.MAs(3),n=t.oxw();t.Q6J("matMenuTriggerFor",e),t.xp6(1),t.Q6J("svgIcon","heroicons_mini:ellipsis-vertical"),t.xp6(4),t.Q6J("svgIcon","heroicons_solid:adjustments-horizontal"),t.xp6(3),t.Q6J("disabled",n.filtroAnalisisVentasForm.invalid||n.isExportingReport||n.disabledExportar),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:arrow-up-tray")}}function ea(o,i){1&o&&t._UZ(0,"mat-icon",46),2&o&&t.Q6J("svgIcon","heroicons_solid:arrow-up-tray")}function oa(o,i){1&o&&(t.TgZ(0,"span",38),t._uU(1,"Exportar"),t.qZA())}function aa(o,i){1&o&&t._UZ(0,"mat-progress-spinner",39),2&o&&t.Q6J("diameter",24)("mode","indeterminate")}function na(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",45),t.NdJ("click",function(){t.CHM(e),t.oxw();const a=t.MAs(2);return t.KtG(a.open())}),t._UZ(1,"mat-icon",46),t.TgZ(2,"span",38),t._uU(3,"Filtrar"),t.qZA()(),t.TgZ(4,"button",47),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.getReportePorMarcaAsync())}),t.YNc(5,ea,1,1,"mat-icon",48)(6,oa,2,0,"span",22)(7,aa,1,2,"mat-progress-spinner",23),t.qZA()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("svgIcon","heroicons_solid:adjustments-horizontal"),t.xp6(3),t.Q6J("color","primary")("disabled",e.filtroAnalisisVentasForm.invalid||e.isExportingReport||e.disabledExportar),t.xp6(1),t.Q6J("ngIf",!e.isExportingReport),t.xp6(1),t.Q6J("ngIf",!e.isExportingReport),t.xp6(1),t.Q6J("ngIf",e.isExportingReport)}}const ia=()=>({"border-radius":"0",height:"50px"});function ra(o,i){1&o&&t._UZ(0,"ngx-skeleton-loader",49),2&o&&t.Q6J("theme",t.DdM(1,ia))}function sa(o,i){if(1&o&&(t.TgZ(0,"div",52)(1,"div",53)(2,"div",54)(3,"div",55),t._UZ(4,"img",56),t.TgZ(5,"div",57),t._uU(6),t.qZA(),t.TgZ(7,"div")(8,"p",58),t._uU(9,"Aplique otros filtros de b\xfasqueda "),t.qZA()()()()()()),2&o){const e=t.oxw(2);t.xp6(4),t.Q6J("src",e.imgNoDataHome,t.LSH),t.xp6(2),t.hij(" ",e.textoResultado,"")}}function la(o,i){if(1&o&&(t.TgZ(0,"div",59)(1,"div",60)(2,"div",61),t._uU(3,"Evoluci\xf3n por Marcas y Fechas"),t.qZA()(),t.TgZ(4,"div",53)(5,"div",54)(6,"div",54),t._UZ(7,"apx-chart",62),t.qZA()()()(),t.TgZ(8,"div",63)(9,"div",60)(10,"div",64),t._uU(11," Totalizado por Marcas "),t.qZA(),t._UZ(12,"button",65),t.qZA(),t.TgZ(13,"div",54),t._UZ(14,"apx-chart",66),t.qZA()(),t.TgZ(15,"div",63)(16,"div",60)(17,"div",64),t._uU(18," Marcas Destacadas "),t.qZA()(),t.TgZ(19,"div",54),t._UZ(20,"apx-chart",67),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(7),t.Q6J("plotOptions",e.chartEvolucionVentasMarcaFecha.plotOptions)("series",e.chartEvolucionVentasMarcaFecha.series)("chart",e.chartEvolucionVentasMarcaFecha.chart)("xaxis",e.chartEvolucionVentasMarcaFecha.xaxis)("yaxis",e.chartEvolucionVentasMarcaFecha.yaxis)("tooltip",e.chartEvolucionVentasMarcaFecha.tooltip)("dataLabels",e.chartEvolucionVentasMarcaFecha.dataLabels)("labels",e.chartEvolucionVentasMarcaFecha.labels)("noData",e.chartEvolucionVentasMarcaFecha.noData)("grid",e.chartEvolucionVentasMarcaFecha.grid),t.xp6(7),t.Q6J("series",e.chartTotalizadoMarcas.series)("chart",e.chartTotalizadoMarcas.chart)("labels",e.chartTotalizadoMarcas.labels)("responsive",e.chartTotalizadoMarcas.responsive)("noData",e.chartTotalizadoMarcas.noData)("colors",e.chartTotalizadoMarcas.colors)("tooltip",e.chartTotalizadoMarcas.tooltip)("dataLabels",e.chartTotalizadoMarcas.dataLabels)("plotOptions",e.chartTotalizadoMarcas.plotOptions),t.xp6(6),t.Q6J("series",e.chartTopDiezMarcas.series)("chart",e.chartTopDiezMarcas.chart)("colors",e.chartTopDiezMarcas.colors)("dataLabels",e.chartTopDiezMarcas.dataLabels)("plotOptions",e.chartTopDiezMarcas.plotOptions)("tooltip",e.chartTopDiezMarcas.tooltip)("noData",e.chartTopDiezMarcas.noData)("xaxis",e.chartTopDiezMarcas.xaxis)}}function ca(o,i){if(1&o&&(t.TgZ(0,"div",50),t.YNc(1,sa,10,2,"div",51)(2,la,21,27),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.um2(1,0==e.ventasAnalisisDataSource.distribucionVentasMarca.totalVentasMarcas.length?1:2)}}let mt=(()=>{class o{constructor(e,n,a,r,l){this._securityService=e,this._formBuilder=n,this._toolService=a,this._detalleVentasService=r,this._inventarioService=l,this.disabledExportar=s.vU.False,this.decodeToken=this.obtenerInfouserInfoLogueado(),this.monedaInfo=this.obtenerInfoMoneda(),this.isExportingReport=s.vU.False,this.chartEvolucionVentasMarcaFecha={},this.chartTotalizadoMarcas={},this.chartTopDiezMarcas={},this.disabledBuscar=s.vU.False,this._unsubscribeAll=new I.x,this.skeleton=s.vU.False,this.minDate=this._toolService.getMinDateFIlter(),this.maxDate=this._toolService.getMaxDateFIlter(),this.imgNoDataHome=s.HZ.noDataHome,this.textoResultado=s.RO.NoDataResult,this.filtroRangoFecha=""}ngOnInit(){this.formFiltros(),this.showSkeleton(),this.getResumen(s.vU.False),this.getFilterComboConsulta()}formFiltros(){this.filtroAnalisisVentasForm=this._formBuilder.group({fechaVentaInicio:[this._toolService.getStartDateOfMonth(),[m.kI.required]],fechaVentaFin:[this._toolService.getEndDateOfMonth(),[m.kI.required]],marcas:[""]}),this.currencyNumberFormat=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda)}getFilterComboConsulta(){const e=new lt.Z;e.nombre="",e.idUsuario=this.decodeToken.idUsuario,(0,N.D)({dataMarcas:this._inventarioService.GetAllMarcaByFilterAsync(e)}).subscribe({next:n=>{this.allMarcasDataSource=n.dataMarcas,this.filtroAnalisisVentasForm.get("marcas")?.setValue(this.allMarcasDataSource)},error:n=>{this._toolService.showError(c.J.Transaction,c.J.Tittle),this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.True,console.log(n)}})}getResumen(e){this.showSkeleton();const n=this.obtenerRequest();this.disabledBuscar=s.vU.True,this._detalleVentasService.GetAnalisisMarcasByFilterAsync(n).subscribe(a=>{this.ventasAnalisisDataSource=a,this.disabledBuscar=s.vU.False,this.getFechaFiltroCadena(),this.generateCharts(),e&&this.closedDrawer(),this.hideSkeleton(),this.disabledExportar=a.distribucionVentasMarca.totalVentasMarcas.length>s.Q6.Cero?s.vU.False:s.vU.True},a=>{this._toolService.showError(c.J.Transaction,c.J.Tittle),this.disabledBuscar=s.vU.False,console.log(a),e&&this.closedDrawer()})}generateCharts(){this.rangoFecha=this.getRangeDate(),this.generarchartEvolucionVentasMarcaFecha(),this.generarchartTotalizadoMarcas(),this.generarChartTopDiezMarcas()}getRangeDate(){return this.ventasAnalisisDataSource.evolucionVentasFecha.fechaVenta.map(e=>this._toolService.formatoFecha(e))}generarchartEvolucionVentasMarcaFecha(){const e=this.ventasAnalisisDataSource.lstEvolucionVentasMarcaFecha.map(n=>({color:n.colorMarca,name:n.nombreMarca,data:this.rangoFecha.map(a=>{const r=n.datosVentasAgrupados.find(l=>this._toolService.formatoFecha(l.fechaVenta)===a);return r?r.montoVentaTotal:s.Q6.Cero})}));this.chartEvolucionVentasMarcaFecha={series:e,chart:{type:"bar",height:350,stacked:!0,toolbar:{show:!1}},noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},plotOptions:{bar:{horizontal:!1,columnWidth:"55%"}},dataLabels:{enabled:!1,style:{fontSize:"12px"}},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:this.rangoFecha,labels:{rotateAlways:!0,rotate:-45}},yaxis:{labels:{formatter:n=>this.currencyNumberFormat.format(n),style:{fontSize:"12px"}}},fill:{opacity:1},tooltip:{enabled:!0,y:{formatter:n=>this.currencyNumberFormat.format(n)}}}}generarchartTotalizadoMarcas(){const e=this.isMobilSize(),n=this.ventasAnalisisDataSource.distribucionVentasMarca.totalVentasMarcas.reduce((a,r)=>a+r,0);this.chartTotalizadoMarcas={chart:{type:"donut",fontFamily:"inherit",foreColor:"inherit",height:"95%"},responsive:[{breakpoint:600,options:{chart:{width:"100%",height:350},legend:{position:"bottom"}}}],labels:this.ventasAnalisisDataSource.distribucionVentasMarca.nombreMarcas,series:this.ventasAnalisisDataSource.distribucionVentasMarca.totalVentasMarcas,noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},colors:this.ventasAnalisisDataSource.distribucionVentasMarca.coloresMarcas,tooltip:{enabled:!0,y:{formatter:a=>this.currencyNumberFormat.format(a)}},dataLabels:{enabled:!0},plotOptions:{pie:{donut:{labels:{show:!0,name:{show:!1},value:{show:!0,fontSize:e?"19px":"22px",color:"#494949",offsetY:0,formatter:()=>this.currencyNumberFormat.format(n)},total:{show:!0,showAlways:!0,label:"",fontSize:e?"19px":"22px",color:"#494949",formatter:()=>this.currencyNumberFormat.format(n)}}}}}}}generarChartTopDiezMarcas(){const e=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda);this.chartTopDiezMarcas={series:[{name:"Total",data:this.ventasAnalisisDataSource.topDiezMarcasVentas.totalMontos}],noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},colors:this.ventasAnalisisDataSource.topDiezMarcasVentas.colores,chart:{type:"bar",height:350,toolbar:{show:!1}},plotOptions:{bar:{barHeight:"100%",distributed:!0,horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,textAnchor:"middle",formatter:function(n){return e.format(n)},offsetY:-6,style:{colors:["#FFFFFF"],fontSize:"12px",fontWeight:"bold"},dropShadow:{enabled:!0,top:1,left:1,blur:2,color:"#000000",opacity:.5}},stroke:{width:1,colors:["#fff"]},tooltip:{enabled:!0,y:{formatter:n=>e.format(n)}},xaxis:{categories:this.ventasAnalisisDataSource.topDiezMarcasVentas.marcas,labels:{show:!1,style:{fontSize:"12px"},formatter:function(n){return"number"==typeof n?e.format(n):n}}}}}getReportePorMarcaAsync(){if(this.ventasAnalisisDataSource.distribucionVentasMarca.totalVentasMarcas.length==s.Q6.Cero&&this.ventasAnalisisDataSource.distribucionVentasMarca.totalVentasMarcas.length==s.Q6.Cero||this.filtroAnalisisVentasForm.invalid)return;const e=this.obtenerRequestReporte();this.isExportingReport=s.vU.True,this._detalleVentasService.GetReportePorMarcasAsync(e).subscribe(n=>{if(this.isExportingReport=s.vU.False,n){const a=window.URL.createObjectURL(new Blob([n],{type:"application/vnd.ms-excel"})),r=document.createElement("a");r.download=`Reporte_Venta_Por_Marca_${this.getFechaFiltroCadenaReporte()}.xlsx`,r.href=a,r.click(),r.parentNode?.removeChild(r)}},n=>{if(n.status==s.GL.Forbidden)return this._toolService.showWarning(c.T.InvalidPermisos,c.T.Tittle),this.isExportingReport=s.vU.False=s.vU.False,void console.log(n);this._toolService.showError(c.J.Transaction,c.J.Tittle),this.isExportingReport=s.vU.False,console.log(n)})}getFechaFiltroCadenaReporte(){return`del_${this._toolService.formatoFecha(this.fechaInicio)}_hasta_${this._toolService.formatoFecha(this.fechaFin)}`.trim()}isMobilSize(){return this._toolService.isMobilSize()}obtenerRequest(){const e=new ut.p;return e.destinationTimeZoneId=this._toolService.getTimeZone(),e.idUsuario=this.decodeToken.idUsuario,e.fechaVentaInicio=""==this.filtroAnalisisVentasForm.get("fechaVentaInicio").value?null:this.filtroAnalisisVentasForm.get("fechaVentaInicio").value,e.fechaVentaFin=""==this.filtroAnalisisVentasForm.get("fechaVentaFin").value?null:this.filtroAnalisisVentasForm.get("fechaVentaFin").value,e.lstMarca=[],this.selectMarcas&&this.selectMarcas.options.filter(a=>1==a.selected&&0!=a.value).forEach(a=>{e.lstMarca?.push(a.value.id)}),this.fechaInicio=e.fechaVentaInicio,this.fechaFin=e.fechaVentaFin,e}obtenerRequestReporte(){const e=new ut.p;return e.destinationTimeZoneId=this._toolService.getTimeZone(),e.idUsuario=this.decodeToken.idUsuario,e.fechaVentaInicio=""==this.filtroAnalisisVentasForm.get("fechaVentaInicio").value?null:this.filtroAnalisisVentasForm.get("fechaVentaInicio").value,e.fechaVentaFin=""==this.filtroAnalisisVentasForm.get("fechaVentaFin").value?null:this.filtroAnalisisVentasForm.get("fechaVentaFin").value,e.lstMarca=[],this.fechaInicio=e.fechaVentaInicio,this.fechaFin=e.fechaVentaFin,this.selectMarcas&&this.selectMarcas.options.filter(a=>1==a.selected&&0!=a.value).forEach(a=>{e.lstMarca?.push(a.value.id)}),e}getFechaFiltroCadena(){const e=this._toolService.formatoFecha(this.fechaInicio),n=this._toolService.formatoFecha(this.fechaFin);this.filtroRangoFecha=`Desde ${e} Hasta ${n}`.trim()}obtenerInfouserInfoLogueado(){return this._securityService.getDecodetoken()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closedDrawer(){this.matDrawer.close()}showSkeleton(){this.skeleton=s.vU.Show}hideSkeleton(){this.skeleton=s.vU.Hide}obtenerInfoMoneda(){return this._securityService.getMonedaStorage()}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(y.I),t.Y36(m.QS),t.Y36(D.o),t.Y36(H.n),t.Y36(R.I))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-reporte-ventas-marcas-page"]],viewQuery:function(n,a){if(1&n&&(t.Gf(zo,5),t.Gf(Ho,5)),2&n){let r;t.iGM(r=t.CRH())&&(a.selectMarcas=r.first),t.iGM(r=t.CRH())&&(a.matDrawer=r.first)}},decls:57,vars:33,consts:[[1,"flex-auto","h-full"],["autoFocus","false",1,"w-90",3,"mode"],["matDrawer",""],[1,"flex","items-center","justify-between","m-4","mr-3","sm:my-5"],[1,"text-3xl","font-semibold","tracking-tight","leading-8"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"flex","flex-col","flex-auto","h-full","dark:bg-default"],[1,"flex","flex-col","flex-auto","shrink-0","pt-6","bg-card","dark:bg-transparent"],[1,"flex","flex-col","px-6",3,"formGroup"],[1,"w-full",3,"appearance"],["autocomplete","off","matInput","",3,"min","max","matDatepicker","formControlName","click"],["matSuffix","",3,"for"],["pickerInicio",""],[4,"ngIf"],["pickerFin",""],["multiple","",3,"formControlName"],["selectMarcaItem",""],[3,"model","values"],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","",1,"mt-4","mb-8",3,"color","disabled","click"],["class","icon-size-2",3,"svgIcon",4,"ngIf"],["class","ml-2",4,"ngIf"],[3,"diameter","mode",4,"ngIf"],[1,"flex","flex-col"],[1,"flex","flex-col","flex-auto","w-full"],[1,"flex","flex-wrap","w-full","max-w-screen-xl","mx-auto","p-6","md:p-8"],[1,"flex","items-center","justify-between","w-full"],[1,"text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-8"],[1,"font-medium","tracking-tight","text-secondary"],[1,"flex","items-center","ml-6"],[1,"grid","grid-cols-1","xl:grid-cols-1","gap-8","w-full","mt-6"],["class"," sm:col-span-2 md:col-span-4 flex flex-col flex-auto p-6 bg-card shadow rounded-2xl overflow-hidden","count","40",3,"theme",4,"ngIf"],["class","grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 w-full min-w-0",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"color-indicator"],[3,"value"],[1,"icon-size-2",3,"svgIcon"],[1,"ml-2"],[3,"diameter","mode"],["mat-icon-button","",3,"matMenuTriggerFor"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"ml-1"],["mat-menu-item","",3,"disabled","click"],["mat-stroked-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-flat-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"color","disabled","click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],["count","40",1,"sm:col-span-2","md:col-span-4","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden",3,"theme"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-4","gap-6","w-full","min-w-0"],["class","sm:col-span-2 md:col-span-4 flex flex-col    overflow-hidden"],[1,"sm:col-span-2","md:col-span-4","flex","flex-col","overflow-hidden"],[1,"grid","grid-cols-1","lg:grid-cols-1","grid-flow-row","gap-6","w-full","mt-8","sm:mt-4"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","items-center"],["alt","No hay datos disponibles",1,"w-72","object-cover",3,"src"],[1,"mt-4","sm:mt-8","text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-tight","md:leading-none","text-center"],[1,"mt-2","text-gray-500","text-center"],[1,"sm:col-span-2","md:col-span-4","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"flex","justify-between","items-center"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate"],[3,"plotOptions","series","chart","xaxis","yaxis","tooltip","dataLabels","labels","noData","grid"],[1,"sm:col-span-2","lg:col-span-2","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate","text-black"],["mat-icon-button","","color","primary"],[1,"flex-auto","w-full","h-80",3,"series","chart","labels","responsive","noData","colors","tooltip","dataLabels","plotOptions"],[3,"series","chart","colors","dataLabels","plotOptions","tooltip","noData","xaxis"]],template:function(n,a){if(1&n){const r=t.EpF();t.TgZ(0,"mat-drawer-container",0)(1,"mat-drawer",1,2)(3,"div",3)(4,"div",4),t._uU(5,"Filtrar por:"),t.qZA(),t.TgZ(6,"div")(7,"button",5),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(2);return t.KtG(d.close())}),t._UZ(8,"mat-icon",6),t.qZA()()(),t.TgZ(9,"div",7)(10,"div",8)(11,"form",9)(12,"mat-form-field",10)(13,"mat-label"),t._uU(14,"Fecha Venta Inicio"),t.qZA(),t.TgZ(15,"input",11),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(18);return t.KtG(d.open())}),t.qZA(),t._UZ(16,"mat-datepicker-toggle",12)(17,"mat-datepicker",null,13),t.YNc(19,Bo,2,0,"mat-error",14),t.qZA(),t.TgZ(20,"mat-form-field",10)(21,"mat-label"),t._uU(22,"Fecha Venta Fin"),t.qZA(),t.TgZ(23,"input",11),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(26);return t.KtG(d.open())}),t.qZA(),t._UZ(24,"mat-datepicker-toggle",12)(25,"mat-datepicker",null,15),t.YNc(27,Oo,2,0,"mat-error",14),t.qZA(),t.TgZ(28,"mat-form-field",10)(29,"mat-label"),t._uU(30,"Marcas"),t.qZA(),t.TgZ(31,"mat-select",16,17)(33,"mat-select-trigger"),t.YNc(34,Lo,2,1,"ng-container",14),t.qZA(),t._UZ(35,"app-selectAll",18),t.YNc(36,jo,3,4,"mat-option",19),t.qZA(),t.YNc(37,$o,2,0,"mat-error",14),t.qZA(),t.TgZ(38,"button",20),t.NdJ("click",function(){return a.getResumen(!0)}),t.YNc(39,Ko,1,1,"mat-icon",21)(40,Wo,2,0,"span",22)(41,Xo,1,2,"mat-progress-spinner",23),t.qZA()()()()(),t.TgZ(42,"mat-drawer-content",24)(43,"div",25)(44,"div",26)(45,"div",27)(46,"div")(47,"h2",28),t._uU(48,"Reporte de Ventas por Marcas "),t.qZA(),t.TgZ(49,"div",29),t._uU(50),t.qZA()(),t.TgZ(51,"div",30),t.YNc(52,ta,12,5)(53,na,8,6),t.qZA()(),t.TgZ(54,"div",31),t.YNc(55,ra,1,2,"ngx-skeleton-loader",32)(56,ca,3,1,"div",33),t.qZA()()()()()}if(2&n){const r=t.MAs(18),l=t.MAs(26),d=t.MAs(32);t.xp6(1),t.Q6J("mode","over"),t.xp6(7),t.Q6J("svgIcon","heroicons_outline:x-mark"),t.xp6(3),t.Q6J("formGroup",a.filtroAnalisisVentasForm),t.xp6(1),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",r)("formControlName","fechaVentaInicio"),t.xp6(1),t.Q6J("for",r),t.xp6(3),t.Q6J("ngIf",a.filtroAnalisisVentasForm.get("fechaVentaInicio").hasError("required")),t.xp6(1),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",l)("formControlName","fechaVentaFin"),t.xp6(1),t.Q6J("for",l),t.xp6(3),t.Q6J("ngIf",a.filtroAnalisisVentasForm.get("fechaVentaFin").hasError("required")),t.xp6(1),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("formControlName","marcas"),t.xp6(3),t.Q6J("ngIf",(null==d.value?null:d.value.length)>0),t.xp6(1),t.Q6J("model",a.filtroAnalisisVentasForm.get("marcas"))("values",a.allMarcasDataSource),t.xp6(1),t.Q6J("ngForOf",a.allMarcasDataSource),t.xp6(1),t.Q6J("ngIf",a.filtroAnalisisVentasForm.get("marcas").hasError("required")),t.xp6(1),t.Q6J("color","primary")("disabled",a.filtroAnalisisVentasForm.invalid||a.disabledBuscar),t.xp6(1),t.Q6J("ngIf",!a.disabledBuscar),t.xp6(1),t.Q6J("ngIf",!a.disabledBuscar),t.xp6(1),t.Q6J("ngIf",a.disabledBuscar),t.xp6(9),t.hij("",a.filtroRangoFecha," "),t.xp6(2),t.um2(52,a.isMobilSize()?52:53),t.xp6(3),t.Q6J("ngIf",a.skeleton),t.xp6(1),t.Q6J("ngIf",!a.skeleton)}},dependencies:[h.sg,h.O5,B.K,m._Y,m.Fj,m.JJ,m.JL,m.sg,m.u,k.Nt,x.KE,x.hX,x.TO,x.R9,b.VK,b.OP,b.p6,S.gD,S.$L,U.ey,j.x,M.Ou,C.jA,C.kh,C.LW,V.lW,V.RK,P.Hw,T.Mq,T.hl,T.nW,O.xr]})}return o})();var pt=u(6538);const da=["selectProductoItem"],ua=["matDrawer"];function ma(o,i){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Fecha Venta inicio es requerido"),t.qZA())}function pa(o,i){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Fecha Venta fin es requerido"),t.qZA())}function ga(o,i){1&o&&(t.ynx(0),t._uU(1,", "),t.BQk())}function ha(o,i){if(1&o&&(t.TgZ(0,"span"),t._UZ(1,"span",35),t._uU(2),t.YNc(3,ga,2,0,"ng-container",14),t.qZA()),2&o){const e=i.$implicit,n=i.index;t.oxw(2);const a=t.MAs(32);t.xp6(1),t.Udp("background-color",null==e?null:e.color),t.xp6(1),t.hij(" ",e.nombre||"",""),t.xp6(1),t.Q6J("ngIf",n<a.value.length-1)}}function fa(o,i){if(1&o&&(t.ynx(0),t.YNc(1,ha,4,4,"span",34),t.BQk()),2&o){t.oxw();const e=t.MAs(32);t.xp6(1),t.Q6J("ngForOf",e.value)}}function _a(o,i){if(1&o&&(t.TgZ(0,"mat-option",36),t._UZ(1,"span",35),t._uU(2),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.Udp("background-color",e.color),t.xp6(1),t.hij(" ",e.nombre,"")}}function xa(o,i){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Producto es requerido"),t.qZA())}function va(o,i){1&o&&t._UZ(0,"mat-icon",37),2&o&&t.Q6J("svgIcon","heroicons_solid:magnifying-glass")}function ba(o,i){1&o&&(t.TgZ(0,"span",38),t._uU(1,"Buscar"),t.qZA())}function Ca(o,i){1&o&&t._UZ(0,"mat-progress-spinner",39),2&o&&t.Q6J("diameter",24)("mode","indeterminate")}function Ta(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",40),t._UZ(1,"mat-icon",6),t.qZA(),t.TgZ(2,"mat-menu",null,41)(4,"button",42),t.NdJ("click",function(){t.CHM(e),t.oxw();const a=t.MAs(2);return t.KtG(a.open())}),t._UZ(5,"mat-icon",6),t.TgZ(6,"span",43),t._uU(7,"Filtrar"),t.qZA()(),t.TgZ(8,"button",44),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.getReportePorProductoAsync())}),t._UZ(9,"mat-icon",6),t.TgZ(10,"span",43),t._uU(11,"Exportar"),t.qZA()()()}if(2&o){const e=t.MAs(3),n=t.oxw();t.Q6J("matMenuTriggerFor",e),t.xp6(1),t.Q6J("svgIcon","heroicons_mini:ellipsis-vertical"),t.xp6(4),t.Q6J("svgIcon","heroicons_solid:adjustments-horizontal"),t.xp6(3),t.Q6J("disabled",n.filtroAnalisisVentasForm.invalid||n.isExportingReport||n.disabledExportar),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:arrow-up-tray")}}function Va(o,i){1&o&&t._UZ(0,"mat-icon",46),2&o&&t.Q6J("svgIcon","heroicons_solid:arrow-up-tray")}function Za(o,i){1&o&&(t.TgZ(0,"span",38),t._uU(1,"Exportar"),t.qZA())}function Aa(o,i){1&o&&t._UZ(0,"mat-progress-spinner",39),2&o&&t.Q6J("diameter",24)("mode","indeterminate")}function Fa(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",45),t.NdJ("click",function(){t.CHM(e),t.oxw();const a=t.MAs(2);return t.KtG(a.open())}),t._UZ(1,"mat-icon",46),t.TgZ(2,"span",38),t._uU(3,"Filtrar"),t.qZA()(),t.TgZ(4,"button",47),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.getReportePorProductoAsync())}),t.YNc(5,Va,1,1,"mat-icon",48)(6,Za,2,0,"span",22)(7,Aa,1,2,"mat-progress-spinner",23),t.qZA()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("svgIcon","heroicons_solid:adjustments-horizontal"),t.xp6(3),t.Q6J("color","primary")("disabled",e.filtroAnalisisVentasForm.invalid||e.isExportingReport||e.disabledExportar),t.xp6(1),t.Q6J("ngIf",!e.isExportingReport),t.xp6(1),t.Q6J("ngIf",!e.isExportingReport),t.xp6(1),t.Q6J("ngIf",e.isExportingReport)}}const wa=()=>({"border-radius":"0",height:"50px"});function Sa(o,i){1&o&&t._UZ(0,"ngx-skeleton-loader",49),2&o&&t.Q6J("theme",t.DdM(1,wa))}function Da(o,i){if(1&o&&(t.TgZ(0,"div",52)(1,"div",53)(2,"div",54)(3,"div",55),t._UZ(4,"img",56),t.TgZ(5,"div",57),t._uU(6),t.qZA(),t.TgZ(7,"div")(8,"p",58),t._uU(9,"Aplique otros filtros de b\xfasqueda "),t.qZA()()()()()()),2&o){const e=t.oxw(2);t.xp6(4),t.Q6J("src",e.imgNoDataHome,t.LSH),t.xp6(2),t.hij(" ",e.textoResultado,"")}}function ya(o,i){if(1&o&&(t.TgZ(0,"div",59)(1,"div",60)(2,"div",61),t._uU(3,"Evoluci\xf3n por Productos y Fechas"),t.qZA()(),t.TgZ(4,"div",53)(5,"div",54)(6,"div",54),t._UZ(7,"apx-chart",62),t.qZA()()()(),t.TgZ(8,"div",63)(9,"div",60)(10,"div",64),t._uU(11," Totalizado por Productos "),t.qZA(),t._UZ(12,"button",65),t.qZA(),t.TgZ(13,"div",54),t._UZ(14,"apx-chart",66),t.qZA()(),t.TgZ(15,"div",63)(16,"div",60)(17,"div",64),t._uU(18," Productos Destacadas "),t.qZA()(),t.TgZ(19,"div",54),t._UZ(20,"apx-chart",67),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(7),t.Q6J("plotOptions",e.chartEvolucionVentasProductoFecha.plotOptions)("series",e.chartEvolucionVentasProductoFecha.series)("chart",e.chartEvolucionVentasProductoFecha.chart)("xaxis",e.chartEvolucionVentasProductoFecha.xaxis)("yaxis",e.chartEvolucionVentasProductoFecha.yaxis)("tooltip",e.chartEvolucionVentasProductoFecha.tooltip)("dataLabels",e.chartEvolucionVentasProductoFecha.dataLabels)("labels",e.chartEvolucionVentasProductoFecha.labels)("noData",e.chartEvolucionVentasProductoFecha.noData)("grid",e.chartEvolucionVentasProductoFecha.grid),t.xp6(7),t.Q6J("series",e.chartTotalizadoProductos.series)("chart",e.chartTotalizadoProductos.chart)("labels",e.chartTotalizadoProductos.labels)("responsive",e.chartTotalizadoProductos.responsive)("noData",e.chartTotalizadoProductos.noData)("colors",e.chartTotalizadoProductos.colors)("tooltip",e.chartTotalizadoProductos.tooltip)("dataLabels",e.chartTotalizadoProductos.dataLabels)("plotOptions",e.chartTotalizadoProductos.plotOptions),t.xp6(6),t.Q6J("series",e.chartTopDiezProductos.series)("chart",e.chartTopDiezProductos.chart)("colors",e.chartTopDiezProductos.colors)("dataLabels",e.chartTopDiezProductos.dataLabels)("plotOptions",e.chartTopDiezProductos.plotOptions)("tooltip",e.chartTopDiezProductos.tooltip)("noData",e.chartTopDiezProductos.noData)("xaxis",e.chartTopDiezProductos.xaxis)}}function Pa(o,i){if(1&o&&(t.TgZ(0,"div",50),t.YNc(1,Da,10,2,"div",51)(2,ya,21,27),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.um2(1,0==e.ventasAnalisisDataSource.distribucionVentasProducto.totalVentasProductos.length?1:2)}}const Ua=[{path:"ventas",children:[{path:"registro",component:nt,data:{title:"Registro de Ventas"}},{path:"historial",component:st,data:{title:"Historial de las Ventas"}},{path:"reporte-categorias",component:dt,data:{title:"Reporte de Ventas Por Categor\xedas"}},{path:"reporte-marcas",component:mt,data:{title:"Reporte de Ventas Por Marcas"}},{path:"reporte-productos",component:(()=>{class o{constructor(e,n,a,r,l){this._securityService=e,this._formBuilder=n,this._toolService=a,this._detalleVentasService=r,this._inventarioService=l,this.disabledExportar=s.vU.False,this.decodeToken=this.obtenerInfouserInfoLogueado(),this.monedaInfo=this.obtenerInfoMoneda(),this.isExportingReport=s.vU.False,this.chartEvolucionVentasProductoFecha={},this.chartTotalizadoProductos={},this.chartTopDiezProductos={},this.disabledBuscar=s.vU.False,this._unsubscribeAll=new I.x,this.skeleton=s.vU.False,this.minDate=this._toolService.getMinDateFIlter(),this.maxDate=this._toolService.getMaxDateFIlter(),this.imgNoDataHome=s.HZ.noDataHome,this.textoResultado=s.RO.NoDataResult,this.filtroRangoFecha=""}ngOnInit(){this.formFiltros(),this.showSkeleton(),this.getResumen(s.vU.False),this.getFilterComboConsulta()}formFiltros(){this.filtroAnalisisVentasForm=this._formBuilder.group({fechaVentaInicio:[this._toolService.getStartDateOfMonth(),[m.kI.required]],fechaVentaFin:[this._toolService.getEndDateOfMonth(),[m.kI.required]],productos:[""]}),this.currencyNumberFormat=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda)}getFilterComboConsulta(){(0,N.D)({dataProductos:this._inventarioService.GetAllProductoForComboBoxAsync()}).subscribe({next:e=>{this.allProductosDataSource=e.dataProductos,this.filtroAnalisisVentasForm.get("productos")?.setValue(this.allProductosDataSource)},error:e=>{this._toolService.showError(c.J.Transaction,c.J.Tittle),this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.True,console.log(e)}})}getResumen(e){this.showSkeleton();const n=this.obtenerRequest();this.disabledBuscar=s.vU.True,this._detalleVentasService.GetAnalisisProductosByFilterAsync(n).subscribe(a=>{this.ventasAnalisisDataSource=a,this.disabledBuscar=s.vU.False,this.getFechaFiltroCadena(),this.generateCharts(),e&&this.closedDrawer(),this.hideSkeleton(),this.disabledExportar=a.distribucionVentasProducto.totalVentasProductos.length>s.Q6.Cero?s.vU.False:s.vU.True},a=>{this._toolService.showError(c.J.Transaction,c.J.Tittle),this.disabledBuscar=s.vU.False,console.log(a),e&&this.closedDrawer()})}generateCharts(){this.rangoFecha=this.getRangeDate(),this.generarchartEvolucionVentasProductoFecha(),this.generarchartTotalizadoProductos(),this.generarChartTopDiezProductos()}getRangeDate(){return this.ventasAnalisisDataSource.evolucionVentasFecha.fechaVenta.map(e=>this._toolService.formatoFecha(e))}generarchartEvolucionVentasProductoFecha(){const e=this.ventasAnalisisDataSource.lstEvolucionVentasProductoFecha.map(n=>({color:n.colorProducto,name:n.nombreProducto,data:this.rangoFecha.map(a=>{const r=n.datosVentasAgrupados.find(l=>this._toolService.formatoFecha(l.fechaVenta)===a);return r?r.montoVentaTotal:s.Q6.Cero})}));this.chartEvolucionVentasProductoFecha={series:e,chart:{type:"bar",height:350,stacked:!0,toolbar:{show:!1}},noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},plotOptions:{bar:{horizontal:!1,columnWidth:"55%"}},dataLabels:{enabled:!1,style:{fontSize:"12px"}},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:this.rangoFecha,labels:{rotateAlways:!0,rotate:-45}},yaxis:{labels:{formatter:n=>this.currencyNumberFormat.format(n),style:{fontSize:"12px"}}},fill:{opacity:1},tooltip:{enabled:!0,y:{formatter:n=>this.currencyNumberFormat.format(n)}}}}generarchartTotalizadoProductos(){const e=this.isMobilSize(),n=this.ventasAnalisisDataSource.distribucionVentasProducto.totalVentasProductos.reduce((a,r)=>a+r,0);this.chartTotalizadoProductos={chart:{type:"donut",fontFamily:"inherit",foreColor:"inherit",height:"95%"},responsive:[{breakpoint:600,options:{chart:{width:"100%",height:350},legend:{position:"bottom"}}}],labels:this.ventasAnalisisDataSource.distribucionVentasProducto.nombreProductos,series:this.ventasAnalisisDataSource.distribucionVentasProducto.totalVentasProductos,noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},colors:this.ventasAnalisisDataSource.distribucionVentasProducto.coloresProductos,tooltip:{enabled:!0,y:{formatter:a=>this.currencyNumberFormat.format(a)}},dataLabels:{enabled:!0},plotOptions:{pie:{donut:{labels:{show:!0,name:{show:!1},value:{show:!0,fontSize:e?"19px":"22px",color:"#494949",offsetY:0,formatter:()=>this.currencyNumberFormat.format(n)},total:{show:!0,showAlways:!0,label:"",fontSize:e?"19px":"22px",color:"#494949",formatter:()=>this.currencyNumberFormat.format(n)}}}}}}}generarChartTopDiezProductos(){const e=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda);this.chartTopDiezProductos={series:[{name:"Total",data:this.ventasAnalisisDataSource.topDiezProductosVentas.totalMontos}],noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},colors:this.ventasAnalisisDataSource.topDiezProductosVentas.colores,chart:{type:"bar",height:350,toolbar:{show:!1}},plotOptions:{bar:{barHeight:"100%",distributed:!0,horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,textAnchor:"middle",formatter:function(n){return e.format(n)},offsetY:-6,style:{colors:["#FFFFFF"],fontSize:"12px",fontWeight:"bold"},dropShadow:{enabled:!0,top:1,left:1,blur:2,color:"#000000",opacity:.5}},stroke:{width:1,colors:["#fff"]},tooltip:{enabled:!0,y:{formatter:n=>e.format(n)}},xaxis:{categories:this.ventasAnalisisDataSource.topDiezProductosVentas.productos,labels:{show:!1,style:{fontSize:"12px"},formatter:function(n){return"number"==typeof n?e.format(n):n}}}}}getReportePorProductoAsync(){if(this.ventasAnalisisDataSource.distribucionVentasProducto.totalVentasProductos.length==s.Q6.Cero&&this.ventasAnalisisDataSource.distribucionVentasProducto.totalVentasProductos.length==s.Q6.Cero||this.filtroAnalisisVentasForm.invalid)return;const e=this.obtenerRequestReporte();this.isExportingReport=s.vU.True,this._detalleVentasService.GetReportePorProductosAsync(e).subscribe(n=>{if(this.isExportingReport=s.vU.False,n){const a=window.URL.createObjectURL(new Blob([n],{type:"application/vnd.ms-excel"})),r=document.createElement("a");r.download=`Reporte_Venta_Por_Productos_${this.getFechaFiltroCadenaReporte()}.xlsx`,r.href=a,r.click(),r.parentNode?.removeChild(r)}},n=>{if(n.status==s.GL.Forbidden)return this._toolService.showWarning(c.T.InvalidPermisos,c.T.Tittle),this.isExportingReport=s.vU.False=s.vU.False,void console.log(n);this._toolService.showError(c.J.Transaction,c.J.Tittle),this.isExportingReport=s.vU.False,console.log(n)})}getFechaFiltroCadenaReporte(){return`del_${this._toolService.formatoFecha(this.fechaInicio)}_hasta_${this._toolService.formatoFecha(this.fechaFin)}`.trim()}isMobilSize(){return this._toolService.isMobilSize()}obtenerRequest(){const e=new pt.f;return e.destinationTimeZoneId=this._toolService.getTimeZone(),e.idUsuario=this.decodeToken.idUsuario,e.fechaVentaInicio=""==this.filtroAnalisisVentasForm.get("fechaVentaInicio").value?null:this.filtroAnalisisVentasForm.get("fechaVentaInicio").value,e.fechaVentaFin=""==this.filtroAnalisisVentasForm.get("fechaVentaFin").value?null:this.filtroAnalisisVentasForm.get("fechaVentaFin").value,e.lstProductos=[],this.selectProductos&&this.selectProductos.options.filter(a=>1==a.selected&&0!=a.value).forEach(a=>{e.lstProductos?.push(a.value.id)}),this.fechaInicio=e.fechaVentaInicio,this.fechaFin=e.fechaVentaFin,e}obtenerRequestReporte(){const e=new pt.f;return e.destinationTimeZoneId=this._toolService.getTimeZone(),e.idUsuario=this.decodeToken.idUsuario,e.fechaVentaInicio=""==this.filtroAnalisisVentasForm.get("fechaVentaInicio").value?null:this.filtroAnalisisVentasForm.get("fechaVentaInicio").value,e.fechaVentaFin=""==this.filtroAnalisisVentasForm.get("fechaVentaFin").value?null:this.filtroAnalisisVentasForm.get("fechaVentaFin").value,e.lstProductos=[],this.fechaInicio=e.fechaVentaInicio,this.fechaFin=e.fechaVentaFin,this.selectProductos&&this.selectProductos.options.filter(a=>1==a.selected&&0!=a.value).forEach(a=>{e.lstProductos?.push(a.value.id)}),e}getFechaFiltroCadena(){const e=this._toolService.formatoFecha(this.fechaInicio),n=this._toolService.formatoFecha(this.fechaFin);this.filtroRangoFecha=`Desde ${e} Hasta ${n}`.trim()}obtenerInfouserInfoLogueado(){return this._securityService.getDecodetoken()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closedDrawer(){this.matDrawer.close()}showSkeleton(){this.skeleton=s.vU.Show}hideSkeleton(){this.skeleton=s.vU.Hide}obtenerInfoMoneda(){return this._securityService.getMonedaStorage()}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(y.I),t.Y36(m.QS),t.Y36(D.o),t.Y36(H.n),t.Y36(R.I))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-reporte-ventas-productos-page"]],viewQuery:function(n,a){if(1&n&&(t.Gf(da,5),t.Gf(ua,5)),2&n){let r;t.iGM(r=t.CRH())&&(a.selectProductos=r.first),t.iGM(r=t.CRH())&&(a.matDrawer=r.first)}},decls:57,vars:33,consts:[[1,"flex-auto","h-full"],["autoFocus","false",1,"w-90",3,"mode"],["matDrawer",""],[1,"flex","items-center","justify-between","m-4","mr-3","sm:my-5"],[1,"text-3xl","font-semibold","tracking-tight","leading-8"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"flex","flex-col","flex-auto","h-full","dark:bg-default"],[1,"flex","flex-col","flex-auto","shrink-0","pt-6","bg-card","dark:bg-transparent"],[1,"flex","flex-col","px-6",3,"formGroup"],[1,"w-full",3,"appearance"],["autocomplete","off","matInput","",3,"min","max","matDatepicker","formControlName","click"],["matSuffix","",3,"for"],["pickerInicio",""],[4,"ngIf"],["pickerFin",""],["multiple","",3,"formControlName"],["selectProductoItem",""],[3,"model","values"],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","",1,"mt-4","mb-8",3,"color","disabled","click"],["class","icon-size-2",3,"svgIcon",4,"ngIf"],["class","ml-2",4,"ngIf"],[3,"diameter","mode",4,"ngIf"],[1,"flex","flex-col"],[1,"flex","flex-col","flex-auto","w-full"],[1,"flex","flex-wrap","w-full","max-w-screen-xl","mx-auto","p-6","md:p-8"],[1,"flex","items-center","justify-between","w-full"],[1,"text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-8"],[1,"font-medium","tracking-tight","text-secondary"],[1,"flex","items-center","ml-6"],[1,"grid","grid-cols-1","xl:grid-cols-1","gap-8","w-full","mt-6"],["class"," sm:col-span-2 md:col-span-4 flex flex-col flex-auto p-6 bg-card shadow rounded-2xl overflow-hidden","count","40",3,"theme",4,"ngIf"],["class","grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 w-full min-w-0",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"color-indicator"],[3,"value"],[1,"icon-size-2",3,"svgIcon"],[1,"ml-2"],[3,"diameter","mode"],["mat-icon-button","",3,"matMenuTriggerFor"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"ml-1"],["mat-menu-item","",3,"disabled","click"],["mat-stroked-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-flat-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"color","disabled","click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],["count","40",1,"sm:col-span-2","md:col-span-4","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden",3,"theme"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-4","gap-6","w-full","min-w-0"],["class","sm:col-span-2 md:col-span-4 flex flex-col    overflow-hidden"],[1,"sm:col-span-2","md:col-span-4","flex","flex-col","overflow-hidden"],[1,"grid","grid-cols-1","lg:grid-cols-1","grid-flow-row","gap-6","w-full","mt-8","sm:mt-4"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","items-center"],["alt","No hay datos disponibles",1,"w-72","object-cover",3,"src"],[1,"mt-4","sm:mt-8","text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-tight","md:leading-none","text-center"],[1,"mt-2","text-gray-500","text-center"],[1,"sm:col-span-2","md:col-span-4","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"flex","justify-between","items-center"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate"],[3,"plotOptions","series","chart","xaxis","yaxis","tooltip","dataLabels","labels","noData","grid"],[1,"sm:col-span-2","lg:col-span-2","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate","text-black"],["mat-icon-button","","color","primary"],[1,"flex-auto","w-full","h-80",3,"series","chart","labels","responsive","noData","colors","tooltip","dataLabels","plotOptions"],[3,"series","chart","colors","dataLabels","plotOptions","tooltip","noData","xaxis"]],template:function(n,a){if(1&n){const r=t.EpF();t.TgZ(0,"mat-drawer-container",0)(1,"mat-drawer",1,2)(3,"div",3)(4,"div",4),t._uU(5,"Filtrar por:"),t.qZA(),t.TgZ(6,"div")(7,"button",5),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(2);return t.KtG(d.close())}),t._UZ(8,"mat-icon",6),t.qZA()()(),t.TgZ(9,"div",7)(10,"div",8)(11,"form",9)(12,"mat-form-field",10)(13,"mat-label"),t._uU(14,"Fecha Venta Inicio"),t.qZA(),t.TgZ(15,"input",11),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(18);return t.KtG(d.open())}),t.qZA(),t._UZ(16,"mat-datepicker-toggle",12)(17,"mat-datepicker",null,13),t.YNc(19,ma,2,0,"mat-error",14),t.qZA(),t.TgZ(20,"mat-form-field",10)(21,"mat-label"),t._uU(22,"Fecha Venta Fin"),t.qZA(),t.TgZ(23,"input",11),t.NdJ("click",function(){t.CHM(r);const d=t.MAs(26);return t.KtG(d.open())}),t.qZA(),t._UZ(24,"mat-datepicker-toggle",12)(25,"mat-datepicker",null,15),t.YNc(27,pa,2,0,"mat-error",14),t.qZA(),t.TgZ(28,"mat-form-field",10)(29,"mat-label"),t._uU(30,"Productos"),t.qZA(),t.TgZ(31,"mat-select",16,17)(33,"mat-select-trigger"),t.YNc(34,fa,2,1,"ng-container",14),t.qZA(),t._UZ(35,"app-selectAll",18),t.YNc(36,_a,3,4,"mat-option",19),t.qZA(),t.YNc(37,xa,2,0,"mat-error",14),t.qZA(),t.TgZ(38,"button",20),t.NdJ("click",function(){return a.getResumen(!0)}),t.YNc(39,va,1,1,"mat-icon",21)(40,ba,2,0,"span",22)(41,Ca,1,2,"mat-progress-spinner",23),t.qZA()()()()(),t.TgZ(42,"mat-drawer-content",24)(43,"div",25)(44,"div",26)(45,"div",27)(46,"div")(47,"h2",28),t._uU(48,"Reporte de Ventas por Productos "),t.qZA(),t.TgZ(49,"div",29),t._uU(50),t.qZA()(),t.TgZ(51,"div",30),t.YNc(52,Ta,12,5)(53,Fa,8,6),t.qZA()(),t.TgZ(54,"div",31),t.YNc(55,Sa,1,2,"ngx-skeleton-loader",32)(56,Pa,3,1,"div",33),t.qZA()()()()()}if(2&n){const r=t.MAs(18),l=t.MAs(26),d=t.MAs(32);t.xp6(1),t.Q6J("mode","over"),t.xp6(7),t.Q6J("svgIcon","heroicons_outline:x-mark"),t.xp6(3),t.Q6J("formGroup",a.filtroAnalisisVentasForm),t.xp6(1),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",r)("formControlName","fechaVentaInicio"),t.xp6(1),t.Q6J("for",r),t.xp6(3),t.Q6J("ngIf",a.filtroAnalisisVentasForm.get("fechaVentaInicio").hasError("required")),t.xp6(1),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",l)("formControlName","fechaVentaFin"),t.xp6(1),t.Q6J("for",l),t.xp6(3),t.Q6J("ngIf",a.filtroAnalisisVentasForm.get("fechaVentaFin").hasError("required")),t.xp6(1),t.Q6J("appearance","outline"),t.xp6(3),t.Q6J("formControlName","productos"),t.xp6(3),t.Q6J("ngIf",(null==d.value?null:d.value.length)>0),t.xp6(1),t.Q6J("model",a.filtroAnalisisVentasForm.get("productos"))("values",a.allProductosDataSource),t.xp6(1),t.Q6J("ngForOf",a.allProductosDataSource),t.xp6(1),t.Q6J("ngIf",a.filtroAnalisisVentasForm.get("productos").hasError("required")),t.xp6(1),t.Q6J("color","primary")("disabled",a.filtroAnalisisVentasForm.invalid||a.disabledBuscar),t.xp6(1),t.Q6J("ngIf",!a.disabledBuscar),t.xp6(1),t.Q6J("ngIf",!a.disabledBuscar),t.xp6(1),t.Q6J("ngIf",a.disabledBuscar),t.xp6(9),t.hij("",a.filtroRangoFecha," "),t.xp6(2),t.um2(52,a.isMobilSize()?52:53),t.xp6(3),t.Q6J("ngIf",a.skeleton),t.xp6(1),t.Q6J("ngIf",!a.skeleton)}},dependencies:[h.sg,h.O5,B.K,m._Y,m.Fj,m.JJ,m.JL,m.sg,m.u,k.Nt,x.KE,x.hX,x.TO,x.R9,b.VK,b.OP,b.p6,S.gD,S.$L,U.ey,j.x,M.Ou,C.jA,C.kh,C.LW,V.lW,V.RK,P.Hw,T.Mq,T.hl,T.nW,O.xr]})}return o})(),data:{title:"Reporte de Ventas Por Productos"}}]}];let ht=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[W.Bz.forChild(Ua),W.Bz]})}return o})();const Ia=[h.ez,K.m,ht],ka=[{provide:U.Ad,useFactory:o=>o.getuserInfoLogueadoCultureInfo(),deps:[D.o]}];let Ma=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({providers:[h.uU,ka],imports:[Ia,h.ez,K.m,ht]})}return o})()}}]);