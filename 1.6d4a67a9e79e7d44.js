"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[1],{6001:(Ua,L,m)=>{m.r(L),m.d(L,{ComprasModule:()=>ya});var g=m(6814),j=m(1389),I=m(3680),y=m(5742),$=m(2787),u=m(5313),k=m(8645),s=m(4740),K=m(4735);class fe{}class _e{}var M=m(4690),d=m(6223),xe=m(9347),e=m(9212),W=m(6278),R=m(4855),Q=m(1427),Ce=m(4500),x=m(2734),C=m(9397),X=m(4928);let ee=(()=>{class o{constructor(t){this.apiService=t}GetAllByFilterAsync(t){return this.apiService.post(x.bq.GetAllByFilterAsync,t).pipe((0,C.b)(r=>r))}GetAllUsuariosAsync(){return this.apiService.query(x.bq.GetAllUsuariosAsync,{}).pipe((0,C.b)(t=>t))}InsertAsync(t){return this.apiService.post(x.bq.InsertAsync,t).pipe((0,C.b)(r=>r))}AnulaAsync(t){return this.apiService.post(x.bq.AnulaAsync,t).pipe((0,C.b)(r=>r))}static#e=this.\u0275fac=function(r){return new(r||o)(e.LFG(X.s))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var H=m(5110),q=m(2032),f=m(5683),te=m(9488),J=m(5940),Z=m(2296),D=m(617),F=m(3566);function ve(o,i){if(1&o&&e._UZ(0,"img",55),2&o){const t=e.oxw().$implicit;e.Q6J("alt","Imagen de "+t.nombre)("src",t.urlFoto,e.LSH)}}function be(o,i){1&o&&(e.TgZ(0,"div",56),e._uU(1," SIN IMAGEN "),e.qZA())}const Te=(o,i,t)=>({"bg-red-200 text-red-800":o,"bg-orange-200 text-orange-800":i,"bg-green-200 text-green-800":t});function Ze(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"tr",46),e.NdJ("click",function(){const n=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.seleccionarProducto(n))}),e.TgZ(1,"td",47)(2,"div",48)(3,"div",49),e.YNc(4,ve,1,2,"img",50)(5,be,2,0,"div",51),e.qZA()()(),e.TgZ(6,"td",52),e._uU(7),e.qZA(),e.TgZ(8,"td",52),e._uU(9),e.qZA(),e.TgZ(10,"td",52)(11,"span",53)(12,"span",54),e._uU(13),e.qZA()()()()}if(2&o){const t=i.$implicit;e.xp6(4),e.Q6J("ngIf",t.urlFoto),e.xp6(1),e.Q6J("ngIf",!t.urlFoto),e.xp6(2),e.Oqu(t.codigo),e.xp6(2),e.Oqu(t.nombre),e.xp6(2),e.Q6J("ngClass",e.kEZ(6,Te,(null==t?null:t.stock)<=0,(null==t?null:t.stock)>0&&(null==t?null:t.stock)<=5,(null==t?null:t.stock)>5)),e.xp6(2),e.Oqu(null==t?null:t.stock)}}function Ae(o,i){if(1&o&&(e.TgZ(0,"div",41)(1,"table",42)(2,"thead",43)(3,"tr")(4,"th",44),e._uU(5,"Imagen"),e.qZA(),e.TgZ(6,"th",44),e._uU(7,"C\xf3digo"),e.qZA(),e.TgZ(8,"th",44),e._uU(9,"Nombre"),e.qZA(),e.TgZ(10,"th",44),e._uU(11,"Stock"),e.qZA()()(),e.TgZ(12,"tbody"),e.YNc(13,Ze,14,10,"tr",45),e.qZA()()()),2&o){const t=e.oxw();e.xp6(13),e.Q6J("ngForOf",t.allProductoDataSource.data)}}function Fe(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-button-toggle",57)(2,"span",58),e._uU(3),e.qZA(),e.TgZ(4,"span",59),e._uU(5),e.qZA()(),e.BQk()),2&o){const t=i.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(2),e.Oqu(t.nombre),e.xp6(2),e.hij("(",t.cantidadProductos,")")}}function we(o,i){1&o&&(e.TgZ(0,"th",78),e._uU(1,"Imagen"),e.qZA())}function Se(o,i){if(1&o&&e._UZ(0,"img",55),2&o){const t=e.oxw().$implicit;e.Q6J("alt","Imagen de "+(null==t?null:t.nombre))("src",null==t?null:t.urlFoto,e.LSH)}}function Pe(o,i){1&o&&(e.TgZ(0,"div",56),e._uU(1," SIN IMAGEN "),e.qZA())}function ye(o,i){if(1&o&&(e.TgZ(0,"td",79)(1,"div",48)(2,"div",49),e.YNc(3,Se,1,2,"img",50)(4,Pe,2,0,"div",51),e.qZA()()()),2&o){const t=i.$implicit;e.xp6(3),e.Q6J("ngIf",null==t?null:t.urlFoto),e.xp6(1),e.Q6J("ngIf",!(null!=t&&t.urlFoto))}}function De(o,i){1&o&&(e.TgZ(0,"th",80),e._uU(1," Nombre "),e.qZA())}function Ue(o,i){if(1&o&&(e.TgZ(0,"td",81)(1,"span",48)(2,"span",82),e._uU(3),e.qZA()()()),2&o){const t=i.$implicit;e.xp6(3),e.Oqu(t.nombre)}}function Ie(o,i){1&o&&(e.TgZ(0,"th",83),e._uU(1," Stock "),e.qZA())}const ke=(o,i,t)=>({"bg-red-200 text-red-800 dark:bg-red-600 dark:text-red-50":o,"bg-orange-200 text-orange-800 dark:bg-orange-600 dark:text-orange-50":i,"bg-green-200 text-green-800 dark:bg-green-600 dark:text-green-50":t});function Me(o,i){if(1&o&&(e.TgZ(0,"td",84)(1,"span",53)(2,"span",54),e._uU(3),e.qZA()()()),2&o){const t=i.$implicit;e.xp6(1),e.Q6J("ngClass",e.kEZ(2,ke,(null==t?null:t.stock)<=0,(null==t?null:t.stock)>0&&(null==t?null:t.stock)<=5,(null==t?null:t.stock)>5)),e.xp6(2),e.Oqu(null==t?null:t.stock)}}function Re(o,i){1&o&&(e.TgZ(0,"th",85),e._uU(1," Precio Compra "),e.qZA())}function qe(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"td",86)(1,"input",87),e.NdJ("ngModelChange",function(a){const l=e.CHM(t).index,c=e.oxw(2);return e.KtG(c.lstProductosSeleccionados.data[l].precioCompra=a)})("input",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.calcularTotalCompra())}),e.qZA()()}if(2&o){const t=i.index,r=e.oxw(2);e.xp6(1),e.Q6J("ngModel",r.lstProductosSeleccionados.data[t].precioCompra)}}function Je(o,i){1&o&&(e.TgZ(0,"th",78),e._uU(1,"Cantidad"),e.qZA())}function Qe(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"td",86)(1,"div",88)(2,"button",89),e.NdJ("click",function(){const n=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.disminuirCantidad(n))}),e.TgZ(3,"mat-icon"),e._uU(4,"remove"),e.qZA()(),e.TgZ(5,"input",90),e.NdJ("ngModelChange",function(a){const l=e.CHM(t).$implicit;return e.KtG(l.cantidad=a)}),e.qZA(),e.TgZ(6,"button",89),e.NdJ("click",function(){const n=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.aumentarCantidad(n))}),e.TgZ(7,"mat-icon"),e._uU(8,"add"),e.qZA()()()()}if(2&o){const t=i.$implicit,r=e.oxw(2);e.xp6(2),e.Q6J("disabled",r.isCallingInsertService),e.xp6(3),e.Q6J("disabled",r.isCallingInsertService)("ngModel",t.cantidad),e.xp6(1),e.Q6J("disabled",r.isCallingInsertService)}}function Ve(o,i){1&o&&(e.TgZ(0,"th",80),e._uU(1,"Total"),e.qZA())}const B=(o,i,t)=>[o,i,"code","",t];function Ee(o,i){if(1&o&&(e.TgZ(0,"td",86)(1,"span",91),e._uU(2),e.ALo(3,"currency"),e.qZA()()),2&o){const t=i.$implicit,r=e.oxw(2);e.xp6(2),e.hij(" ",e.G7q(3,1,e.kEZ(7,B,r.calcularTotalProducto(t),r.monedaInfo.codigoMoneda,r.monedaInfo.cultureInfo))," ")}}function Ne(o,i){1&o&&(e.TgZ(0,"th",78),e._uU(1," Acciones "),e.qZA())}function ze(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"td",86)(1,"button",92),e.NdJ("click",function(){const n=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.quitarProducto(n))}),e._UZ(2,"mat-icon",93),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("disabled",t.disabledAcciones||t.isCallingInsertService)}}function He(o,i){1&o&&e._UZ(0,"tr",94)}function Be(o,i){1&o&&e._UZ(0,"tr",95)}function Ge(o,i){if(1&o&&(e.TgZ(0,"table",60),e.ynx(1,61),e.YNc(2,we,2,0,"th",62)(3,ye,5,2,"td",63),e.BQk(),e.ynx(4,64),e.YNc(5,De,2,0,"th",65)(6,Ue,4,1,"td",66),e.BQk(),e.ynx(7,67),e.YNc(8,Ie,2,0,"th",68)(9,Me,4,6,"td",69),e.BQk(),e.ynx(10,70),e.YNc(11,Re,2,0,"th",71)(12,qe,2,1,"td",72),e.BQk(),e.ynx(13,73),e.YNc(14,Je,2,0,"th",62)(15,Qe,9,4,"td",72),e.BQk(),e.ynx(16,74),e.YNc(17,Ve,2,0,"th",65)(18,Ee,4,11,"td",72),e.BQk(),e.ynx(19,75),e.YNc(20,Ne,2,0,"th",62)(21,ze,3,1,"td",72),e.BQk(),e.YNc(22,He,1,0,"tr",76)(23,Be,1,0,"tr",77),e.qZA()),2&o){const t=e.oxw();e.Q6J("dataSource",t.lstProductosSeleccionados)("trackBy",t.trackByFn),e.xp6(22),e.Q6J("matHeaderRowDef",t.productoTableColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.productoTableColumns)}}function Oe(o,i){if(1&o&&e._UZ(0,"img",105),2&o){const t=e.oxw().$implicit;e.Q6J("src",t.urlFoto,e.LSH)("alt",t.nombre)}}function Ye(o,i){1&o&&(e.TgZ(0,"div",106),e._uU(1," SIN IMAGEN "),e.qZA())}const Le=(o,i,t)=>({"text-red-600":o,"text-orange-500":i,"text-green-600":t});function je(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",96)(1,"div",97),e.YNc(2,Oe,1,2,"img",98)(3,Ye,2,0,"ng-template",null,99,e.W1O),e.qZA(),e.TgZ(5,"h3",100),e._uU(6),e.qZA(),e.TgZ(7,"p",101)(8,"span",102),e._uU(9),e.ALo(10,"currency"),e.qZA()(),e.TgZ(11,"p",103),e._uU(12),e.qZA(),e.TgZ(13,"button",104),e.NdJ("click",function(){const n=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.seleccionarProducto(n))}),e._uU(14," Agregar "),e.qZA()()}if(2&o){const t=i.$implicit,r=e.MAs(4),a=e.oxw();e.xp6(2),e.Q6J("ngIf",t.urlFoto)("ngIfElse",r),e.xp6(4),e.Oqu(t.nombre),e.xp6(3),e.Oqu(e.G7q(10,7,e.kEZ(13,B,t.precioCosto,a.monedaInfo.codigoMoneda,a.monedaInfo.cultureInfo))),e.xp6(2),e.Q6J("ngClass",e.kEZ(17,Le,t.stock<=0,t.stock>0&&t.stock<=5,t.stock>5)),e.xp6(1),e.hij(" Stock: ",t.stock," "),e.xp6(1),e.Q6J("disabled",a.isCallingInsertService)}}function $e(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Fecha Compra es requerido "),e.qZA())}function Ke(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",107)(1,"button",108),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.quitarProveedor())}),e._UZ(2,"mat-icon",109),e.qZA(),e.TgZ(3,"div",110),e._uU(4),e.qZA(),e.TgZ(5,"div",111)(6,"div",48),e._UZ(7,"mat-icon",112),e.TgZ(8,"div",113),e._uU(9),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.isCallingInsertService),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:trash"),e.xp6(2),e.Oqu((null==t.proveedorData?null:t.proveedorData.numeroDocumento)||"N/D"),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:user"),e.xp6(2),e.lnq(" ",(null==t.proveedorData?null:t.proveedorData.nombreComercial)||(null==t.proveedorData?null:t.proveedorData.razonSocial)||""," ","|"," ",(null==t.proveedorData?null:t.proveedorData.correoElectronico)||""," ")}}function We(o,i){1&o&&(e.TgZ(0,"span"),e._uU(1,"Registrar Compra"),e.qZA())}function Xe(o,i){1&o&&e._UZ(0,"mat-progress-spinner",114),2&o&&e.Q6J("diameter",24)("mode","indeterminate")}let oe=(()=>{class o{get totalCompra(){return this.lstProductosSeleccionados.data.reduce((t,r)=>t+r.precioCompra*r.cantidad,0)}constructor(t,r,a,n,l,c,h){this._fuseConfirmationService=t,this._formBuilder=r,this._securityService=a,this._inventarioService=n,this._proveedorService=l,this._compraService=c,this._toolService=h,this.isCallingInsertService=s.vU.False,this.isCallingSelecProveedorService=s.vU.False,this.allProductoDataSource=new u.by,this.allProductByCategoryDataSource=[],this.lstProductosSeleccionados=new u.by,this.isBuscandoProductosDisabled=!1,this.hayProveedor=s.vU.False,this.productoTableColumns=["foto","nombre","stock","precioCompra","cantidad","total","acciones"],this.parametroBusquedaProducto="",this.parametroBusquedaProveedor="",this.notaAdicional="",this._unsubscribeAll=new k.x,this.imgNoData=s.HZ.noDataGraficos,this.decodeToken=this._securityService.getDecodetoken(),this.userInfoLogueado=this.decodeToken,this.monedaInfo=this._securityService.getMonedaStorage()}ngOnInit(){this.lstProductosSeleccionados.data=[],this.allProductoDataSource.data=[],this.formFiltros(),this.GetCategoriesWithProductsCountAsync()}GetCategoriesWithProductsCountAsync(){this._inventarioService.GetCategoriesWithProductsCountAsync().subscribe(t=>{this.allCategoriesDataSource=t},t=>{this._toolService.showError("Error","Error"),console.log(t)})}formFiltros(){this.filtroRegistroComprasForm=this._formBuilder.group({fechaRegistroCompra:[this._toolService.getDateTimeNow(),[d.kI.required]]})}aumentarCantidad(t){t.cantidad<t.stock?(t.cantidad++,this.lstProductosSeleccionados._updateChangeSubscription()):this._toolService.showWarning("L\xedmite de stock alcanzado","Advertencia")}onSelectCategoryProduct(t){this._inventarioService.GetAllProductsByCategoryAsync(t.value.idCategoria).subscribe(r=>{this.allProductByCategoryDataSource=r},r=>{this._toolService.showError("Error","Error"),console.log(r)})}InsertAsync(){const t=this._toolService.getTimeZone(),r=this.userInfoLogueado.idUsuario,a=this.proveedorData?.id,n=this.filtroRegistroComprasForm.get("fechaRegistroCompra").value,l=this.lstProductosSeleccionados.data.map(h=>({idProducto:h.id,urlFotoProducto:h.urlFoto,nombreProducto:h.nombre,colorProducto:h.color,colorCategoria:h.categoria?.color??"",colorMarca:h.marca?.color??"",nombreCategoria:h.categoria?.nombre??"",nombreMarca:h.marca?.nombre??"",nombreMedida:h.categoria?.medida?.nombre??"",cantidad:h.cantidad,precioCompra:h.precioCompra}));this.lstProductosSeleccionados.data.length!=s.Q6.Cero?M.a.isEmptyInputValue(t)?this._toolService.showWarning("Localizaci\xf3n inv\xe1lida","Advertencia"):M.a.isEmptyInputValue(r)?this._toolService.showWarning("Usuario inv\xe1lido","Advertencia"):M.a.isEmptyInputValue(n)?this._toolService.showWarning("Fecha de compra inv\xe1lida","Advertencia"):(this.configForm=this._formBuilder.group({title:"Confirmaci\xf3n de la Compra",message:"\xbfDesea registrar esta compra?",icon:this._formBuilder.group({show:!0,name:"heroicons_outline:exclamation-triangle",color:"primary"}),actions:this._formBuilder.group({confirm:this._formBuilder.group({show:!0,label:"Si",color:"primary"}),cancel:this._formBuilder.group({show:!0,label:"No"})}),dismissible:!0}),this._fuseConfirmationService.open(this.configForm.value).afterClosed().subscribe(h=>{if("confirmed"!=h)return;const A=new _e;A.destinationTimeZoneIdRegistro=t,A.idUsuario=r,A.idProveedor=a,A.lstDetalleCompra=l,A.notaAdicional=this.notaAdicional,A.fechaRegistroCompra=n,console.log("Request a enviar:",A),this.isCallingInsertService=s.vU.Show,this._compraService.InsertAsync(A).subscribe(P=>{if(P.success)return this.proveedorData=null,this.hayProveedor=s.vU.False,this.lstProductosSeleccionados.data=[],this.allProductoDataSource.data=[],this.allProductByCategoryDataSource=[],this.isCallingInsertService=s.vU.Hide,this.notaAdicional="",void xe.Z.success(P.titleMessage,P.message);this._toolService.showError("Error","Error"),this.isCallingInsertService=s.vU.Hide},P=>{this._toolService.showError("Error","Error"),console.log(P),this.isCallingInsertService=s.vU.Hide})})):this._toolService.showWarning("No hay productos seleccionados","Advertencia")}buscarProveedor(){if(!this.parametroBusquedaProveedor||""==this.parametroBusquedaProveedor.trim())return;const t=new fe;t.idUsuario=this.decodeToken.idUsuario,t.parametro=this.parametroBusquedaProveedor,this.isCallingSelecProveedorService=s.vU.True,this._proveedorService.GetByNumDocumentoCorreoAsync(t).subscribe(r=>{if(this.isCallingSelecProveedorService=s.vU.False,r)return this.proveedorData=r,this.hayProveedor=s.vU.True,void(this.parametroBusquedaProveedor="");this.proveedorData=null,this.hayProveedor=s.vU.False,this._toolService.showWarning("Proveedor no existe","Advertencia")},r=>{this._toolService.showError("Error","Error"),this.isCallingSelecProveedorService=s.vU.False,console.log(r)})}quitarProveedor(){this.proveedorData=null,this.hayProveedor=s.vU.False}disminuirCantidad(t){t.cantidad>1&&(t.cantidad--,this.lstProductosSeleccionados._updateChangeSubscription())}quitarProducto(t){this.lstProductosSeleccionados.data=this.lstProductosSeleccionados.data.filter(r=>r.id!==t.id)}calcularTotalProducto(t){return t.cantidad*t.precioCompra}filtrarProductos(t){const r=t.target.value;if(r.length>=s.Q6.Cuatro){const a=new K.H;return a.idUsuario=this.decodeToken.idUsuario,a.parametro=r,void this._inventarioService.GetProductoByCodeAsync(a).subscribe(n=>{n.length>s.Q6.Cero&&(this.allProductoDataSource.data=n)},n=>{this._toolService.showError("Error","Error"),console.log(n)})}this.allProductoDataSource.data=[]}keyupEnterProductos(t){const r=t.target.value,a=new K.H;a.idUsuario=this.decodeToken.idUsuario,a.parametro=r,this._inventarioService.GetProductoByCodeAsync(a).subscribe(n=>{n.length>s.Q6.Cero&&(this.allProductoDataSource.data=n)},n=>{this._toolService.showError("Error","Error"),console.log(n)})}seleccionarProducto(t){const r=this.lstProductosSeleccionados.data.findIndex(n=>n.codigo===t.codigo),a={...t,cantidad:1,precioCompra:t.precioCompra??0};-1===r?this.lstProductosSeleccionados.data=[...this.lstProductosSeleccionados.data,a]:this.lstProductosSeleccionados.data[r].cantidad++,this.lstProductosSeleccionados._updateChangeSubscription(),this.parametroBusquedaProducto="",this.allProductoDataSource.data=[]}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}trackByFn(t,r){return r.id||t}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(W.R),e.Y36(d.QS),e.Y36(R.I),e.Y36(Q.I),e.Y36(Ce.z),e.Y36(ee),e.Y36(y.o))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-registro-compras-page"]],decls:56,vars:34,consts:[[1,"flex","flex-col","flex-auto","w-full"],[1,"flex","flex-wrap","w-full","max-w-screen-xl","mx-auto","p-6","md:p-8"],[1,"flex","items-center","justify-between","w-full"],[1,"text-2xl","md:text-3xl","font-semibold","tracking-tight","leading-8"],[1,"w-full","xl:col-span-2","mt-6","relative"],[1,"relative"],["maxlength","50","type","text","placeholder","Buscar Producto",1,"w-full","p-3","pl-10","border","border-gray-300","rounded-xl","bg-card","shadow","focus:ring","focus:ring-primary-300","focus:outline-none","placeholder:text-gray-500",3,"disabled","ngModel","ngModelChange","keyup.enter","input"],[1,"absolute","left-3","top-3","text-gray-500",3,"svgIcon","click"],["class","absolute w-auto mt-2 bg-white shadow-lg rounded-xl border border-gray-300 overflow-hidden max-h-72 overflow-y-auto z-50 transition-all duration-200 ease-in-out",4,"ngIf"],[1,"flex","flex-wrap","-m-2",3,"change"],[4,"ngFor","ngForOf"],[1,"grid","grid-cols-1","xl:grid-cols-4","gap-8","w-full","mt-8"],[1,"xl:col-span-3","flex","flex-col","flex-auto","bg-card","shadow","rounded-2xl","overflow-hidden","px-6","pt-6","pb-10"],[1,"overflow-x-auto","md:overflow-visible","mx-6"],["class","w-full bg-transparent","mat-table","","matSort","",3,"dataSource","trackBy",4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","lg:grid-cols-4","xl:grid-cols-5","gap-5","mt-6"],["class","bg-white rounded-2xl shadow-lg p-4 flex flex-col items-center transform transition-transform hover:scale-105 hover:shadow-xl border border-gray-200",4,"ngFor","ngForOf"],[1,"xl:col-span-1","flex","flex-col","flex-auto","p-6","bg-card","rounded-2xl","shadow-lg"],[1,"flex","flex-col"],[1,"grid","grid-cols-2","gap-4"],[1,"col-span-2","flex","flex-col","items-center","justify-center","py-6","px-4","rounded-2xl","bg-green-100","text-green-700"],[1,"mt-1","text-2xl","font-semibold"],[1,"text-4xl","font-bold","leading-none","tracking-tight"],[3,"formGroup"],[1,"flex","items-center","mt-3"],[1,"text","font-medium","tracking-tight"],[1,"mt-3","relative"],[1,"w-full"],["required","","autocomplete","off","matInput","","autocomplete","false",3,"disabled","formControlName","matDatetimepicker","click"],["matPrefix","",3,"disabled","for"],["type","datetime","openOnFocus","true","timeInterval","5"],["fechaRegistroCompra",""],[4,"ngIf"],[1,"flex","items-center","mt-4"],["type","text","placeholder","RUC o Correo",1,"w-full","p-3","pl-12","border","border-gray-300","rounded-xl","bg-white","shadow","focus:ring","focus:ring-primary-300","focus:outline-none",3,"ngModel","disabled","ngModelChange","keyup.enter"],[1,"absolute","left-3","top-3","text-gray-500","cursor-pointer",3,"svgIcon","click"],["class","mt-3 p-2 border-t border-gray-300 bg-gray-100 rounded-lg shadow-md",4,"ngIf"],["id","notaAdicional","rows","3","placeholder","Nota adicional",1,"w-full","p-3","border","border-gray-300","rounded-xl","bg-white","shadow","focus:ring","focus:ring-primary-300",3,"disabled","ngModel","ngModelChange"],[1,"flex","justify-center","mt-6"],["mat-flat-button","","color","primary","type","button",1,"w-full","sm:inline-flex","ml-3","sm:w-full","sm:h-10","sm:items-center","sm:justify-center","transition","duration-300","ease-in-out","transform","hover:scale-105","hover:bg-primary-600","focus:outline-none","focus:ring-2","focus:ring-primary-300",3,"disabled","click"],[3,"diameter","mode",4,"ngIf"],[1,"absolute","w-auto","mt-2","bg-white","shadow-lg","rounded-xl","border","border-gray-300","overflow-hidden","max-h-72","overflow-y-auto","z-50","transition-all","duration-200","ease-in-out"],[1,"w-auto","text-left"],[1,"bg-gray-100"],[1,"p-2","text-sm","font-semibold"],["class","cursor-pointer hover:bg-gray-200",3,"click",4,"ngFor","ngForOf"],[1,"cursor-pointer","hover:bg-gray-200",3,"click"],[1,"min-w-10"],[1,"flex","items-center"],[1,"relative","flex","items-center","justify-center","w-12","h-12","mr-6","rounded","overflow-hidden","border"],["class","w-full h-full object-cover",3,"alt","src",4,"ngIf"],["class","flex items-center justify-center w-full h-full text-xs font-semibold leading-none text-center uppercase bg-gray-200",4,"ngIf"],[1,"p-2","text-sm"],[1,"inline-flex","items-center","font-bold","text-xs","px-2.5","py-0.5","rounded-full","tracking-wide","uppercase",3,"ngClass"],[1,"leading-relaxed","whitespace-nowrap"],[1,"w-full","h-full","object-cover",3,"alt","src"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","leading-none","text-center","uppercase","bg-gray-200"],[1,"m-2",3,"value"],[1,"text-secondary"],[1,"ml-1.5","font-medium","text-secondary"],["mat-table","","matSort","",1,"w-full","bg-transparent",3,"dataSource","trackBy"],["matColumnDef","foto"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","min-w-10",4,"matCellDef"],["matColumnDef","nombre"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","min-w-30",4,"matCellDef"],["matColumnDef","stock"],["mat-header-cell","","mat-sort-header","","class","text-center",4,"matHeaderCellDef"],["mat-cell","","class","min-w-10 text-center",4,"matCellDef"],["matColumnDef","precioCompra"],["mat-header-cell","","class","min-w-20 text-center",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","cantidad"],["matColumnDef","total"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["class","order-row h-16","mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"min-w-10"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"min-w-30"],[1,"ml-3","break-words","max-w-[150px]"],["mat-header-cell","","mat-sort-header","",1,"text-center"],["mat-cell","",1,"min-w-10","text-center"],["mat-header-cell","",1,"min-w-20","text-center"],["mat-cell",""],["type","number","min","0","step","0.01",1,"w-24","text-center","border","rounded-md","p-1",3,"ngModel","ngModelChange","input"],[1,"flex","items-center","space-x-2"],["mat-icon-button","","color","primary",3,"disabled","click"],["type","number","min","1","readonly","",1,"w-16","text-center","border","rounded-md",3,"disabled","ngModel","ngModelChange"],[1,"pr-6","w-auto","h-auto","rounded-full",2,"color","#056DB6"],["mat-icon-button","","color","warn",1,"p-1",3,"disabled","click"],["svgIcon","feather:trash-2"],["mat-header-row",""],["mat-row","",1,"order-row","h-16"],[1,"bg-white","rounded-2xl","shadow-lg","p-4","flex","flex-col","items-center","transform","transition-transform","hover:scale-105","hover:shadow-xl","border","border-gray-200"],[1,"w-24","h-24","mb-4","rounded-xl","overflow-hidden","border","border-gray-300"],["class","w-full h-full object-cover",3,"src","alt",4,"ngIf","ngIfElse"],["noImagen",""],[1,"text-base","font-semibold","text-center","text-gray-800"],[1,"text-sm","font-medium","text-gray-700","mt-1"],[2,"color","#056DB6"],[1,"text-xs","font-medium","mt-1",3,"ngClass"],[1,"mt-4","px-4","py-2","bg-blue-600","text-white","text-sm","font-medium","rounded-xl","shadow","hover:bg-blue-700","transition-colors",3,"disabled","click"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","text-center","uppercase","bg-gray-200","text-gray-600"],[1,"mt-3","p-2","border-t","border-gray-300","bg-gray-100","rounded-lg","shadow-md"],["mat-icon-button","","color","warn",1,"absolute","top-3","right-3",3,"disabled","click"],[3,"svgIcon"],[1,"text-lg","font-semibold"],[1,"flex","flex-col","sm:flex-row","sm:items-center","mt-3","space-y-2","sm:space-y-0","sm:space-x-4"],[1,"icon-size-5","text-primary-500",3,"svgIcon"],[1,"ml-2","text-md","text-gray-700"],[3,"diameter","mode"]],template:function(r,a){if(1&r){const n=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e._uU(4,"Nueva Compra"),e.qZA()(),e.TgZ(5,"div",4)(6,"div",5)(7,"input",6),e.NdJ("ngModelChange",function(c){return a.parametroBusquedaProducto=c})("keyup.enter",function(c){return a.keyupEnterProductos(c)})("input",function(c){return a.filtrarProductos(c)}),e.qZA(),e.TgZ(8,"mat-icon",7),e.NdJ("click",function(c){return a.keyupEnterProductos(c)}),e.qZA()(),e.YNc(9,Ae,14,1,"div",8),e.qZA(),e.TgZ(10,"div",4)(11,"mat-button-toggle-group",9),e.NdJ("change",function(c){return a.onSelectCategoryProduct(c)}),e.YNc(12,Fe,6,3,"ng-container",10),e.qZA()(),e.TgZ(13,"div",11)(14,"div",12)(15,"div",13),e.YNc(16,Ge,24,4,"table",14),e.TgZ(17,"div",15),e.YNc(18,je,15,21,"div",16),e.qZA()()(),e.TgZ(19,"div",17)(20,"div",18)(21,"div",19)(22,"div",20)(23,"div",21),e._uU(24,"Total"),e.qZA(),e.TgZ(25,"div",22),e._uU(26),e.ALo(27,"currency"),e.qZA()()()(),e.TgZ(28,"form",23)(29,"div",24)(30,"div",25),e._uU(31,"Fecha De Compra"),e.qZA()(),e.TgZ(32,"div",26)(33,"mat-form-field",27)(34,"input",28),e.NdJ("click",function(){e.CHM(n);const c=e.MAs(37);return e.KtG(c.open())}),e.qZA(),e._UZ(35,"mat-datetimepicker-toggle",29)(36,"mat-datetimepicker",30,31),e.YNc(38,$e,2,0,"mat-error",32),e.qZA()()(),e.TgZ(39,"div",33)(40,"div",25),e._uU(41,"Buscar Proveedor"),e.qZA()(),e.TgZ(42,"div",26)(43,"div",5)(44,"input",34),e.NdJ("ngModelChange",function(c){return a.parametroBusquedaProveedor=c})("keyup.enter",function(){return a.buscarProveedor()}),e.qZA(),e.TgZ(45,"mat-icon",35),e.NdJ("click",function(){return a.buscarProveedor()}),e.qZA()()(),e.YNc(46,Ke,10,7,"div",36),e.TgZ(47,"div",24)(48,"div",25),e._uU(49,"Nota adicional"),e.qZA()(),e.TgZ(50,"div",26)(51,"textarea",37),e.NdJ("ngModelChange",function(c){return a.notaAdicional=c}),e.qZA()(),e.TgZ(52,"div",38)(53,"button",39),e.NdJ("click",function(){return a.InsertAsync()}),e.YNc(54,We,2,0,"span",32)(55,Xe,1,2,"mat-progress-spinner",40),e.qZA()()()()()()}if(2&r){const n=e.MAs(37);e.xp6(7),e.Q6J("disabled",a.isBuscandoProductosDisabled||a.isCallingInsertService)("ngModel",a.parametroBusquedaProducto),e.xp6(1),e.Q6J("svgIcon","heroicons_mini:magnifying-glass"),e.xp6(1),e.Q6J("ngIf",a.allProductoDataSource.data.length>0),e.xp6(3),e.Q6J("ngForOf",a.allCategoriesDataSource),e.xp6(4),e.Q6J("ngIf",(null==a.lstProductosSeleccionados?null:a.lstProductosSeleccionados.data.length)>0),e.xp6(2),e.Q6J("ngForOf",a.allProductByCategoryDataSource),e.xp6(8),e.hij(" ",e.G7q(27,24,e.kEZ(30,B,a.totalCompra,a.monedaInfo.codigoMoneda,a.monedaInfo.cultureInfo))," "),e.xp6(2),e.Q6J("formGroup",a.filtroRegistroComprasForm),e.xp6(6),e.Q6J("disabled",a.isCallingInsertService)("formControlName","fechaRegistroCompra")("matDatetimepicker",n),e.xp6(1),e.Q6J("disabled",a.isCallingInsertService)("for",n),e.xp6(3),e.Q6J("ngIf",a.filtroRegistroComprasForm.get("fechaRegistroCompra").hasError("required")),e.xp6(6),e.Q6J("ngModel",a.parametroBusquedaProveedor)("disabled",a.isCallingInsertService),e.xp6(1),e.Q6J("svgIcon","heroicons_mini:magnifying-glass"),e.xp6(1),e.Q6J("ngIf",a.hayProveedor),e.xp6(5),e.Q6J("disabled",a.isCallingInsertService)("ngModel",a.notaAdicional),e.xp6(2),e.Q6J("disabled",!a.hayProveedor||a.isCallingInsertService||0==a.lstProductosSeleccionados.data.length||!a.filtroRegistroComprasForm.get("fechaRegistroCompra").value),e.xp6(1),e.Q6J("ngIf",!a.isCallingInsertService),e.xp6(1),e.Q6J("ngIf",a.isCallingInsertService)}},dependencies:[g.mk,g.sg,g.O5,H._R,H.C,H.RZ,d._Y,d.Fj,d.wV,d.JJ,d.JL,d.Q7,d.nD,d.qQ,d.sg,d.u,d.On,q.Nt,f.KE,f.TO,f.qo,te.A9,te.Yi,J.Ou,Z.lW,Z.RK,D.Hw,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,F.YE,F.nU,g.H9]})}return o})();var V=m(9315),p=m(308),w=m(1476),E=m(937);let et=(()=>{class o extends w.ye{constructor(){super(...arguments),this.itemsPerPageLabel="Ventas por p\xe1gina:",this.nextPageLabel="Siguiente p\xe1gina",this.previousPageLabel="P\xe1gina anterior",this.getRangeLabel=(t,r,a)=>0===a?"P\xe1gina 1 de 1":`P\xe1gina ${t+1} de ${Math.ceil(a/r)}`}static#e=this.\u0275fac=(()=>{let t;return function(a){return(t||(t=e.n5z(o)))(a||o)}})();static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();class tt{}class ot{}class at{}var G=m(7700);let rt=(()=>{class o extends w.ye{constructor(){super(...arguments),this.itemsPerPageLabel="Detalle por p\xe1gina:",this.nextPageLabel="Siguiente p\xe1gina",this.previousPageLabel="P\xe1gina anterior",this.getRangeLabel=(t,r,a)=>0===a?"P\xe1gina 1 de 1":`P\xe1gina ${t+1} de ${Math.ceil(a/r)}`}static#e=this.\u0275fac=(()=>{let t;return function(a){return(t||(t=e.n5z(o)))(a||o)}})();static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();const it=["detalleCompraTable"];function nt(o,i){1&o&&(e.TgZ(0,"th",28),e._uU(1,"Imagen"),e.qZA())}function st(o,i){if(1&o&&e._UZ(0,"img",34),2&o){const t=e.oxw().$implicit;e.Q6J("alt","Imagen de "+t.nombreProducto)("src",t.urlFotoProducto,e.LSH)}}function lt(o,i){1&o&&(e.TgZ(0,"div",35),e._uU(1," SIN IMAGEN "),e.qZA())}function ct(o,i){if(1&o&&(e.TgZ(0,"td",29)(1,"div",30)(2,"div",31),e.YNc(3,st,1,2,"img",32)(4,lt,2,0,"div",33),e.qZA()()()),2&o){const t=i.$implicit;e.xp6(3),e.Q6J("ngIf",t.urlFotoProducto),e.xp6(1),e.Q6J("ngIf",!t.urlFotoProducto)}}function mt(o,i){1&o&&(e.TgZ(0,"th",36),e._uU(1,"Nombre Producto"),e.qZA())}function dt(o,i){if(1&o&&(e.TgZ(0,"td",37)(1,"span",30)(2,"span",38),e._uU(3),e.qZA()()()),2&o){const t=i.$implicit;e.xp6(3),e.Oqu(t.nombreProducto)}}function pt(o,i){1&o&&(e.TgZ(0,"th",36),e._uU(1,"Categor\xeda"),e.qZA())}function ut(o,i){if(1&o&&(e.TgZ(0,"td",37)(1,"span",30),e._UZ(2,"span",39),e.TgZ(3,"span",40),e._uU(4),e.qZA()()()),2&o){const t=i.$implicit;e.xp6(2),e.Udp("background-color",t.colorCategoria),e.xp6(2),e.Oqu(t.nombreCategoria)}}function gt(o,i){1&o&&(e.TgZ(0,"th",36),e._uU(1,"Marca"),e.qZA())}function ht(o,i){if(1&o&&(e.TgZ(0,"td",37)(1,"span",30),e._UZ(2,"span",39),e.TgZ(3,"span",40),e._uU(4),e.qZA()()()),2&o){const t=i.$implicit;e.xp6(2),e.Udp("background-color",t.colorMarca),e.xp6(2),e.Oqu(t.nombreMarca)}}function ft(o,i){1&o&&(e.TgZ(0,"th",36),e._uU(1,"Precio Compra"),e.qZA())}const ae=(o,i,t)=>[o,i,"code","",t];function _t(o,i){if(1&o&&(e.TgZ(0,"td",41)(1,"span",42),e._uU(2),e.ALo(3,"currency"),e.qZA()()),2&o){const t=i.$implicit,r=e.oxw();e.xp6(2),e.hij(" ",e.G7q(3,1,e.kEZ(7,ae,t.precioProducto,r.monedaInfo.codigoMoneda,r.monedaInfo.cultureInfo))," ")}}function xt(o,i){1&o&&(e.TgZ(0,"th",43),e._uU(1,"Cantidad"),e.qZA())}function Ct(o,i){if(1&o&&(e.TgZ(0,"td",44),e._uU(1),e.qZA()),2&o){const t=i.$implicit;e.xp6(1),e.hij(" ",t.cantidad," ")}}function vt(o,i){1&o&&(e.TgZ(0,"th",36),e._uU(1,"Total"),e.qZA())}function bt(o,i){if(1&o&&(e.TgZ(0,"td",41)(1,"span",42),e._uU(2),e.ALo(3,"currency"),e.qZA()()),2&o){const t=i.$implicit,r=e.oxw();e.xp6(2),e.hij(" ",e.G7q(3,1,e.kEZ(7,ae,t.cantidad*t.precioProducto,r.monedaInfo.codigoMoneda,r.monedaInfo.cultureInfo))," ")}}function Tt(o,i){1&o&&e._UZ(0,"tr",45)}function Zt(o,i){1&o&&e._UZ(0,"tr",46)}const At=()=>[10,15,20];function Ft(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",47)(1,"mat-paginator",48,49),e.NdJ("page",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.onPageChange(a))}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("length",t.allDetalleCompraDataSource.data.length)("pageSize",10)("pageSizeOptions",e.DdM(3,At))}}function wt(o,i){if(1&o&&(e.TgZ(0,"div",47),e._UZ(1,"img",50),e.TgZ(2,"div",51),e._uU(3),e.qZA(),e.TgZ(4,"p",52),e._uU(5,"Aplique otros filtros de b\xfasqueda"),e.qZA()()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("src",t.imgNoDataUltimosRegistros,e.LSH),e.xp6(2),e.Oqu(t.textoResultadoTable)}}let re=(()=>{class o{constructor(t,r,a){this.matDialogRef=t,this.paramsForms=r,this._toolService=a,this.pageSlice=new u.by,this.detalleCompraTableColumns=["urlfotoproducto","nombreproducto","nombrecategoria","nombremarca","preciocompra","cantidad","total"],this.allDetalleCompraDataSource=new u.by,this.isCallingService=s.vU.False}ngOnInit(){this.monedaInfo=this.paramsForms.monedaInfo,this.allDetalleCompraDataSource.data=this.paramsForms.lstDetalleCompra,this.numeroCompra=this.paramsForms.numeroCompra,this.setPageSlice(this.paramsForms.lstDetalleCompra)}cerrarVentanaEmergente(){this.matDialogRef.close()}trackByFn(t,r){return r.id||t}onPageChange(t){const r=t.pageIndex*t.pageSize;let a=r+t.pageSize;a>this.allDetalleCompraDataSource.data.length&&(a=this.allDetalleCompraDataSource.data.length),this.pageSlice.data=this.allDetalleCompraDataSource.data.slice(r,a)}setPageSlice(t){this.pageSlice.data=t.slice(s.Q6.Cero,s.Q6.Diez),this._paginator&&(this._paginator.pageIndex=s.Q6.Cero,this._paginator.pageSize=s.Q6.Diez)}ngAfterViewInit(){this.allDetalleCompraDataSource.sort=this.detalleCompraMatSort,this.allDetalleCompraDataSource.paginator=this._paginator}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(G.so),e.Y36(G.WI),e.Y36(y.o))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-detalle-compra-page"]],viewQuery:function(r,a){if(1&r&&(e.Gf(w.NW,5),e.Gf(it,5,F.YE)),2&r){let n;e.iGM(n=e.CRH())&&(a._paginator=n.first),e.iGM(n=e.CRH())&&(a.detalleCompraMatSort=n.first)}},features:[e._Bn([{provide:w.ye,useClass:rt}])],decls:37,vars:8,consts:[[1,"flex","flex-col","md:min-w-200","max","-m-6","height-dialog"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","",3,"tabIndex","click"],["svgIcon","heroicons_outline:x-mark",1,"text-current"],[1,"flex","flex-col","flex-auto","w-full"],[1,"grid","grid-cols-1","xl:grid-cols-1","gap-8","w-full","mt-6"],[1,"xl:col-span-1","flex","flex-col","flex-auto","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"overflow-x-auto","mx-6"],["mat-table","","matSort","",1,"w-full","bg-transparent","mb-3",3,"dataSource","trackBy"],["detalleCompraTable",""],["matColumnDef","urlfotoproducto"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","min-w-10",4,"matCellDef"],["matColumnDef","nombreproducto"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","min-w-30",4,"matCellDef"],["matColumnDef","nombrecategoria"],["matColumnDef","nombremarca"],["matColumnDef","preciocompra"],["mat-cell","",4,"matCellDef"],["matColumnDef","cantidad"],["mat-header-cell","","mat-sort-header","","class","text-center",4,"matHeaderCellDef"],["mat-cell","","class","text-center min-w-10",4,"matCellDef"],["matColumnDef","total"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","paginator",4,"ngIf"],["mat-header-cell",""],["mat-cell","",1,"min-w-10"],[1,"flex","items-center"],[1,"relative","flex","items-center","justify-center","w-12","h-12","mr-6","rounded","overflow-hidden","border"],["class","w-full h-full object-cover",3,"alt","src",4,"ngIf"],["class","flex items-center justify-center w-full h-full text-xs font-semibold leading-none text-center uppercase bg-gray-200",4,"ngIf"],[1,"w-full","h-full","object-cover",3,"alt","src"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","leading-none","text-center","uppercase","bg-gray-200"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"min-w-30"],[1,"ml-3","leading-4"],[1,"w-2","h-2","rounded-full"],[1,"ml-3"],["mat-cell",""],[1,"pr-2",2,"color","#056DB6"],["mat-header-cell","","mat-sort-header","",1,"text-center"],["mat-cell","",1,"text-center","min-w-10"],["mat-header-row",""],["mat-row",""],[1,"paginator"],["aria-label","Seleccione p\xe1gina",3,"length","pageSize","pageSizeOptions","page"],["paginator",""],["alt","No hay datos disponibles",1,"w-72","mx-auto","mt-2",3,"src"],[1,"mt-4","text-2xl","font-semibold","text-center"],[1,"mt-2","text-gray-500","text-center"]],template:function(r,a){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return a.cerrarVentanaEmergente()}),e._UZ(5,"mat-icon",4),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"table",9,10),e.ynx(12,11),e.YNc(13,nt,2,0,"th",12)(14,ct,5,2,"td",13),e.BQk(),e.ynx(15,14),e.YNc(16,mt,2,0,"th",15)(17,dt,4,1,"td",16),e.BQk(),e.ynx(18,17),e.YNc(19,pt,2,0,"th",15)(20,ut,5,3,"td",16),e.BQk(),e.ynx(21,18),e.YNc(22,gt,2,0,"th",15)(23,ht,5,3,"td",16),e.BQk(),e.ynx(24,19),e.YNc(25,ft,2,0,"th",15)(26,_t,4,11,"td",20),e.BQk(),e.ynx(27,21),e.YNc(28,xt,2,0,"th",22)(29,Ct,2,1,"td",23),e.BQk(),e.ynx(30,24),e.YNc(31,vt,2,0,"th",15)(32,bt,4,11,"td",20),e.BQk(),e.YNc(33,Tt,1,0,"tr",25)(34,Zt,1,0,"tr",26),e.qZA()(),e.YNc(35,Ft,3,4,"div",27)(36,wt,6,2,"div",27),e.qZA()()()()),2&r&&(e.xp6(3),e.hij("Detalle Compra Nro. ",a.numeroCompra,""),e.xp6(1),e.Q6J("tabIndex",-1),e.xp6(6),e.Q6J("dataSource",a.pageSlice)("trackBy",a.trackByFn),e.xp6(23),e.Q6J("matHeaderRowDef",a.detalleCompraTableColumns),e.xp6(1),e.Q6J("matRowDefColumns",a.detalleCompraTableColumns),e.xp6(1),e.Q6J("ngIf",a.allDetalleCompraDataSource.data.length>0),e.xp6(1),e.Q6J("ngIf",0===a.allDetalleCompraDataSource.data.length))},dependencies:[g.O5,Z.RK,D.Hw,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,w.NW,F.YE,F.nU,g.H9]})}return o})(),St=(()=>{class o{constructor(t){this.apiService=t}GetDetalleAsync(t){return this.apiService.query(x.Cj.GetDetalleAsync,t).pipe((0,C.b)(r=>r))}GetAnalisisProductosByFilterAsync(t){return this.apiService.post(x.Cj.GetAnalisisProductosByFilterAsync,t).pipe((0,C.b)(r=>r))}GetAnalisisCategoriasByFilterAsync(t){return this.apiService.post(x.Cj.GetAnalisisCategoriasByFilterAsync,t).pipe((0,C.b)(r=>r))}GetAnalisisMarcasByFilterAsync(t){return this.apiService.post(x.Cj.GetAnalisisMarcasByFilterAsync,t).pipe((0,C.b)(r=>r))}GetResumenReporteAsync(t){return this.apiService.post(x.Cj.GetResumenReporteAsync,t).pipe((0,C.b)(r=>r))}GetReportePorProductosAsync(t){return this.apiService.postBlob(x.Cj.GetReportePorProductosAsync,t).pipe((0,C.b)(r=>r))}GetReportePorCategoriasAsync(t){return this.apiService.postBlob(x.Cj.GetReportePorCategoriasAsync,t).pipe((0,C.b)(r=>r))}GetReportePorMarcasAsync(t){return this.apiService.postBlob(x.Cj.GetReportePorMarcasAsync,t).pipe((0,C.b)(r=>r))}static#e=this.\u0275fac=function(r){return new(r||o)(e.LFG(X.s))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var N=m(6670),Pt=m(2228),v=m(7988),S=m(8525),b=m(2651),T=m(8034),z=m(2268);const yt=["selectUsuarioItem"],Dt=["historialCompraTable"],Ut=["matDrawer"];function It(o,i){1&o&&(e.ynx(0),e._uU(1,", "),e.BQk())}function kt(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,It,2,0,"ng-container",13),e.qZA()),2&o){const t=i.$implicit,r=i.index;e.oxw(2);const a=e.MAs(16);e.xp6(1),e.hij(" ",t.correoElectronico||"",""),e.xp6(1),e.Q6J("ngIf",r<a.value.length-1)}}function Mt(o,i){if(1&o&&(e.ynx(0),e.YNc(1,kt,3,2,"span",44),e.BQk()),2&o){e.oxw();const t=e.MAs(16);e.xp6(1),e.Q6J("ngForOf",t.value)}}function Rt(o,i){if(1&o&&(e.TgZ(0,"mat-option",45),e._uU(1),e.qZA()),2&o){const t=i.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.correoElectronico,"")}}function qt(o,i){1&o&&e._UZ(0,"mat-icon",46),2&o&&e.Q6J("svgIcon","heroicons_solid:magnifying-glass")}function Jt(o,i){1&o&&(e.TgZ(0,"span",47),e._uU(1,"Buscar"),e.qZA())}function Qt(o,i){1&o&&e._UZ(0,"mat-progress-spinner",48),2&o&&e.Q6J("diameter",24)("mode","indeterminate")}function Vt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",49),e._UZ(1,"mat-icon",6),e.qZA(),e.TgZ(2,"mat-menu",null,50)(4,"button",51),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onExportar())}),e._UZ(5,"mat-icon",6),e.TgZ(6,"span",52),e._uU(7,"Exportar"),e.qZA()(),e.TgZ(8,"button",51),e.NdJ("click",function(){e.CHM(t),e.oxw();const a=e.MAs(2);return e.KtG(a.open())}),e._UZ(9,"mat-icon",6),e.TgZ(10,"span",52),e._uU(11,"Filtrar"),e.qZA()()()}if(2&o){const t=e.MAs(3);e.Q6J("matMenuTriggerFor",t),e.xp6(1),e.Q6J("svgIcon","heroicons_mini:ellipsis-vertical"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:arrow-up-tray"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:adjustments-horizontal")}}function Et(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",53),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onExportar())}),e._UZ(1,"mat-icon",54),e.TgZ(2,"span",47),e._uU(3,"Exportar"),e.qZA()(),e.TgZ(4,"button",55),e.NdJ("click",function(){e.CHM(t),e.oxw();const a=e.MAs(2);return e.KtG(a.open())}),e._UZ(5,"mat-icon",54),e.TgZ(6,"span",47),e._uU(7,"Filtrar"),e.qZA()()}2&o&&(e.Q6J("color","primary")("color","primary"),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:arrow-up-tray"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:adjustments-horizontal"))}const Nt=()=>({"border-radius":"0",height:"50px"});function zt(o,i){if(1&o&&(e.TgZ(0,"div",56),e._UZ(1,"ngx-skeleton-loader",57),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("count",t.skeletonNumber)("theme",e.DdM(2,Nt))}}function Ht(o,i){1&o&&(e.TgZ(0,"th",78),e._uU(1," N\xfamero de Compra "),e.qZA())}function Bt(o,i){if(1&o&&(e.TgZ(0,"td",79)(1,"span",80)(2,"span",81),e._uU(3),e.qZA()()()),2&o){const t=i.$implicit;e.xp6(3),e.Oqu(t.numeroCompra)}}function Gt(o,i){1&o&&(e.TgZ(0,"th",78),e._uU(1," Nombre Proveedor "),e.qZA())}function Ot(o,i){if(1&o&&(e.TgZ(0,"td",82)(1,"span",83),e._uU(2),e.qZA()()),2&o){const t=i.$implicit;e.xp6(2),e.hij(" ",t.nombreProveedor," ")}}function Yt(o,i){1&o&&(e.TgZ(0,"th",78),e._uU(1," Correo Usuario "),e.qZA())}function Lt(o,i){if(1&o&&(e.TgZ(0,"td",82)(1,"span",83)(2,"a",84),e._uU(3),e.ALo(4,"lowercase"),e.qZA()()()),2&o){const t=i.$implicit;e.xp6(2),e.Q6J("href","mailto:"+t.correoUsuario,e.LSH),e.xp6(1),e.hij(" ",e.lcZ(4,2,t.correoUsuario)," ")}}function jt(o,i){1&o&&(e.TgZ(0,"th",78),e._uU(1," Fecha Compra "),e.qZA())}function $t(o,i){if(1&o&&(e.TgZ(0,"td",85)(1,"span",83),e._uU(2),e.ALo(3,"date"),e.qZA()()),2&o){const t=i.$implicit;e.xp6(2),e.hij(" ",e.xi3(3,1,t.fechaCompra,"dd/MM/yyyy HH:mm")," ")}}function Kt(o,i){1&o&&(e.TgZ(0,"th",86),e._uU(1," Total Compra "),e.qZA())}const Wt=(o,i,t)=>[o,i,"code","",t];function Xt(o,i){if(1&o&&(e.TgZ(0,"td",82)(1,"span",87),e._uU(2),e.ALo(3,"currency"),e.qZA()()),2&o){const t=i.$implicit,r=e.oxw(2);e.xp6(2),e.hij(" ",e.G7q(3,1,e.kEZ(7,Wt,t.totalCompra,r.monedaInfo.codigoMoneda,r.monedaInfo.cultureInfo))," ")}}function eo(o,i){1&o&&(e.TgZ(0,"th",86),e._uU(1," Estado "),e.qZA())}const to=(o,i)=>({"bg-red-200 text-red-800 dark:bg-red-600 dark:text-red-50":o,"bg-green-200 text-green-800 dark:bg-green-600 dark:text-green-50":i});function oo(o,i){if(1&o&&(e.TgZ(0,"td",88)(1,"span",89)(2,"span",90),e._uU(3),e.qZA()()()),2&o){const t=i.$implicit;e.xp6(1),e.Q6J("ngClass",e.WLB(2,to,!1===(null==t?null:t.estado),!0===(null==t?null:t.estado))),e.xp6(2),e.hij(" ",!0===(null==t?null:t.estado)?"Completado":"Anulado"," ")}}function ao(o,i){1&o&&(e.TgZ(0,"th",78),e._uU(1," Acciones "),e.qZA())}function ro(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",51),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,n=e.oxw(2);return e.KtG(n.AnulaAsync(a))}),e._UZ(1,"mat-icon",95),e._uU(2," Anular "),e.qZA()}}function io(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"td",82)(1,"button",91)(2,"mat-icon"),e._uU(3,"more_vert"),e.qZA()(),e.TgZ(4,"mat-menu",null,92)(6,"button",51),e.NdJ("click",function(){const n=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.showFormDetalleCompraDialog(n))}),e._UZ(7,"mat-icon",93),e._uU(8," Ver "),e.qZA(),e.YNc(9,ro,3,0,"button",94),e.qZA()()}if(2&o){const t=i.$implicit,r=e.MAs(5),a=e.oxw(2);e.xp6(1),e.Q6J("matMenuTriggerFor",r)("disabled",a.disabledAcciones),e.xp6(8),e.Q6J("ngIf",!0===t.estado)}}function no(o,i){1&o&&e._UZ(0,"tr",96)}function so(o,i){1&o&&e._UZ(0,"tr",97)}const lo=()=>[10,15,20];function co(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",98)(1,"mat-paginator",99,100),e.NdJ("page",function(a){e.CHM(t);const n=e.oxw(2);return e.KtG(n.onPageChange(a))}),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("length",t.allHistorialCompraDataSource.data.length)("pageSize",5)("pageSizeOptions",e.DdM(3,lo))}}function mo(o,i){if(1&o&&(e.TgZ(0,"div",98),e._UZ(1,"img",101),e.TgZ(2,"div",102),e._uU(3),e.qZA(),e.TgZ(4,"div")(5,"p",103),e._uU(6,"Aplique otros filtros de b\xfasqueda"),e.qZA()()()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("src",t.imgNoDataUltimosRegistros,e.LSH),e.xp6(2),e.hij(" ",t.textoResultadoTable,"")}}function po(o,i){if(1&o&&(e.TgZ(0,"div",58)(1,"div",59)(2,"table",60,61),e.ynx(4,62),e.YNc(5,Ht,2,0,"th",63)(6,Bt,4,1,"td",64),e.BQk(),e.ynx(7,65),e.YNc(8,Gt,2,0,"th",63)(9,Ot,3,1,"td",66),e.BQk(),e.ynx(10,67),e.YNc(11,Yt,2,0,"th",63)(12,Lt,5,4,"td",66),e.BQk(),e.ynx(13,68),e.YNc(14,jt,2,0,"th",63)(15,$t,4,4,"td",69),e.BQk(),e.ynx(16,70),e.YNc(17,Kt,2,0,"th",71)(18,Xt,4,11,"td",66),e.BQk(),e.ynx(19,72),e.YNc(20,eo,2,0,"th",71)(21,oo,4,5,"td",73),e.BQk(),e.ynx(22,74),e.YNc(23,ao,2,0,"th",63)(24,io,10,3,"td",66),e.BQk(),e.YNc(25,no,1,0,"tr",75)(26,so,1,0,"tr",76),e.qZA()(),e.YNc(27,co,3,4,"div",77)(28,mo,7,2,"div",77),e.qZA()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("dataSource",t.pageSlice)("trackBy",t.trackByFn),e.xp6(23),e.Q6J("matHeaderRowDef",t.historialCompraTableColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.historialCompraTableColumns),e.xp6(1),e.Q6J("ngIf",t.allHistorialCompraDataSource.data.length>0),e.xp6(1),e.Q6J("ngIf",0===t.allHistorialCompraDataSource.data.length)}}let ie=(()=>{class o{constructor(t,r,a,n,l,c,h){this._matDialog=t,this._fuseConfirmationService=r,this._formBuilder=a,this._securityService=n,this._compraService=l,this._detalleCompraService=c,this._toolService=h,this.decodeToken=this.obtenerInfouserInfoLogueado(),this.monedaInfo=this.obtenerInfoMoneda(),this.disabledAcciones=s.vU.False,this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.False,this.skeleton=s.vU.False,this.skeletonNumber=s.Q6.Ocho,this.textoResultadoTable="",this.imgNoDataUltimosRegistros=s.HZ.noDataUltimosRegistros,this.minDate=this._toolService.getMinDateFIlter(),this.maxDate=this._toolService.getMaxDateFIlter(),this.pageSlice=new u.by,this.allHistorialCompraDataSource=new u.by,this.historialCompraTableColumns=["numeroCompra","nombreProveedor","correoUsuario","fechaCompra","totalCompra","estado","acciones"],this._unsubscribeAll=new k.x}ngOnInit(){this.formFiltros(),this.showSkeleton(),this.getFilterComboConsulta()}ngAfterViewInit(){this.allHistorialCompraDataSource.sort=this.historialCompraTableMatSort,this.allHistorialCompraDataSource.paginator=this._paginator}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}formFiltros(){this.decodeToken=this.obtenerInfouserInfoLogueado(),this.filtroCompraForm=this._formBuilder.group({usuarios:[""],numeroCompra:[""],fechaCompraInicio:[this._toolService.getStartDateOfMonth()],fechaCompraFin:[this._toolService.getStartDateOfMonth()],montoCompraInicio:[""],montoCompraFin:[""]})}getFilterComboConsulta(){const t=this.obtenerRequest();(0,V.D)({dataUsuarios:this._compraService.GetAllUsuariosAsync(),dataCompras:this._compraService.GetAllByFilterAsync(t)}).subscribe({next:r=>{if(this.allUsuarioSource=r.dataUsuarios,this.allHistorialCompraDataSource.data=r.dataCompras,this.pageSlice.data=[],this.filtroCompraForm.get("usuarios")?.setValue(this.allUsuarioSource),this.allHistorialCompraDataSource.data.length>0)return this.disabledExportar=s.vU.False,this.setPageSlice(this.allHistorialCompraDataSource.data),this.disabledBuscar=s.vU.False,void this.hideSkeleton();this.textoResultadoTable=s.RO.NoDataResult,this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.True,this.hideSkeleton()},error:r=>{this.hideSkeleton(),this._toolService.showError(p.J.Transaction,p.J.Tittle),this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.True,console.log(r)}})}btnBuscar(){this.getSkeletonCount(),this.showSkeleton(),this.GetAllHistorialComprasByFilterAsync(s.vU.True,s.vU.True)}GetAllHistorialComprasByFilterAsync(t,r){const a=this.obtenerRequest();this.disabledBuscar=t,this._compraService.GetAllByFilterAsync(a).subscribe({next:n=>{if(this.allHistorialCompraDataSource.data=n,this.pageSlice.data=[],this.allHistorialCompraDataSource.data.length>0)return this.disabledExportar=s.vU.False,this.setPageSlice(this.allHistorialCompraDataSource.data),this.disabledBuscar=s.vU.False,this.hideSkeleton(),void(r&&this.closedDrawer());this.textoResultadoTable=s.RO.NoDataResult,this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.True,this.hideSkeleton(),r&&this.closedDrawer()},error:n=>{this.hideSkeleton(),this._toolService.showError(p.J.Transaction,p.J.Tittle),this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.True,r&&this.closedDrawer(),console.log(n)}})}showFormDetalleCompraDialog(t){const r=new at,a=this._toolService.getTimeZone(),n=this.decodeToken.idUsuario,l=t.idCompra;M.a.isEmptyInputValue(a)?this._toolService.showWarning(p.T.InvalidLocalizacion,p.T.Tittle):M.a.isEmptyInputValue(n)?this._toolService.showWarning(p.T.InvalidUIdUsuario,p.T.Tittle):(this.disabledAcciones=s.vU.True,r.destinationTimeZoneId=a,r.idUsuario=n,r.idCompra=l,this._detalleCompraService.GetDetalleAsync(r).subscribe(c=>{this.disabledAcciones=s.vU.False,this._matDialog.open(re,{autoFocus:s.vU.False,data:{lstDetalleCompra:c,monedaInfo:this.monedaInfo,numeroCompra:t.numeroCompra}})},c=>{this._toolService.showError(p.J.Transaction,p.J.Tittle),this.disabledAcciones=s.vU.False}))}AnulaAsync(t){this.configForm=this._formBuilder.group({title:"Anular Compra",message:"\xbfSeguro que quieres anular la compra "+t.numeroCompra+"?.",icon:this._formBuilder.group({show:!0,name:"heroicons_outline:exclamation-triangle",color:"warn"}),actions:this._formBuilder.group({confirm:this._formBuilder.group({show:!0,label:"Borrar",color:"warn"}),cancel:this._formBuilder.group({show:!0,label:"Cancelar"})}),dismissible:!0}),this._fuseConfirmationService.open(this.configForm.value).afterClosed().subscribe(a=>{if("confirmed"!=a)return;const n=new ot;n.destinationTimeZoneIdActualizacion=this._toolService.getTimeZone(),n.id=t.idCompra,n.idUsuario=this.decodeToken.idUsuario,this.disabledAcciones=s.vU.True,this._compraService.AnulaAsync(n).subscribe(l=>l.code==s.Pc.Advertencia?(this._toolService.showWarning(l.message,l.titleMessage),void(this.disabledAcciones=s.vU.False)):l.success?(this._toolService.showSuccess(l.message,l.titleMessage),this.setPageSlice(this.allHistorialCompraDataSource.data),this.disabledAcciones=s.vU.False,this.getSkeletonCount(),this.showSkeleton(),void this.GetAllHistorialComprasByFilterAsync(s.vU.True,s.vU.True)):(this._toolService.showError(p.J.Transaction,p.J.Tittle),void(this.disabledAcciones=s.vU.False)),l=>{this.disabledAcciones=s.vU.False,this._toolService.showError(p.J.Transaction,p.J.Tittle)})})}onExportar(){if(this.pageSlice.data.length===s.Q6.Cero)return;const t=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda),r=s.Dq.NombreExcelExportarCompras,a=s.Dq.NombreHojaExcelCompras,l=[];this.allHistorialCompraDataSource.data.forEach(_=>{l.push({"N\xfamero Compra":_.numeroCompra,Proveedor:_.nombreProveedor,"Correo Usuario":_.correoUsuario,"Fecha Compra":this._toolService.formatoFecha(_.fechaCompra),"Total Compra":t.format(_.totalCompra),"\xbfAnulado?":_.estado==s.vU.False?"No":"Si"})});const c=E.utils.json_to_sheet(l,{header:["N\xfamero Compra","Proveedor","Correo Usuario","Fecha Compra","Total Compra","\xbfAnulado?"]}),h=l.reduce((_,U)=>(Object.keys(U).forEach((ge,he)=>{const Da=U[ge]?U[ge].toString().length:20;_[he]=Math.max(_[he]||20,Da)}),_),[]);c["!cols"]=h.map(_=>({width:_+s.Q6.Cuatro})),["A1","B1","C1","D1","E1","F1"].forEach(_=>{c[_]&&(c[_].s={fill:{fgColor:{rgb:"4f46e5"}},font:{bold:!0,color:{rgb:"ffffff"}},alignment:{horizontal:"center",vertical:"center"},border:{bottom:{style:"thin",color:{rgb:"000000"}}}})}),Object.keys(c).forEach(_=>{const U=parseInt(_.substring(1),10);!isNaN(U)&&U>1&&(c[_].s={alignment:{horizontal:"center",vertical:"center"}})});const P=E.utils.book_new();E.utils.book_append_sheet(P,c,a),E.writeFile(P,r)}obtenerRequest(){const t=new tt;return t.destinationTimeZoneId=this._toolService.getTimeZone(),t.idUsuario=this.decodeToken.idUsuario,t.lstUsuario=[],t.lstProveedores=[],t.numeroCompra=this.filtroCompraForm.get("numeroCompra").value||null,t.fechaCompraInicio=this.filtroCompraForm.get("fechaCompraInicio").value||null,t.fechaCompraFin=this.filtroCompraForm.get("fechaCompraFin").value||null,t.montoCompraInicio=this.filtroCompraForm.get("montoCompraInicio").value||null,t.montoCompraFin=this.filtroCompraForm.get("montoCompraFin").value||null,this.selectUsuarioItem&&this.selectUsuarioItem.options.filter(a=>a.selected&&0!=a.value).forEach(a=>t.lstUsuario?.push(a.value.correoElectronico)),t}obtenerInfouserInfoLogueado(){return this._securityService.getDecodetoken()}obtenerInfoMoneda(){return this._securityService.getMonedaStorage()}trackByFn(t,r){return r.id||t}onPageChange(t){const r=t.pageIndex*t.pageSize;let a=r+t.pageSize;a>this.allHistorialCompraDataSource.data.length&&(a=this.allHistorialCompraDataSource.data.length),this.pageSlice.data=this.allHistorialCompraDataSource.data.slice(r,a)}setPageSlice(t){this.pageSlice.data=t.slice(s.Q6.Cero,s.Q6.Cinco),this._paginator&&(this._paginator.pageIndex=s.Q6.Cero,this._paginator.pageSize=s.Q6.Cinco)}isMobilSize(){return this._toolService.isMobilSize()}closedDrawer(){this.matDrawer.close()}getSkeletonCount(){this.skeletonNumber=0===this.allHistorialCompraDataSource.data.length?s.Q6.Ocho:this.allHistorialCompraDataSource.data.length+s.Q6.Uno}showSkeleton(){this.skeleton=s.vU.Show}hideSkeleton(){this.skeleton=s.vU.Hide}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(G.uw),e.Y36(W.R),e.Y36(d.QS),e.Y36(R.I),e.Y36(ee),e.Y36(St),e.Y36(y.o))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-historial-compras-page"]],viewQuery:function(r,a){if(1&r&&(e.Gf(yt,5),e.Gf(w.NW,5),e.Gf(Dt,5,F.YE),e.Gf(Ut,5)),2&r){let n;e.iGM(n=e.CRH())&&(a.selectUsuarioItem=n.first),e.iGM(n=e.CRH())&&(a._paginator=n.first),e.iGM(n=e.CRH())&&(a.historialCompraTableMatSort=n.first),e.iGM(n=e.CRH())&&(a.matDrawer=n.first)}},features:[e._Bn([{provide:w.ye,useClass:et}])],decls:74,vars:33,consts:[[1,"flex-auto","h-full"],["autoFocus","false",1,"w-90",3,"mode"],["matDrawer",""],[1,"flex","items-center","justify-between","m-4","mr-3","sm:my-5"],[1,"text-3xl","font-semibold","tracking-tight","leading-8"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"flex","flex-col","flex-auto","h-full","dark:bg-default"],[1,"flex","flex-col","flex-auto","shrink-0","pt-6","bg-card","dark:bg-transparent"],[1,"flex","flex-col","px-6",3,"formGroup"],[1,"w-full",3,"appearance"],["multiple","",3,"formControlName"],["selectUsuarioItem",""],[4,"ngIf"],[3,"model","values"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","numeroCompra","maxlength","50","autocomplete","off"],["autocomplete","off","matInput","",3,"min","max","matDatepicker","formControlName","click"],["matSuffix","",3,"for"],["pickerInicio",""],["pickerFin",""],["autocomplete","off","matInput","","appTwoDigitDecimaNumber","","formControlName","montoCompraInicio"],["autocomplete","off","matInput","","appTwoDigitDecimaNumber","","formControlName","montoCompraFin"],["mat-flat-button","",1,"mt-4","mb-8",3,"color","disabled","click"],["class","icon-size-2",3,"svgIcon",4,"ngIf"],["class","ml-2",4,"ngIf"],[3,"diameter","mode",4,"ngIf"],[1,"flex","flex-col"],[1,"flex","flex-col","flex-auto","w-full"],[1,"flex","flex-wrap","w-full","max-w-screen-xl","mx-auto","p-6","md:p-8"],[1,"flex","items-center","justify-between","w-full"],[1,"flex-1","min-w-0"],[1,"mt-2"],[1,"text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-8"],[1,"flex","flex-wrap","items-center","font-medium"],[1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"flex","items-center","ml-6"],[1,"w-full"],["class","skeleton-default  bg-card shadow rounded-2xl overflow-hidden ",4,"ngIf"],[1,"grid","grid-cols-1","xl:grid-cols-1","gap-8","w-full","mt-6"],["class","xl:col-span-1 flex flex-col flex-auto bg-card shadow rounded-2xl overflow-hidden",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"value"],[1,"icon-size-2",3,"svgIcon"],[1,"ml-2"],[3,"diameter","mode"],["mat-icon-button","",3,"matMenuTriggerFor"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"ml-1"],["mat-flat-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"color","click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"click"],[1,"skeleton-default","bg-card","shadow","rounded-2xl","overflow-hidden"],[3,"count","theme"],[1,"xl:col-span-1","flex","flex-col","flex-auto","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"overflow-x-auto","mx-6"],["mat-table","","matSort","",1,"w-full","bg-transparent","mb-3",3,"dataSource","trackBy"],["historialCompraTable",""],["matColumnDef","numeroCompra"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","min-w-40",4,"matCellDef"],["matColumnDef","nombreProveedor",1,"min-w-50"],["mat-cell","",4,"matCellDef"],["matColumnDef","correoUsuario"],["matColumnDef","fechaCompra"],["mat-cell","","style","min-width: 180px",4,"matCellDef"],["matColumnDef","totalCompra"],["mat-header-cell","","mat-sort-header","","class","min-w-10",4,"matHeaderCellDef"],["matColumnDef","estado"],["mat-cell","","class","min-w-10 text-center",4,"matCellDef"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","paginator",4,"ngIf"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"min-w-40"],[1,"flex","items-center"],[1,"ml-3","leading-4"],["mat-cell",""],[1,"pr-6","whitespace-nowrap"],[1,"text-blue-500","hover:underline",3,"href"],["mat-cell","",2,"min-width","180px"],["mat-header-cell","","mat-sort-header","",1,"min-w-10"],[1,"pr-6","w-auto","h-auto","rounded-full",2,"color","#056DB6"],["mat-cell","",1,"min-w-10","text-center"],[1,"inline-flex","items-center","font-bold","text-xs","px-2.5","py-0.5","rounded-full","tracking-wide","uppercase",3,"ngClass"],[1,"leading-relaxed","whitespace-nowrap"],["mat-icon-button","",3,"matMenuTriggerFor","disabled"],["menu","matMenu"],["svgIcon","feather:eye"],["mat-menu-item","",3,"click",4,"ngIf"],["svgIcon","feather:trash-2"],["mat-header-row",""],["mat-row",""],[1,"paginator"],["aria-label","Seleccione p\xe1gina",3,"length","pageSize","pageSizeOptions","page"],["paginator",""],["alt","No hay datos disponibles",1,"w-72","mx-auto","mt-2",3,"src"],[1,"mt-4","sm:mt-8","text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-tight","md:leading-none","text-center"],[1,"mt-2","text-gray-500","text-center"]],template:function(r,a){if(1&r){const n=e.EpF();e.TgZ(0,"mat-drawer-container",0)(1,"mat-drawer",1,2)(3,"div",3)(4,"div",4),e._uU(5,"Filtrar por:"),e.qZA(),e.TgZ(6,"div")(7,"button",5),e.NdJ("click",function(){e.CHM(n);const c=e.MAs(2);return e.KtG(c.close())}),e._UZ(8,"mat-icon",6),e.qZA()()(),e.TgZ(9,"div",7)(10,"div",8)(11,"form",9)(12,"mat-form-field",10)(13,"mat-label"),e._uU(14,"Usuarios"),e.qZA(),e.TgZ(15,"mat-select",11,12)(17,"mat-select-trigger"),e.YNc(18,Mt,2,1,"ng-container",13),e.qZA(),e._UZ(19,"app-selectAll",14),e.YNc(20,Rt,2,2,"mat-option",15),e.qZA()(),e.TgZ(21,"mat-form-field",10)(22,"mat-label"),e._uU(23,"N\xfamero de Compra"),e.qZA(),e._UZ(24,"input",16),e.qZA(),e.TgZ(25,"mat-form-field",10)(26,"mat-label"),e._uU(27,"Fecha Compra Inicio"),e.qZA(),e.TgZ(28,"input",17),e.NdJ("click",function(){e.CHM(n);const c=e.MAs(31);return e.KtG(c.open())}),e.qZA(),e._UZ(29,"mat-datepicker-toggle",18)(30,"mat-datepicker",null,19),e.qZA(),e.TgZ(32,"mat-form-field",10)(33,"mat-label"),e._uU(34,"Fecha Compra Fin"),e.qZA(),e.TgZ(35,"input",17),e.NdJ("click",function(){e.CHM(n);const c=e.MAs(38);return e.KtG(c.open())}),e.qZA(),e._UZ(36,"mat-datepicker-toggle",18)(37,"mat-datepicker",null,20),e.qZA(),e.TgZ(39,"mat-form-field",10)(40,"mat-label"),e._uU(41,"Monto Compra Inicio"),e.qZA(),e._UZ(42,"input",21),e.qZA(),e.TgZ(43,"mat-form-field",10)(44,"mat-label"),e._uU(45,"Monto Compra Fin"),e.qZA(),e._UZ(46,"input",22),e.qZA(),e.TgZ(47,"button",23),e.NdJ("click",function(){return a.btnBuscar()}),e.YNc(48,qt,1,1,"mat-icon",24)(49,Jt,2,0,"span",25)(50,Qt,1,2,"mat-progress-spinner",26),e.qZA()()()()(),e.TgZ(51,"mat-drawer-content",27)(52,"div",28)(53,"div",29)(54,"div",30)(55,"div",31)(56,"div",32)(57,"h2",33),e._uU(58,"Historial "),e.qZA()(),e.TgZ(59,"div",34)(60,"div")(61,"a",35),e._uU(62,"Compras"),e.qZA()(),e.TgZ(63,"div",36),e._UZ(64,"mat-icon",37),e.TgZ(65,"a",38),e._uU(66,"Historial"),e.qZA()()()(),e.TgZ(67,"div",39),e.YNc(68,Vt,12,4)(69,Et,8,4),e.qZA()(),e.TgZ(70,"div",40),e.YNc(71,zt,2,3,"div",41),e.TgZ(72,"div",42),e.YNc(73,po,29,6,"div",43),e.qZA()()()()()()}if(2&r){const n=e.MAs(16),l=e.MAs(31),c=e.MAs(38);e.xp6(1),e.Q6J("mode","over"),e.xp6(7),e.Q6J("svgIcon","heroicons_outline:x-mark"),e.xp6(3),e.Q6J("formGroup",a.filtroCompraForm),e.xp6(1),e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("formControlName","usuarios"),e.xp6(3),e.Q6J("ngIf",(null==n.value?null:n.value.length)>0),e.xp6(1),e.Q6J("model",a.filtroCompraForm.get("usuarios"))("values",a.allUsuarioSource),e.xp6(1),e.Q6J("ngForOf",a.allUsuarioSource),e.xp6(1),e.Q6J("appearance","outline"),e.xp6(4),e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",l)("formControlName","fechaCompraInicio"),e.xp6(1),e.Q6J("for",l),e.xp6(3),e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",c)("formControlName","fechaCompraFin"),e.xp6(1),e.Q6J("for",c),e.xp6(3),e.Q6J("appearance","outline"),e.xp6(4),e.Q6J("appearance","outline"),e.xp6(4),e.Q6J("color","primary")("disabled",a.filtroCompraForm.invalid||a.disabledBuscar),e.xp6(1),e.Q6J("ngIf",!a.disabledBuscar),e.xp6(1),e.Q6J("ngIf",!a.disabledBuscar),e.xp6(1),e.Q6J("ngIf",a.disabledBuscar),e.xp6(14),e.Q6J("svgIcon","heroicons_mini:chevron-right"),e.xp6(4),e.um2(68,a.isMobilSize()?68:69),e.xp6(3),e.Q6J("ngIf",a.skeleton),e.xp6(2),e.Q6J("ngIf",!a.skeleton)}},dependencies:[g.mk,g.sg,g.O5,N.K,Pt.f,d._Y,d.Fj,d.JJ,d.JL,d.nD,d.sg,d.u,q.Nt,f.KE,f.hX,f.R9,v.VK,v.OP,v.p6,S.gD,S.$L,I.ey,J.Ou,b.jA,b.kh,b.LW,Z.lW,Z.RK,D.Hw,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,w.NW,F.YE,F.nU,T.Mq,T.hl,T.nW,z.xr,g.i8,g.H9,g.uU]})}return o})();var uo=m(2993),ne=m(3362),se=m(2025),O=m(8358),Y=m(6903);const go=["selectCategoriaItem"],ho=["matDrawer"];function fo(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Fecha Venta inicio es requerido"),e.qZA())}function _o(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Fecha Venta fin es requerido"),e.qZA())}function xo(o,i){1&o&&(e.ynx(0),e._uU(1,", "),e.BQk())}function Co(o,i){if(1&o&&(e.TgZ(0,"span"),e._UZ(1,"span",35),e._uU(2),e.YNc(3,xo,2,0,"ng-container",14),e.qZA()),2&o){const t=i.$implicit,r=i.index;e.oxw(2);const a=e.MAs(32);e.xp6(1),e.Udp("background-color",null==t?null:t.color),e.xp6(1),e.hij(" ",t.nombre||"",""),e.xp6(1),e.Q6J("ngIf",r<a.value.length-1)}}function vo(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Co,4,4,"span",34),e.BQk()),2&o){e.oxw();const t=e.MAs(32);e.xp6(1),e.Q6J("ngForOf",t.value)}}function bo(o,i){if(1&o&&(e.TgZ(0,"mat-option",36),e._UZ(1,"span",35),e._uU(2),e.qZA()),2&o){const t=i.$implicit;e.Q6J("value",t),e.xp6(1),e.Udp("background-color",t.color),e.xp6(1),e.hij(" ",t.nombre,"")}}function To(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Categor\xeda es requerido"),e.qZA())}function Zo(o,i){1&o&&e._UZ(0,"mat-icon",37),2&o&&e.Q6J("svgIcon","heroicons_solid:magnifying-glass")}function Ao(o,i){1&o&&(e.TgZ(0,"span",38),e._uU(1,"Buscar"),e.qZA())}function Fo(o,i){1&o&&e._UZ(0,"mat-progress-spinner",39),2&o&&e.Q6J("diameter",24)("mode","indeterminate")}function wo(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",40),e._UZ(1,"mat-icon",6),e.qZA(),e.TgZ(2,"mat-menu",null,41)(4,"button",42),e.NdJ("click",function(){e.CHM(t),e.oxw();const a=e.MAs(2);return e.KtG(a.open())}),e._UZ(5,"mat-icon",6),e.TgZ(6,"span",43),e._uU(7,"Filtrar"),e.qZA()(),e.TgZ(8,"button",44),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.getReportePorCategoriaAsync())}),e._UZ(9,"mat-icon",6),e.TgZ(10,"span",43),e._uU(11,"Exportar"),e.qZA()()()}if(2&o){const t=e.MAs(3),r=e.oxw();e.Q6J("matMenuTriggerFor",t),e.xp6(1),e.Q6J("svgIcon","heroicons_mini:ellipsis-vertical"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:adjustments-horizontal"),e.xp6(3),e.Q6J("disabled",r.filtroAnalisisVentasForm.invalid||r.isExportingReport||r.disabledExportar),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:arrow-up-tray")}}function So(o,i){1&o&&e._UZ(0,"mat-icon",46),2&o&&e.Q6J("svgIcon","heroicons_solid:arrow-up-tray")}function Po(o,i){1&o&&(e.TgZ(0,"span",38),e._uU(1,"Exportar"),e.qZA())}function yo(o,i){1&o&&e._UZ(0,"mat-progress-spinner",39),2&o&&e.Q6J("diameter",24)("mode","indeterminate")}function Do(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(t),e.oxw();const a=e.MAs(2);return e.KtG(a.open())}),e._UZ(1,"mat-icon",46),e.TgZ(2,"span",38),e._uU(3,"Filtrar"),e.qZA()(),e.TgZ(4,"button",47),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.getReportePorCategoriaAsync())}),e.YNc(5,So,1,1,"mat-icon",48)(6,Po,2,0,"span",22)(7,yo,1,2,"mat-progress-spinner",23),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("svgIcon","heroicons_solid:adjustments-horizontal"),e.xp6(3),e.Q6J("color","primary")("disabled",t.filtroAnalisisVentasForm.invalid||t.isExportingReport||t.disabledExportar),e.xp6(1),e.Q6J("ngIf",!t.isExportingReport),e.xp6(1),e.Q6J("ngIf",!t.isExportingReport),e.xp6(1),e.Q6J("ngIf",t.isExportingReport)}}const Uo=()=>({"border-radius":"0",height:"50px"});function Io(o,i){1&o&&e._UZ(0,"ngx-skeleton-loader",49),2&o&&e.Q6J("theme",e.DdM(1,Uo))}function ko(o,i){if(1&o&&(e.TgZ(0,"div",52)(1,"div",53)(2,"div",54)(3,"div",55),e._UZ(4,"img",56),e.TgZ(5,"div",57),e._uU(6),e.qZA(),e.TgZ(7,"div")(8,"p",58),e._uU(9,"Aplique otros filtros de b\xfasqueda "),e.qZA()()()()()()),2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("src",t.imgNoDataHome,e.LSH),e.xp6(2),e.hij(" ",t.textoResultado,"")}}function Mo(o,i){if(1&o&&(e.TgZ(0,"div",59)(1,"div",60)(2,"div",61),e._uU(3,"Evoluci\xf3n por Categorias y Fechas"),e.qZA()(),e.TgZ(4,"div",53)(5,"div",54)(6,"div",54),e._UZ(7,"apx-chart",62),e.qZA()()()(),e.TgZ(8,"div",63)(9,"div",60)(10,"div",64),e._uU(11," Totalizado por Categor\xeda "),e.qZA(),e._UZ(12,"button",65),e.qZA(),e.TgZ(13,"div",54),e._UZ(14,"apx-chart",66),e.qZA()(),e.TgZ(15,"div",63)(16,"div",60)(17,"div",64),e._uU(18," Categor\xedas Destacadas "),e.qZA()(),e.TgZ(19,"div",54),e._UZ(20,"apx-chart",67),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(7),e.Q6J("plotOptions",t.chartEvolucionVentasCategoriaFecha.plotOptions)("series",t.chartEvolucionVentasCategoriaFecha.series)("chart",t.chartEvolucionVentasCategoriaFecha.chart)("xaxis",t.chartEvolucionVentasCategoriaFecha.xaxis)("yaxis",t.chartEvolucionVentasCategoriaFecha.yaxis)("tooltip",t.chartEvolucionVentasCategoriaFecha.tooltip)("dataLabels",t.chartEvolucionVentasCategoriaFecha.dataLabels)("labels",t.chartEvolucionVentasCategoriaFecha.labels)("noData",t.chartEvolucionVentasCategoriaFecha.noData)("grid",t.chartEvolucionVentasCategoriaFecha.grid),e.xp6(7),e.Q6J("series",t.chartTotalizadoCategoria.series)("chart",t.chartTotalizadoCategoria.chart)("labels",t.chartTotalizadoCategoria.labels)("responsive",t.chartTotalizadoCategoria.responsive)("noData",t.chartTotalizadoCategoria.noData)("colors",t.chartTotalizadoCategoria.colors)("tooltip",t.chartTotalizadoCategoria.tooltip)("dataLabels",t.chartTotalizadoCategoria.dataLabels)("plotOptions",t.chartTotalizadoCategoria.plotOptions),e.xp6(6),e.Q6J("series",t.chartTopDiezCategorias.series)("chart",t.chartTopDiezCategorias.chart)("colors",t.chartTopDiezCategorias.colors)("dataLabels",t.chartTopDiezCategorias.dataLabels)("plotOptions",t.chartTopDiezCategorias.plotOptions)("tooltip",t.chartTopDiezCategorias.tooltip)("noData",t.chartTopDiezCategorias.noData)("xaxis",t.chartTopDiezCategorias.xaxis)}}function Ro(o,i){if(1&o&&(e.TgZ(0,"div",50),e.YNc(1,ko,10,2,"div",51)(2,Mo,21,27),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.um2(1,0==t.ventasAnalisisDataSource.distribucionVentasCategoria.totalVentasCategorias.length?1:2)}}let le=(()=>{class o{constructor(t,r,a,n,l){this._securityService=t,this._formBuilder=r,this._toolService=a,this._detalleVentasService=n,this._inventarioService=l,this.disabledExportar=s.vU.False,this.decodeToken=this.obtenerInfouserInfoLogueado(),this.monedaInfo=this.obtenerInfoMoneda(),this.isExportingReport=s.vU.False,this.chartEvolucionVentasCategoriaFecha={},this.chartTotalizadoCategoria={},this.chartTopDiezCategorias={},this.chartEvolucionVentasFecha={},this.disabledBuscar=s.vU.False,this._unsubscribeAll=new k.x,this.skeleton=s.vU.False,this.minDate=this._toolService.getMinDateFIlter(),this.maxDate=this._toolService.getMaxDateFIlter(),this.imgNoDataHome=s.HZ.noDataHome,this.textoResultado=s.RO.NoDataResult,this.filtroRangoFecha=""}ngOnInit(){this.formFiltros(),this.showSkeleton(),this.getResumen(s.vU.False),this.getFilterComboConsulta()}formFiltros(){this.filtroAnalisisVentasForm=this._formBuilder.group({fechaVentaInicio:[this._toolService.getStartDateOfMonth(),[d.kI.required]],fechaVentaFin:[this._toolService.getEndDateOfMonth(),[d.kI.required]],categoria:[""]}),this.currencyNumberFormat=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda)}getFilterComboConsulta(){const t=new ne.Z;t.nombre="",t.idUsuario=this.decodeToken.idUsuario;const r=new uo.l;r.nombre="",r.idUsuario=this.decodeToken.idUsuario,(0,V.D)({dataCategorias:this._inventarioService.GetAllCategoriaByFilterAsync(r),dataMarcas:this._inventarioService.GetAllMarcaByFilterAsync(t)}).subscribe({next:a=>{this.allCategoriaDataSource=a.dataCategorias,this.allMarcasDataSource=a.dataMarcas,this.filtroAnalisisVentasForm.get("categoria")?.setValue(this.allCategoriaDataSource),this.filtroAnalisisVentasForm.get("marca")?.setValue(this.allMarcasDataSource)},error:a=>{this._toolService.showError(p.J.Transaction,p.J.Tittle),this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.True,console.log(a)}})}getResumen(t){this.showSkeleton();const r=this.obtenerRequest();this.disabledBuscar=s.vU.True,this._detalleVentasService.GetAnalisisCategoriasByFilterAsync(r).subscribe(a=>{this.ventasAnalisisDataSource=a,this.disabledBuscar=s.vU.False,this.getFechaFiltroCadena(),this.generateCharts(),t&&this.closedDrawer(),this.hideSkeleton(),this.disabledExportar=a.distribucionVentasCategoria.totalVentasCategorias.length>s.Q6.Cero?s.vU.False:s.vU.True},a=>{this._toolService.showError(p.J.Transaction,p.J.Tittle),this.disabledBuscar=s.vU.False,console.log(a),t&&this.closedDrawer()})}generateCharts(){this.rangoFecha=this.getRangeDate(),this.generarchartEvolucionVentasCategoriaFecha(),this.generarchartTotalizadoCategorias(),this.generarChartTopDiezCategorias(),this.generarChartEvolucionFecha()}generarchartEvolucionVentasCategoriaFecha(){const t=this.ventasAnalisisDataSource.lstEvolucionVentasCategoriaFecha.map(r=>({color:r.colorCategoria,name:r.nombreCategoria,data:this.rangoFecha.map(a=>{const n=r.datosVentasAgrupados.find(l=>this._toolService.formatoFecha(l.fechaVenta)===a);return n?n.montoVentaTotal:s.Q6.Cero})}));this.chartEvolucionVentasCategoriaFecha={series:t,chart:{type:"bar",height:350,stacked:!0,toolbar:{show:!1}},noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},plotOptions:{bar:{horizontal:!1,columnWidth:"55%"}},dataLabels:{enabled:!1,style:{fontSize:"12px"}},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:this.rangoFecha,labels:{rotateAlways:!0,rotate:-45}},yaxis:{labels:{formatter:r=>this.currencyNumberFormat.format(r),style:{fontSize:"12px"}}},fill:{opacity:1},tooltip:{enabled:!0,y:{formatter:r=>this.currencyNumberFormat.format(r)}}}}generarchartTotalizadoCategorias(){const t=this.isMobilSize(),r=this.ventasAnalisisDataSource.distribucionVentasCategoria.totalVentasCategorias.reduce((a,n)=>a+n,0);this.chartTotalizadoCategoria={chart:{type:"donut",fontFamily:"inherit",foreColor:"inherit",height:"95%"},responsive:[{breakpoint:600,options:{chart:{width:"100%",height:350},legend:{position:"bottom"}}}],labels:this.ventasAnalisisDataSource.distribucionVentasCategoria.nombreCategorias,series:this.ventasAnalisisDataSource.distribucionVentasCategoria.totalVentasCategorias,noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},colors:this.ventasAnalisisDataSource.distribucionVentasCategoria.coloresCategorias,tooltip:{enabled:!0,y:{formatter:a=>this.currencyNumberFormat.format(a)}},dataLabels:{enabled:!0},plotOptions:{pie:{donut:{labels:{show:!0,name:{show:!1},value:{show:!0,fontSize:t?"19px":"22px",color:"#494949",offsetY:0,formatter:()=>this.currencyNumberFormat.format(r)},total:{show:!0,showAlways:!0,label:"",fontSize:t?"19px":"22px",color:"#494949",formatter:()=>this.currencyNumberFormat.format(r)}}}}}}}generarChartTopDiezCategorias(){const t=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda);this.chartTopDiezCategorias={series:[{name:"Total",data:this.ventasAnalisisDataSource.topDiezCategoriasVentas.totalMontos}],noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},colors:this.ventasAnalisisDataSource.topDiezCategoriasVentas.colores,chart:{type:"bar",height:350,toolbar:{show:!1}},plotOptions:{bar:{barHeight:"100%",distributed:!0,horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,textAnchor:"middle",formatter:function(r){return t.format(r)},offsetY:-6,style:{colors:["#FFFFFF"],fontSize:"12px",fontWeight:"bold"},dropShadow:{enabled:!0,top:1,left:1,blur:2,color:"#000000",opacity:.5}},stroke:{width:1,colors:["#fff"]},tooltip:{enabled:!0,y:{formatter:r=>t.format(r)}},xaxis:{categories:this.ventasAnalisisDataSource.topDiezCategoriasVentas.categorias,labels:{show:!1,style:{fontSize:"12px"},formatter:function(r){return"number"==typeof r?t.format(r):r}}}}}generarChartEvolucionFecha(){const t=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda);this.chartEvolucionVentasFecha={series:[{color:"#056DB6",name:"Total",data:this.ventasAnalisisDataSource.evolucionVentasFecha.totalVenta}],noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},chart:{height:350,type:"line",zoom:{enabled:!1},toolbar:{show:!1}},dataLabels:{enabled:!0,textAnchor:"start",formatter:function(r){return t.format(r)},offsetX:0,dropShadow:{enabled:!0}},stroke:{show:!0,width:2,colors:["transparent"]},tooltip:{enabled:!0,y:{formatter:r=>t.format(r)}},yaxis:{labels:{formatter:r=>this.currencyNumberFormat.format(r),style:{fontSize:"12px"}}},xaxis:{categories:this.rangoFecha,labels:{show:!0,style:{fontSize:"12px"},formatter:function(r){return"number"==typeof r?t.format(r):r},rotateAlways:!0,rotate:-45}},fill:{opacity:1}}}getReportePorCategoriaAsync(){if(this.ventasAnalisisDataSource.distribucionVentasCategoria.totalVentasCategorias.length==s.Q6.Cero&&this.ventasAnalisisDataSource.distribucionVentasCategoria.totalVentasCategorias.length==s.Q6.Cero||this.filtroAnalisisVentasForm.invalid)return;const t=this.obtenerRequestReporte();this.isExportingReport=s.vU.True,this._detalleVentasService.GetReportePorCategoriasAsync(t).subscribe(r=>{if(this.isExportingReport=s.vU.False,r){const a=window.URL.createObjectURL(new Blob([r],{type:"application/vnd.ms-excel"})),n=document.createElement("a");n.download=`Reporte_Venta_Por_Categorias_${this.getFechaFiltroCadenaReporte()}.xlsx`,n.href=a,n.click(),n.parentNode?.removeChild(n)}},r=>{if(r.status==s.GL.Forbidden)return this._toolService.showWarning(p.T.InvalidPermisos,p.T.Tittle),this.isExportingReport=s.vU.False=s.vU.False,void console.log(r);this._toolService.showError(p.J.Transaction,p.J.Tittle),this.isExportingReport=s.vU.False,console.log(r)})}getFechaFiltroCadenaReporte(){return`del_${this._toolService.formatoFecha(this.fechaInicio)}_hasta_${this._toolService.formatoFecha(this.fechaFin)}`.trim()}getRangeDate(){return this.ventasAnalisisDataSource.evolucionVentasFecha.fechaVenta.map(t=>this._toolService.formatoFecha(t))}isMobilSize(){return this._toolService.isMobilSize()}obtenerRequest(){const t=new se.I;return t.destinationTimeZoneId=this._toolService.getTimeZone(),t.idUsuario=this.decodeToken.idUsuario,t.fechaVentaInicio=""==this.filtroAnalisisVentasForm.get("fechaVentaInicio").value?null:this.filtroAnalisisVentasForm.get("fechaVentaInicio").value,t.fechaVentaFin=""==this.filtroAnalisisVentasForm.get("fechaVentaFin").value?null:this.filtroAnalisisVentasForm.get("fechaVentaFin").value,t.lstCategorias=[],this.selectCategorias&&this.selectCategorias.options.filter(a=>1==a.selected&&0!=a.value).forEach(a=>{t.lstCategorias?.push(a.value.id)}),this.fechaInicio=t.fechaVentaInicio,this.fechaFin=t.fechaVentaFin,t}obtenerRequestReporte(){const t=new se.I;return t.destinationTimeZoneId=this._toolService.getTimeZone(),t.idUsuario=this.decodeToken.idUsuario,t.fechaVentaInicio=""==this.filtroAnalisisVentasForm.get("fechaVentaInicio").value?null:this.filtroAnalisisVentasForm.get("fechaVentaInicio").value,t.fechaVentaFin=""==this.filtroAnalisisVentasForm.get("fechaVentaFin").value?null:this.filtroAnalisisVentasForm.get("fechaVentaFin").value,t.lstCategorias=[],this.fechaInicio=t.fechaVentaInicio,this.fechaFin=t.fechaVentaFin,this.selectCategorias&&this.selectCategorias.options.filter(a=>1==a.selected&&0!=a.value).forEach(a=>{t.lstCategorias?.push(a.value.id)}),t}getFechaFiltroCadena(){const t=this._toolService.formatoFecha(this.fechaInicio),r=this._toolService.formatoFecha(this.fechaFin);this.filtroRangoFecha=`Desde ${t} Hasta ${r}`.trim()}obtenerInfouserInfoLogueado(){return this._securityService.getDecodetoken()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closedDrawer(){this.matDrawer.close()}showSkeleton(){this.skeleton=s.vU.Show}hideSkeleton(){this.skeleton=s.vU.Hide}obtenerInfoMoneda(){return this._securityService.getMonedaStorage()}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(R.I),e.Y36(d.QS),e.Y36(y.o),e.Y36(O.n),e.Y36(Q.I))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-reporte-ventas-categorias-page"]],viewQuery:function(r,a){if(1&r&&(e.Gf(go,5),e.Gf(ho,5)),2&r){let n;e.iGM(n=e.CRH())&&(a.selectCategorias=n.first),e.iGM(n=e.CRH())&&(a.matDrawer=n.first)}},decls:57,vars:33,consts:[[1,"flex-auto","h-full"],["autoFocus","false",1,"w-90",3,"mode"],["matDrawer",""],[1,"flex","items-center","justify-between","m-4","mr-3","sm:my-5"],[1,"text-3xl","font-semibold","tracking-tight","leading-8"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"flex","flex-col","flex-auto","h-full","dark:bg-default"],[1,"flex","flex-col","flex-auto","shrink-0","pt-6","bg-card","dark:bg-transparent"],[1,"flex","flex-col","px-6",3,"formGroup"],[1,"w-full",3,"appearance"],["autocomplete","off","matInput","",3,"min","max","matDatepicker","formControlName","click"],["matSuffix","",3,"for"],["pickerInicio",""],[4,"ngIf"],["pickerFin",""],["multiple","",3,"formControlName"],["selectCategoriaItem",""],[3,"model","values"],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","",1,"mt-4","mb-8",3,"color","disabled","click"],["class","icon-size-2",3,"svgIcon",4,"ngIf"],["class","ml-2",4,"ngIf"],[3,"diameter","mode",4,"ngIf"],[1,"flex","flex-col"],[1,"flex","flex-col","flex-auto","w-full"],[1,"flex","flex-wrap","w-full","max-w-screen-xl","mx-auto","p-6","md:p-8"],[1,"flex","items-center","justify-between","w-full"],[1,"text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-8"],[1,"font-medium","tracking-tight","text-secondary"],[1,"flex","items-center","ml-6"],[1,"grid","grid-cols-1","xl:grid-cols-1","gap-8","w-full","mt-6"],["class"," sm:col-span-2 md:col-span-4 flex flex-col flex-auto p-6 bg-card shadow rounded-2xl overflow-hidden","count","40",3,"theme",4,"ngIf"],["class","grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 w-full min-w-0",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"color-indicator"],[3,"value"],[1,"icon-size-2",3,"svgIcon"],[1,"ml-2"],[3,"diameter","mode"],["mat-icon-button","",3,"matMenuTriggerFor"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"ml-1"],["mat-menu-item","",3,"disabled","click"],["mat-stroked-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-flat-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"color","disabled","click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],["count","40",1,"sm:col-span-2","md:col-span-4","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden",3,"theme"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-4","gap-6","w-full","min-w-0"],["class","sm:col-span-2 md:col-span-4 flex flex-col    overflow-hidden"],[1,"sm:col-span-2","md:col-span-4","flex","flex-col","overflow-hidden"],[1,"grid","grid-cols-1","lg:grid-cols-1","grid-flow-row","gap-6","w-full","mt-8","sm:mt-4"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","items-center"],["alt","No hay datos disponibles",1,"w-72","object-cover",3,"src"],[1,"mt-4","sm:mt-8","text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-tight","md:leading-none","text-center"],[1,"mt-2","text-gray-500","text-center"],[1,"sm:col-span-2","md:col-span-4","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"flex","justify-between","items-center"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate"],[3,"plotOptions","series","chart","xaxis","yaxis","tooltip","dataLabels","labels","noData","grid"],[1,"sm:col-span-2","lg:col-span-2","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate","text-black"],["mat-icon-button","","color","primary"],[1,"flex-auto","w-full","h-80",3,"series","chart","labels","responsive","noData","colors","tooltip","dataLabels","plotOptions"],[3,"series","chart","colors","dataLabels","plotOptions","tooltip","noData","xaxis"]],template:function(r,a){if(1&r){const n=e.EpF();e.TgZ(0,"mat-drawer-container",0)(1,"mat-drawer",1,2)(3,"div",3)(4,"div",4),e._uU(5,"Filtrar por:"),e.qZA(),e.TgZ(6,"div")(7,"button",5),e.NdJ("click",function(){e.CHM(n);const c=e.MAs(2);return e.KtG(c.close())}),e._UZ(8,"mat-icon",6),e.qZA()()(),e.TgZ(9,"div",7)(10,"div",8)(11,"form",9)(12,"mat-form-field",10)(13,"mat-label"),e._uU(14,"Fecha Venta Inicio"),e.qZA(),e.TgZ(15,"input",11),e.NdJ("click",function(){e.CHM(n);const c=e.MAs(18);return e.KtG(c.open())}),e.qZA(),e._UZ(16,"mat-datepicker-toggle",12)(17,"mat-datepicker",null,13),e.YNc(19,fo,2,0,"mat-error",14),e.qZA(),e.TgZ(20,"mat-form-field",10)(21,"mat-label"),e._uU(22,"Fecha Venta Fin"),e.qZA(),e.TgZ(23,"input",11),e.NdJ("click",function(){e.CHM(n);const c=e.MAs(26);return e.KtG(c.open())}),e.qZA(),e._UZ(24,"mat-datepicker-toggle",12)(25,"mat-datepicker",null,15),e.YNc(27,_o,2,0,"mat-error",14),e.qZA(),e.TgZ(28,"mat-form-field",10)(29,"mat-label"),e._uU(30,"Categor\xedas"),e.qZA(),e.TgZ(31,"mat-select",16,17)(33,"mat-select-trigger"),e.YNc(34,vo,2,1,"ng-container",14),e.qZA(),e._UZ(35,"app-selectAll",18),e.YNc(36,bo,3,4,"mat-option",19),e.qZA(),e.YNc(37,To,2,0,"mat-error",14),e.qZA(),e.TgZ(38,"button",20),e.NdJ("click",function(){return a.getResumen(!0)}),e.YNc(39,Zo,1,1,"mat-icon",21)(40,Ao,2,0,"span",22)(41,Fo,1,2,"mat-progress-spinner",23),e.qZA()()()()(),e.TgZ(42,"mat-drawer-content",24)(43,"div",25)(44,"div",26)(45,"div",27)(46,"div")(47,"h2",28),e._uU(48,"Reporte de Ventas por Categor\xedas "),e.qZA(),e.TgZ(49,"div",29),e._uU(50),e.qZA()(),e.TgZ(51,"div",30),e.YNc(52,wo,12,5)(53,Do,8,6),e.qZA()(),e.TgZ(54,"div",31),e.YNc(55,Io,1,2,"ngx-skeleton-loader",32)(56,Ro,3,1,"div",33),e.qZA()()()()()}if(2&r){const n=e.MAs(18),l=e.MAs(26),c=e.MAs(32);e.xp6(1),e.Q6J("mode","over"),e.xp6(7),e.Q6J("svgIcon","heroicons_outline:x-mark"),e.xp6(3),e.Q6J("formGroup",a.filtroAnalisisVentasForm),e.xp6(1),e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",n)("formControlName","fechaVentaInicio"),e.xp6(1),e.Q6J("for",n),e.xp6(3),e.Q6J("ngIf",a.filtroAnalisisVentasForm.get("fechaVentaInicio").hasError("required")),e.xp6(1),e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",l)("formControlName","fechaVentaFin"),e.xp6(1),e.Q6J("for",l),e.xp6(3),e.Q6J("ngIf",a.filtroAnalisisVentasForm.get("fechaVentaFin").hasError("required")),e.xp6(1),e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("formControlName","categoria"),e.xp6(3),e.Q6J("ngIf",(null==c.value?null:c.value.length)>0),e.xp6(1),e.Q6J("model",a.filtroAnalisisVentasForm.get("categoria"))("values",a.allCategoriaDataSource),e.xp6(1),e.Q6J("ngForOf",a.allCategoriaDataSource),e.xp6(1),e.Q6J("ngIf",a.filtroAnalisisVentasForm.get("categoria").hasError("required")),e.xp6(1),e.Q6J("color","primary")("disabled",a.filtroAnalisisVentasForm.invalid||a.disabledBuscar),e.xp6(1),e.Q6J("ngIf",!a.disabledBuscar),e.xp6(1),e.Q6J("ngIf",!a.disabledBuscar),e.xp6(1),e.Q6J("ngIf",a.disabledBuscar),e.xp6(9),e.hij("",a.filtroRangoFecha," "),e.xp6(2),e.um2(52,a.isMobilSize()?52:53),e.xp6(3),e.Q6J("ngIf",a.skeleton),e.xp6(1),e.Q6J("ngIf",!a.skeleton)}},dependencies:[g.sg,g.O5,N.K,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,q.Nt,f.KE,f.hX,f.TO,f.R9,v.VK,v.OP,v.p6,S.gD,S.$L,I.ey,Y.x,J.Ou,b.jA,b.kh,b.LW,Z.lW,Z.RK,D.Hw,T.Mq,T.hl,T.nW,z.xr]})}return o})();var ce=m(8725);const qo=["selectMarcaItem"],Jo=["matDrawer"];function Qo(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Fecha Venta inicio es requerido"),e.qZA())}function Vo(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Fecha Venta fin es requerido"),e.qZA())}function Eo(o,i){1&o&&(e.ynx(0),e._uU(1,", "),e.BQk())}function No(o,i){if(1&o&&(e.TgZ(0,"span"),e._UZ(1,"span",35),e._uU(2),e.YNc(3,Eo,2,0,"ng-container",14),e.qZA()),2&o){const t=i.$implicit,r=i.index;e.oxw(2);const a=e.MAs(32);e.xp6(1),e.Udp("background-color",null==t?null:t.color),e.xp6(1),e.hij(" ",t.nombre||"",""),e.xp6(1),e.Q6J("ngIf",r<a.value.length-1)}}function zo(o,i){if(1&o&&(e.ynx(0),e.YNc(1,No,4,4,"span",34),e.BQk()),2&o){e.oxw();const t=e.MAs(32);e.xp6(1),e.Q6J("ngForOf",t.value)}}function Ho(o,i){if(1&o&&(e.TgZ(0,"mat-option",36),e._UZ(1,"span",35),e._uU(2),e.qZA()),2&o){const t=i.$implicit;e.Q6J("value",t),e.xp6(1),e.Udp("background-color",t.color),e.xp6(1),e.hij(" ",t.nombre,"")}}function Bo(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Marca es requerido"),e.qZA())}function Go(o,i){1&o&&e._UZ(0,"mat-icon",37),2&o&&e.Q6J("svgIcon","heroicons_solid:magnifying-glass")}function Oo(o,i){1&o&&(e.TgZ(0,"span",38),e._uU(1,"Buscar"),e.qZA())}function Yo(o,i){1&o&&e._UZ(0,"mat-progress-spinner",39),2&o&&e.Q6J("diameter",24)("mode","indeterminate")}function Lo(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",40),e._UZ(1,"mat-icon",6),e.qZA(),e.TgZ(2,"mat-menu",null,41)(4,"button",42),e.NdJ("click",function(){e.CHM(t),e.oxw();const a=e.MAs(2);return e.KtG(a.open())}),e._UZ(5,"mat-icon",6),e.TgZ(6,"span",43),e._uU(7,"Filtrar"),e.qZA()(),e.TgZ(8,"button",44),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.getReportePorMarcaAsync())}),e._UZ(9,"mat-icon",6),e.TgZ(10,"span",43),e._uU(11,"Exportar"),e.qZA()()()}if(2&o){const t=e.MAs(3),r=e.oxw();e.Q6J("matMenuTriggerFor",t),e.xp6(1),e.Q6J("svgIcon","heroicons_mini:ellipsis-vertical"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:adjustments-horizontal"),e.xp6(3),e.Q6J("disabled",r.filtroAnalisisVentasForm.invalid||r.isExportingReport||r.disabledExportar),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:arrow-up-tray")}}function jo(o,i){1&o&&e._UZ(0,"mat-icon",46),2&o&&e.Q6J("svgIcon","heroicons_solid:arrow-up-tray")}function $o(o,i){1&o&&(e.TgZ(0,"span",38),e._uU(1,"Exportar"),e.qZA())}function Ko(o,i){1&o&&e._UZ(0,"mat-progress-spinner",39),2&o&&e.Q6J("diameter",24)("mode","indeterminate")}function Wo(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(t),e.oxw();const a=e.MAs(2);return e.KtG(a.open())}),e._UZ(1,"mat-icon",46),e.TgZ(2,"span",38),e._uU(3,"Filtrar"),e.qZA()(),e.TgZ(4,"button",47),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.getReportePorMarcaAsync())}),e.YNc(5,jo,1,1,"mat-icon",48)(6,$o,2,0,"span",22)(7,Ko,1,2,"mat-progress-spinner",23),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("svgIcon","heroicons_solid:adjustments-horizontal"),e.xp6(3),e.Q6J("color","primary")("disabled",t.filtroAnalisisVentasForm.invalid||t.isExportingReport||t.disabledExportar),e.xp6(1),e.Q6J("ngIf",!t.isExportingReport),e.xp6(1),e.Q6J("ngIf",!t.isExportingReport),e.xp6(1),e.Q6J("ngIf",t.isExportingReport)}}const Xo=()=>({"border-radius":"0",height:"50px"});function ea(o,i){1&o&&e._UZ(0,"ngx-skeleton-loader",49),2&o&&e.Q6J("theme",e.DdM(1,Xo))}function ta(o,i){if(1&o&&(e.TgZ(0,"div",52)(1,"div",53)(2,"div",54)(3,"div",55),e._UZ(4,"img",56),e.TgZ(5,"div",57),e._uU(6),e.qZA(),e.TgZ(7,"div")(8,"p",58),e._uU(9,"Aplique otros filtros de b\xfasqueda "),e.qZA()()()()()()),2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("src",t.imgNoDataHome,e.LSH),e.xp6(2),e.hij(" ",t.textoResultado,"")}}function oa(o,i){if(1&o&&(e.TgZ(0,"div",59)(1,"div",60)(2,"div",61),e._uU(3,"Evoluci\xf3n por Marcas y Fechas"),e.qZA()(),e.TgZ(4,"div",53)(5,"div",54)(6,"div",54),e._UZ(7,"apx-chart",62),e.qZA()()()(),e.TgZ(8,"div",63)(9,"div",60)(10,"div",64),e._uU(11," Totalizado por Marcas "),e.qZA(),e._UZ(12,"button",65),e.qZA(),e.TgZ(13,"div",54),e._UZ(14,"apx-chart",66),e.qZA()(),e.TgZ(15,"div",63)(16,"div",60)(17,"div",64),e._uU(18," Marcas Destacadas "),e.qZA()(),e.TgZ(19,"div",54),e._UZ(20,"apx-chart",67),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(7),e.Q6J("plotOptions",t.chartEvolucionVentasMarcaFecha.plotOptions)("series",t.chartEvolucionVentasMarcaFecha.series)("chart",t.chartEvolucionVentasMarcaFecha.chart)("xaxis",t.chartEvolucionVentasMarcaFecha.xaxis)("yaxis",t.chartEvolucionVentasMarcaFecha.yaxis)("tooltip",t.chartEvolucionVentasMarcaFecha.tooltip)("dataLabels",t.chartEvolucionVentasMarcaFecha.dataLabels)("labels",t.chartEvolucionVentasMarcaFecha.labels)("noData",t.chartEvolucionVentasMarcaFecha.noData)("grid",t.chartEvolucionVentasMarcaFecha.grid),e.xp6(7),e.Q6J("series",t.chartTotalizadoMarcas.series)("chart",t.chartTotalizadoMarcas.chart)("labels",t.chartTotalizadoMarcas.labels)("responsive",t.chartTotalizadoMarcas.responsive)("noData",t.chartTotalizadoMarcas.noData)("colors",t.chartTotalizadoMarcas.colors)("tooltip",t.chartTotalizadoMarcas.tooltip)("dataLabels",t.chartTotalizadoMarcas.dataLabels)("plotOptions",t.chartTotalizadoMarcas.plotOptions),e.xp6(6),e.Q6J("series",t.chartTopDiezMarcas.series)("chart",t.chartTopDiezMarcas.chart)("colors",t.chartTopDiezMarcas.colors)("dataLabels",t.chartTopDiezMarcas.dataLabels)("plotOptions",t.chartTopDiezMarcas.plotOptions)("tooltip",t.chartTopDiezMarcas.tooltip)("noData",t.chartTopDiezMarcas.noData)("xaxis",t.chartTopDiezMarcas.xaxis)}}function aa(o,i){if(1&o&&(e.TgZ(0,"div",50),e.YNc(1,ta,10,2,"div",51)(2,oa,21,27),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.um2(1,0==t.ventasAnalisisDataSource.distribucionVentasMarca.totalVentasMarcas.length?1:2)}}let me=(()=>{class o{constructor(t,r,a,n,l){this._securityService=t,this._formBuilder=r,this._toolService=a,this._detalleVentasService=n,this._inventarioService=l,this.disabledExportar=s.vU.False,this.decodeToken=this.obtenerInfouserInfoLogueado(),this.monedaInfo=this.obtenerInfoMoneda(),this.isExportingReport=s.vU.False,this.chartEvolucionVentasMarcaFecha={},this.chartTotalizadoMarcas={},this.chartTopDiezMarcas={},this.disabledBuscar=s.vU.False,this._unsubscribeAll=new k.x,this.skeleton=s.vU.False,this.minDate=this._toolService.getMinDateFIlter(),this.maxDate=this._toolService.getMaxDateFIlter(),this.imgNoDataHome=s.HZ.noDataHome,this.textoResultado=s.RO.NoDataResult,this.filtroRangoFecha=""}ngOnInit(){this.formFiltros(),this.showSkeleton(),this.getResumen(s.vU.False),this.getFilterComboConsulta()}formFiltros(){this.filtroAnalisisVentasForm=this._formBuilder.group({fechaVentaInicio:[this._toolService.getStartDateOfMonth(),[d.kI.required]],fechaVentaFin:[this._toolService.getEndDateOfMonth(),[d.kI.required]],marcas:[""]}),this.currencyNumberFormat=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda)}getFilterComboConsulta(){const t=new ne.Z;t.nombre="",t.idUsuario=this.decodeToken.idUsuario,(0,V.D)({dataMarcas:this._inventarioService.GetAllMarcaByFilterAsync(t)}).subscribe({next:r=>{this.allMarcasDataSource=r.dataMarcas,this.filtroAnalisisVentasForm.get("marcas")?.setValue(this.allMarcasDataSource)},error:r=>{this._toolService.showError(p.J.Transaction,p.J.Tittle),this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.True,console.log(r)}})}getResumen(t){this.showSkeleton();const r=this.obtenerRequest();this.disabledBuscar=s.vU.True,this._detalleVentasService.GetAnalisisMarcasByFilterAsync(r).subscribe(a=>{this.ventasAnalisisDataSource=a,this.disabledBuscar=s.vU.False,this.getFechaFiltroCadena(),this.generateCharts(),t&&this.closedDrawer(),this.hideSkeleton(),this.disabledExportar=a.distribucionVentasMarca.totalVentasMarcas.length>s.Q6.Cero?s.vU.False:s.vU.True},a=>{this._toolService.showError(p.J.Transaction,p.J.Tittle),this.disabledBuscar=s.vU.False,console.log(a),t&&this.closedDrawer()})}generateCharts(){this.rangoFecha=this.getRangeDate(),this.generarchartEvolucionVentasMarcaFecha(),this.generarchartTotalizadoMarcas(),this.generarChartTopDiezMarcas()}getRangeDate(){return this.ventasAnalisisDataSource.evolucionVentasFecha.fechaVenta.map(t=>this._toolService.formatoFecha(t))}generarchartEvolucionVentasMarcaFecha(){const t=this.ventasAnalisisDataSource.lstEvolucionVentasMarcaFecha.map(r=>({color:r.colorMarca,name:r.nombreMarca,data:this.rangoFecha.map(a=>{const n=r.datosVentasAgrupados.find(l=>this._toolService.formatoFecha(l.fechaVenta)===a);return n?n.montoVentaTotal:s.Q6.Cero})}));this.chartEvolucionVentasMarcaFecha={series:t,chart:{type:"bar",height:350,stacked:!0,toolbar:{show:!1}},noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},plotOptions:{bar:{horizontal:!1,columnWidth:"55%"}},dataLabels:{enabled:!1,style:{fontSize:"12px"}},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:this.rangoFecha,labels:{rotateAlways:!0,rotate:-45}},yaxis:{labels:{formatter:r=>this.currencyNumberFormat.format(r),style:{fontSize:"12px"}}},fill:{opacity:1},tooltip:{enabled:!0,y:{formatter:r=>this.currencyNumberFormat.format(r)}}}}generarchartTotalizadoMarcas(){const t=this.isMobilSize(),r=this.ventasAnalisisDataSource.distribucionVentasMarca.totalVentasMarcas.reduce((a,n)=>a+n,0);this.chartTotalizadoMarcas={chart:{type:"donut",fontFamily:"inherit",foreColor:"inherit",height:"95%"},responsive:[{breakpoint:600,options:{chart:{width:"100%",height:350},legend:{position:"bottom"}}}],labels:this.ventasAnalisisDataSource.distribucionVentasMarca.nombreMarcas,series:this.ventasAnalisisDataSource.distribucionVentasMarca.totalVentasMarcas,noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},colors:this.ventasAnalisisDataSource.distribucionVentasMarca.coloresMarcas,tooltip:{enabled:!0,y:{formatter:a=>this.currencyNumberFormat.format(a)}},dataLabels:{enabled:!0},plotOptions:{pie:{donut:{labels:{show:!0,name:{show:!1},value:{show:!0,fontSize:t?"19px":"22px",color:"#494949",offsetY:0,formatter:()=>this.currencyNumberFormat.format(r)},total:{show:!0,showAlways:!0,label:"",fontSize:t?"19px":"22px",color:"#494949",formatter:()=>this.currencyNumberFormat.format(r)}}}}}}}generarChartTopDiezMarcas(){const t=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda);this.chartTopDiezMarcas={series:[{name:"Total",data:this.ventasAnalisisDataSource.topDiezMarcasVentas.totalMontos}],noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},colors:this.ventasAnalisisDataSource.topDiezMarcasVentas.colores,chart:{type:"bar",height:350,toolbar:{show:!1}},plotOptions:{bar:{barHeight:"100%",distributed:!0,horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,textAnchor:"middle",formatter:function(r){return t.format(r)},offsetY:-6,style:{colors:["#FFFFFF"],fontSize:"12px",fontWeight:"bold"},dropShadow:{enabled:!0,top:1,left:1,blur:2,color:"#000000",opacity:.5}},stroke:{width:1,colors:["#fff"]},tooltip:{enabled:!0,y:{formatter:r=>t.format(r)}},xaxis:{categories:this.ventasAnalisisDataSource.topDiezMarcasVentas.marcas,labels:{show:!1,style:{fontSize:"12px"},formatter:function(r){return"number"==typeof r?t.format(r):r}}}}}getReportePorMarcaAsync(){if(this.ventasAnalisisDataSource.distribucionVentasMarca.totalVentasMarcas.length==s.Q6.Cero&&this.ventasAnalisisDataSource.distribucionVentasMarca.totalVentasMarcas.length==s.Q6.Cero||this.filtroAnalisisVentasForm.invalid)return;const t=this.obtenerRequestReporte();this.isExportingReport=s.vU.True,this._detalleVentasService.GetReportePorMarcasAsync(t).subscribe(r=>{if(this.isExportingReport=s.vU.False,r){const a=window.URL.createObjectURL(new Blob([r],{type:"application/vnd.ms-excel"})),n=document.createElement("a");n.download=`Reporte_Venta_Por_Marca_${this.getFechaFiltroCadenaReporte()}.xlsx`,n.href=a,n.click(),n.parentNode?.removeChild(n)}},r=>{if(r.status==s.GL.Forbidden)return this._toolService.showWarning(p.T.InvalidPermisos,p.T.Tittle),this.isExportingReport=s.vU.False=s.vU.False,void console.log(r);this._toolService.showError(p.J.Transaction,p.J.Tittle),this.isExportingReport=s.vU.False,console.log(r)})}getFechaFiltroCadenaReporte(){return`del_${this._toolService.formatoFecha(this.fechaInicio)}_hasta_${this._toolService.formatoFecha(this.fechaFin)}`.trim()}isMobilSize(){return this._toolService.isMobilSize()}obtenerRequest(){const t=new ce.p;return t.destinationTimeZoneId=this._toolService.getTimeZone(),t.idUsuario=this.decodeToken.idUsuario,t.fechaVentaInicio=""==this.filtroAnalisisVentasForm.get("fechaVentaInicio").value?null:this.filtroAnalisisVentasForm.get("fechaVentaInicio").value,t.fechaVentaFin=""==this.filtroAnalisisVentasForm.get("fechaVentaFin").value?null:this.filtroAnalisisVentasForm.get("fechaVentaFin").value,t.lstMarca=[],this.selectMarcas&&this.selectMarcas.options.filter(a=>1==a.selected&&0!=a.value).forEach(a=>{t.lstMarca?.push(a.value.id)}),this.fechaInicio=t.fechaVentaInicio,this.fechaFin=t.fechaVentaFin,t}obtenerRequestReporte(){const t=new ce.p;return t.destinationTimeZoneId=this._toolService.getTimeZone(),t.idUsuario=this.decodeToken.idUsuario,t.fechaVentaInicio=""==this.filtroAnalisisVentasForm.get("fechaVentaInicio").value?null:this.filtroAnalisisVentasForm.get("fechaVentaInicio").value,t.fechaVentaFin=""==this.filtroAnalisisVentasForm.get("fechaVentaFin").value?null:this.filtroAnalisisVentasForm.get("fechaVentaFin").value,t.lstMarca=[],this.fechaInicio=t.fechaVentaInicio,this.fechaFin=t.fechaVentaFin,this.selectMarcas&&this.selectMarcas.options.filter(a=>1==a.selected&&0!=a.value).forEach(a=>{t.lstMarca?.push(a.value.id)}),t}getFechaFiltroCadena(){const t=this._toolService.formatoFecha(this.fechaInicio),r=this._toolService.formatoFecha(this.fechaFin);this.filtroRangoFecha=`Desde ${t} Hasta ${r}`.trim()}obtenerInfouserInfoLogueado(){return this._securityService.getDecodetoken()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closedDrawer(){this.matDrawer.close()}showSkeleton(){this.skeleton=s.vU.Show}hideSkeleton(){this.skeleton=s.vU.Hide}obtenerInfoMoneda(){return this._securityService.getMonedaStorage()}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(R.I),e.Y36(d.QS),e.Y36(y.o),e.Y36(O.n),e.Y36(Q.I))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-reporte-ventas-marcas-page"]],viewQuery:function(r,a){if(1&r&&(e.Gf(qo,5),e.Gf(Jo,5)),2&r){let n;e.iGM(n=e.CRH())&&(a.selectMarcas=n.first),e.iGM(n=e.CRH())&&(a.matDrawer=n.first)}},decls:57,vars:33,consts:[[1,"flex-auto","h-full"],["autoFocus","false",1,"w-90",3,"mode"],["matDrawer",""],[1,"flex","items-center","justify-between","m-4","mr-3","sm:my-5"],[1,"text-3xl","font-semibold","tracking-tight","leading-8"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"flex","flex-col","flex-auto","h-full","dark:bg-default"],[1,"flex","flex-col","flex-auto","shrink-0","pt-6","bg-card","dark:bg-transparent"],[1,"flex","flex-col","px-6",3,"formGroup"],[1,"w-full",3,"appearance"],["autocomplete","off","matInput","",3,"min","max","matDatepicker","formControlName","click"],["matSuffix","",3,"for"],["pickerInicio",""],[4,"ngIf"],["pickerFin",""],["multiple","",3,"formControlName"],["selectMarcaItem",""],[3,"model","values"],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","",1,"mt-4","mb-8",3,"color","disabled","click"],["class","icon-size-2",3,"svgIcon",4,"ngIf"],["class","ml-2",4,"ngIf"],[3,"diameter","mode",4,"ngIf"],[1,"flex","flex-col"],[1,"flex","flex-col","flex-auto","w-full"],[1,"flex","flex-wrap","w-full","max-w-screen-xl","mx-auto","p-6","md:p-8"],[1,"flex","items-center","justify-between","w-full"],[1,"text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-8"],[1,"font-medium","tracking-tight","text-secondary"],[1,"flex","items-center","ml-6"],[1,"grid","grid-cols-1","xl:grid-cols-1","gap-8","w-full","mt-6"],["class"," sm:col-span-2 md:col-span-4 flex flex-col flex-auto p-6 bg-card shadow rounded-2xl overflow-hidden","count","40",3,"theme",4,"ngIf"],["class","grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 w-full min-w-0",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"color-indicator"],[3,"value"],[1,"icon-size-2",3,"svgIcon"],[1,"ml-2"],[3,"diameter","mode"],["mat-icon-button","",3,"matMenuTriggerFor"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"ml-1"],["mat-menu-item","",3,"disabled","click"],["mat-stroked-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-flat-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"color","disabled","click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],["count","40",1,"sm:col-span-2","md:col-span-4","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden",3,"theme"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-4","gap-6","w-full","min-w-0"],["class","sm:col-span-2 md:col-span-4 flex flex-col    overflow-hidden"],[1,"sm:col-span-2","md:col-span-4","flex","flex-col","overflow-hidden"],[1,"grid","grid-cols-1","lg:grid-cols-1","grid-flow-row","gap-6","w-full","mt-8","sm:mt-4"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","items-center"],["alt","No hay datos disponibles",1,"w-72","object-cover",3,"src"],[1,"mt-4","sm:mt-8","text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-tight","md:leading-none","text-center"],[1,"mt-2","text-gray-500","text-center"],[1,"sm:col-span-2","md:col-span-4","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"flex","justify-between","items-center"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate"],[3,"plotOptions","series","chart","xaxis","yaxis","tooltip","dataLabels","labels","noData","grid"],[1,"sm:col-span-2","lg:col-span-2","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate","text-black"],["mat-icon-button","","color","primary"],[1,"flex-auto","w-full","h-80",3,"series","chart","labels","responsive","noData","colors","tooltip","dataLabels","plotOptions"],[3,"series","chart","colors","dataLabels","plotOptions","tooltip","noData","xaxis"]],template:function(r,a){if(1&r){const n=e.EpF();e.TgZ(0,"mat-drawer-container",0)(1,"mat-drawer",1,2)(3,"div",3)(4,"div",4),e._uU(5,"Filtrar por:"),e.qZA(),e.TgZ(6,"div")(7,"button",5),e.NdJ("click",function(){e.CHM(n);const c=e.MAs(2);return e.KtG(c.close())}),e._UZ(8,"mat-icon",6),e.qZA()()(),e.TgZ(9,"div",7)(10,"div",8)(11,"form",9)(12,"mat-form-field",10)(13,"mat-label"),e._uU(14,"Fecha Venta Inicio"),e.qZA(),e.TgZ(15,"input",11),e.NdJ("click",function(){e.CHM(n);const c=e.MAs(18);return e.KtG(c.open())}),e.qZA(),e._UZ(16,"mat-datepicker-toggle",12)(17,"mat-datepicker",null,13),e.YNc(19,Qo,2,0,"mat-error",14),e.qZA(),e.TgZ(20,"mat-form-field",10)(21,"mat-label"),e._uU(22,"Fecha Venta Fin"),e.qZA(),e.TgZ(23,"input",11),e.NdJ("click",function(){e.CHM(n);const c=e.MAs(26);return e.KtG(c.open())}),e.qZA(),e._UZ(24,"mat-datepicker-toggle",12)(25,"mat-datepicker",null,15),e.YNc(27,Vo,2,0,"mat-error",14),e.qZA(),e.TgZ(28,"mat-form-field",10)(29,"mat-label"),e._uU(30,"Marcas"),e.qZA(),e.TgZ(31,"mat-select",16,17)(33,"mat-select-trigger"),e.YNc(34,zo,2,1,"ng-container",14),e.qZA(),e._UZ(35,"app-selectAll",18),e.YNc(36,Ho,3,4,"mat-option",19),e.qZA(),e.YNc(37,Bo,2,0,"mat-error",14),e.qZA(),e.TgZ(38,"button",20),e.NdJ("click",function(){return a.getResumen(!0)}),e.YNc(39,Go,1,1,"mat-icon",21)(40,Oo,2,0,"span",22)(41,Yo,1,2,"mat-progress-spinner",23),e.qZA()()()()(),e.TgZ(42,"mat-drawer-content",24)(43,"div",25)(44,"div",26)(45,"div",27)(46,"div")(47,"h2",28),e._uU(48,"Reporte de Ventas por Marcas "),e.qZA(),e.TgZ(49,"div",29),e._uU(50),e.qZA()(),e.TgZ(51,"div",30),e.YNc(52,Lo,12,5)(53,Wo,8,6),e.qZA()(),e.TgZ(54,"div",31),e.YNc(55,ea,1,2,"ngx-skeleton-loader",32)(56,aa,3,1,"div",33),e.qZA()()()()()}if(2&r){const n=e.MAs(18),l=e.MAs(26),c=e.MAs(32);e.xp6(1),e.Q6J("mode","over"),e.xp6(7),e.Q6J("svgIcon","heroicons_outline:x-mark"),e.xp6(3),e.Q6J("formGroup",a.filtroAnalisisVentasForm),e.xp6(1),e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",n)("formControlName","fechaVentaInicio"),e.xp6(1),e.Q6J("for",n),e.xp6(3),e.Q6J("ngIf",a.filtroAnalisisVentasForm.get("fechaVentaInicio").hasError("required")),e.xp6(1),e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",l)("formControlName","fechaVentaFin"),e.xp6(1),e.Q6J("for",l),e.xp6(3),e.Q6J("ngIf",a.filtroAnalisisVentasForm.get("fechaVentaFin").hasError("required")),e.xp6(1),e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("formControlName","marcas"),e.xp6(3),e.Q6J("ngIf",(null==c.value?null:c.value.length)>0),e.xp6(1),e.Q6J("model",a.filtroAnalisisVentasForm.get("marcas"))("values",a.allMarcasDataSource),e.xp6(1),e.Q6J("ngForOf",a.allMarcasDataSource),e.xp6(1),e.Q6J("ngIf",a.filtroAnalisisVentasForm.get("marcas").hasError("required")),e.xp6(1),e.Q6J("color","primary")("disabled",a.filtroAnalisisVentasForm.invalid||a.disabledBuscar),e.xp6(1),e.Q6J("ngIf",!a.disabledBuscar),e.xp6(1),e.Q6J("ngIf",!a.disabledBuscar),e.xp6(1),e.Q6J("ngIf",a.disabledBuscar),e.xp6(9),e.hij("",a.filtroRangoFecha," "),e.xp6(2),e.um2(52,a.isMobilSize()?52:53),e.xp6(3),e.Q6J("ngIf",a.skeleton),e.xp6(1),e.Q6J("ngIf",!a.skeleton)}},dependencies:[g.sg,g.O5,N.K,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,q.Nt,f.KE,f.hX,f.TO,f.R9,v.VK,v.OP,v.p6,S.gD,S.$L,I.ey,Y.x,J.Ou,b.jA,b.kh,b.LW,Z.lW,Z.RK,D.Hw,T.Mq,T.hl,T.nW,z.xr]})}return o})();var de=m(6538);const ra=["selectProductoItem"],ia=["matDrawer"];function na(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Fecha Venta inicio es requerido"),e.qZA())}function sa(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Fecha Venta fin es requerido"),e.qZA())}function la(o,i){1&o&&(e.ynx(0),e._uU(1,", "),e.BQk())}function ca(o,i){if(1&o&&(e.TgZ(0,"span"),e._UZ(1,"span",35),e._uU(2),e.YNc(3,la,2,0,"ng-container",14),e.qZA()),2&o){const t=i.$implicit,r=i.index;e.oxw(2);const a=e.MAs(32);e.xp6(1),e.Udp("background-color",null==t?null:t.color),e.xp6(1),e.hij(" ",t.nombre||"",""),e.xp6(1),e.Q6J("ngIf",r<a.value.length-1)}}function ma(o,i){if(1&o&&(e.ynx(0),e.YNc(1,ca,4,4,"span",34),e.BQk()),2&o){e.oxw();const t=e.MAs(32);e.xp6(1),e.Q6J("ngForOf",t.value)}}function da(o,i){if(1&o&&(e.TgZ(0,"mat-option",36),e._UZ(1,"span",35),e._uU(2),e.qZA()),2&o){const t=i.$implicit;e.Q6J("value",t),e.xp6(1),e.Udp("background-color",t.color),e.xp6(1),e.hij(" ",t.nombre,"")}}function pa(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Producto es requerido"),e.qZA())}function ua(o,i){1&o&&e._UZ(0,"mat-icon",37),2&o&&e.Q6J("svgIcon","heroicons_solid:magnifying-glass")}function ga(o,i){1&o&&(e.TgZ(0,"span",38),e._uU(1,"Buscar"),e.qZA())}function ha(o,i){1&o&&e._UZ(0,"mat-progress-spinner",39),2&o&&e.Q6J("diameter",24)("mode","indeterminate")}function fa(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",40),e._UZ(1,"mat-icon",6),e.qZA(),e.TgZ(2,"mat-menu",null,41)(4,"button",42),e.NdJ("click",function(){e.CHM(t),e.oxw();const a=e.MAs(2);return e.KtG(a.open())}),e._UZ(5,"mat-icon",6),e.TgZ(6,"span",43),e._uU(7,"Filtrar"),e.qZA()(),e.TgZ(8,"button",44),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.getReportePorProductoAsync())}),e._UZ(9,"mat-icon",6),e.TgZ(10,"span",43),e._uU(11,"Exportar"),e.qZA()()()}if(2&o){const t=e.MAs(3),r=e.oxw();e.Q6J("matMenuTriggerFor",t),e.xp6(1),e.Q6J("svgIcon","heroicons_mini:ellipsis-vertical"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:adjustments-horizontal"),e.xp6(3),e.Q6J("disabled",r.filtroAnalisisVentasForm.invalid||r.isExportingReport||r.disabledExportar),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:arrow-up-tray")}}function _a(o,i){1&o&&e._UZ(0,"mat-icon",46),2&o&&e.Q6J("svgIcon","heroicons_solid:arrow-up-tray")}function xa(o,i){1&o&&(e.TgZ(0,"span",38),e._uU(1,"Exportar"),e.qZA())}function Ca(o,i){1&o&&e._UZ(0,"mat-progress-spinner",39),2&o&&e.Q6J("diameter",24)("mode","indeterminate")}function va(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(t),e.oxw();const a=e.MAs(2);return e.KtG(a.open())}),e._UZ(1,"mat-icon",46),e.TgZ(2,"span",38),e._uU(3,"Filtrar"),e.qZA()(),e.TgZ(4,"button",47),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.getReportePorProductoAsync())}),e.YNc(5,_a,1,1,"mat-icon",48)(6,xa,2,0,"span",22)(7,Ca,1,2,"mat-progress-spinner",23),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("svgIcon","heroicons_solid:adjustments-horizontal"),e.xp6(3),e.Q6J("color","primary")("disabled",t.filtroAnalisisVentasForm.invalid||t.isExportingReport||t.disabledExportar),e.xp6(1),e.Q6J("ngIf",!t.isExportingReport),e.xp6(1),e.Q6J("ngIf",!t.isExportingReport),e.xp6(1),e.Q6J("ngIf",t.isExportingReport)}}const ba=()=>({"border-radius":"0",height:"50px"});function Ta(o,i){1&o&&e._UZ(0,"ngx-skeleton-loader",49),2&o&&e.Q6J("theme",e.DdM(1,ba))}function Za(o,i){if(1&o&&(e.TgZ(0,"div",52)(1,"div",53)(2,"div",54)(3,"div",55),e._UZ(4,"img",56),e.TgZ(5,"div",57),e._uU(6),e.qZA(),e.TgZ(7,"div")(8,"p",58),e._uU(9,"Aplique otros filtros de b\xfasqueda "),e.qZA()()()()()()),2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("src",t.imgNoDataHome,e.LSH),e.xp6(2),e.hij(" ",t.textoResultado,"")}}function Aa(o,i){if(1&o&&(e.TgZ(0,"div",59)(1,"div",60)(2,"div",61),e._uU(3,"Evoluci\xf3n por Productos y Fechas"),e.qZA()(),e.TgZ(4,"div",53)(5,"div",54)(6,"div",54),e._UZ(7,"apx-chart",62),e.qZA()()()(),e.TgZ(8,"div",63)(9,"div",60)(10,"div",64),e._uU(11," Totalizado por Productos "),e.qZA(),e._UZ(12,"button",65),e.qZA(),e.TgZ(13,"div",54),e._UZ(14,"apx-chart",66),e.qZA()(),e.TgZ(15,"div",63)(16,"div",60)(17,"div",64),e._uU(18," Productos Destacadas "),e.qZA()(),e.TgZ(19,"div",54),e._UZ(20,"apx-chart",67),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(7),e.Q6J("plotOptions",t.chartEvolucionVentasProductoFecha.plotOptions)("series",t.chartEvolucionVentasProductoFecha.series)("chart",t.chartEvolucionVentasProductoFecha.chart)("xaxis",t.chartEvolucionVentasProductoFecha.xaxis)("yaxis",t.chartEvolucionVentasProductoFecha.yaxis)("tooltip",t.chartEvolucionVentasProductoFecha.tooltip)("dataLabels",t.chartEvolucionVentasProductoFecha.dataLabels)("labels",t.chartEvolucionVentasProductoFecha.labels)("noData",t.chartEvolucionVentasProductoFecha.noData)("grid",t.chartEvolucionVentasProductoFecha.grid),e.xp6(7),e.Q6J("series",t.chartTotalizadoProductos.series)("chart",t.chartTotalizadoProductos.chart)("labels",t.chartTotalizadoProductos.labels)("responsive",t.chartTotalizadoProductos.responsive)("noData",t.chartTotalizadoProductos.noData)("colors",t.chartTotalizadoProductos.colors)("tooltip",t.chartTotalizadoProductos.tooltip)("dataLabels",t.chartTotalizadoProductos.dataLabels)("plotOptions",t.chartTotalizadoProductos.plotOptions),e.xp6(6),e.Q6J("series",t.chartTopDiezProductos.series)("chart",t.chartTopDiezProductos.chart)("colors",t.chartTopDiezProductos.colors)("dataLabels",t.chartTopDiezProductos.dataLabels)("plotOptions",t.chartTopDiezProductos.plotOptions)("tooltip",t.chartTopDiezProductos.tooltip)("noData",t.chartTopDiezProductos.noData)("xaxis",t.chartTopDiezProductos.xaxis)}}function Fa(o,i){if(1&o&&(e.TgZ(0,"div",50),e.YNc(1,Za,10,2,"div",51)(2,Aa,21,27),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.um2(1,0==t.ventasAnalisisDataSource.distribucionVentasProducto.totalVentasProductos.length?1:2)}}const wa=[{path:"compras",children:[{path:"registro",component:oe,data:{title:"Registro de Compras"}},{path:"historial",component:ie,data:{title:"Historial de Compras"}},{path:"reporte-categorias",component:le,data:{title:"Reporte de Compras por Categor\xedas"}},{path:"reporte-marcas",component:me,data:{title:"Reporte de Compras por Marcas"}},{path:"reporte-productos",component:(()=>{class o{constructor(t,r,a,n,l){this._securityService=t,this._formBuilder=r,this._toolService=a,this._detalleVentasService=n,this._inventarioService=l,this.disabledExportar=s.vU.False,this.decodeToken=this.obtenerInfouserInfoLogueado(),this.monedaInfo=this.obtenerInfoMoneda(),this.isExportingReport=s.vU.False,this.chartEvolucionVentasProductoFecha={},this.chartTotalizadoProductos={},this.chartTopDiezProductos={},this.disabledBuscar=s.vU.False,this._unsubscribeAll=new k.x,this.skeleton=s.vU.False,this.minDate=this._toolService.getMinDateFIlter(),this.maxDate=this._toolService.getMaxDateFIlter(),this.imgNoDataHome=s.HZ.noDataHome,this.textoResultado=s.RO.NoDataResult,this.filtroRangoFecha=""}ngOnInit(){this.formFiltros(),this.showSkeleton(),this.getResumen(s.vU.False),this.getFilterComboConsulta()}formFiltros(){this.filtroAnalisisVentasForm=this._formBuilder.group({fechaVentaInicio:[this._toolService.getStartDateOfMonth(),[d.kI.required]],fechaVentaFin:[this._toolService.getEndDateOfMonth(),[d.kI.required]],productos:[""]}),this.currencyNumberFormat=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda)}getFilterComboConsulta(){(0,V.D)({dataProductos:this._inventarioService.GetAllProductoForComboBoxAsync()}).subscribe({next:t=>{this.allProductosDataSource=t.dataProductos,this.filtroAnalisisVentasForm.get("productos")?.setValue(this.allProductosDataSource)},error:t=>{this._toolService.showError(p.J.Transaction,p.J.Tittle),this.disabledBuscar=s.vU.False,this.disabledExportar=s.vU.True,console.log(t)}})}getResumen(t){this.showSkeleton();const r=this.obtenerRequest();this.disabledBuscar=s.vU.True,this._detalleVentasService.GetAnalisisProductosByFilterAsync(r).subscribe(a=>{this.ventasAnalisisDataSource=a,this.disabledBuscar=s.vU.False,this.getFechaFiltroCadena(),this.generateCharts(),t&&this.closedDrawer(),this.hideSkeleton(),this.disabledExportar=a.distribucionVentasProducto.totalVentasProductos.length>s.Q6.Cero?s.vU.False:s.vU.True},a=>{this._toolService.showError(p.J.Transaction,p.J.Tittle),this.disabledBuscar=s.vU.False,console.log(a),t&&this.closedDrawer()})}generateCharts(){this.rangoFecha=this.getRangeDate(),this.generarchartEvolucionVentasProductoFecha(),this.generarchartTotalizadoProductos(),this.generarChartTopDiezProductos()}getRangeDate(){return this.ventasAnalisisDataSource.evolucionVentasFecha.fechaVenta.map(t=>this._toolService.formatoFecha(t))}generarchartEvolucionVentasProductoFecha(){const t=this.ventasAnalisisDataSource.lstEvolucionVentasProductoFecha.map(r=>({color:r.colorProducto,name:r.nombreProducto,data:this.rangoFecha.map(a=>{const n=r.datosVentasAgrupados.find(l=>this._toolService.formatoFecha(l.fechaVenta)===a);return n?n.montoVentaTotal:s.Q6.Cero})}));this.chartEvolucionVentasProductoFecha={series:t,chart:{type:"bar",height:350,stacked:!0,toolbar:{show:!1}},noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},plotOptions:{bar:{horizontal:!1,columnWidth:"55%"}},dataLabels:{enabled:!1,style:{fontSize:"12px"}},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:this.rangoFecha,labels:{rotateAlways:!0,rotate:-45}},yaxis:{labels:{formatter:r=>this.currencyNumberFormat.format(r),style:{fontSize:"12px"}}},fill:{opacity:1},tooltip:{enabled:!0,y:{formatter:r=>this.currencyNumberFormat.format(r)}}}}generarchartTotalizadoProductos(){const t=this.isMobilSize(),r=this.ventasAnalisisDataSource.distribucionVentasProducto.totalVentasProductos.reduce((a,n)=>a+n,0);this.chartTotalizadoProductos={chart:{type:"donut",fontFamily:"inherit",foreColor:"inherit",height:"95%"},responsive:[{breakpoint:600,options:{chart:{width:"100%",height:350},legend:{position:"bottom"}}}],labels:this.ventasAnalisisDataSource.distribucionVentasProducto.nombreProductos,series:this.ventasAnalisisDataSource.distribucionVentasProducto.totalVentasProductos,noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},colors:this.ventasAnalisisDataSource.distribucionVentasProducto.coloresProductos,tooltip:{enabled:!0,y:{formatter:a=>this.currencyNumberFormat.format(a)}},dataLabels:{enabled:!0},plotOptions:{pie:{donut:{labels:{show:!0,name:{show:!1},value:{show:!0,fontSize:t?"19px":"22px",color:"#494949",offsetY:0,formatter:()=>this.currencyNumberFormat.format(r)},total:{show:!0,showAlways:!0,label:"",fontSize:t?"19px":"22px",color:"#494949",formatter:()=>this.currencyNumberFormat.format(r)}}}}}}}generarChartTopDiezProductos(){const t=this._toolService.getCurrencyNumberFormat(this.monedaInfo.codigoMoneda);this.chartTopDiezProductos={series:[{name:"Total",data:this.ventasAnalisisDataSource.topDiezProductosVentas.totalMontos}],noData:{text:"Seleccione una categor\xeda",align:"center",verticalAlign:"middle",style:{color:"#000000",fontSize:"14px"}},colors:this.ventasAnalisisDataSource.topDiezProductosVentas.colores,chart:{type:"bar",height:350,toolbar:{show:!1}},plotOptions:{bar:{barHeight:"100%",distributed:!0,horizontal:!0,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,textAnchor:"middle",formatter:function(r){return t.format(r)},offsetY:-6,style:{colors:["#FFFFFF"],fontSize:"12px",fontWeight:"bold"},dropShadow:{enabled:!0,top:1,left:1,blur:2,color:"#000000",opacity:.5}},stroke:{width:1,colors:["#fff"]},tooltip:{enabled:!0,y:{formatter:r=>t.format(r)}},xaxis:{categories:this.ventasAnalisisDataSource.topDiezProductosVentas.productos,labels:{show:!1,style:{fontSize:"12px"},formatter:function(r){return"number"==typeof r?t.format(r):r}}}}}getReportePorProductoAsync(){if(this.ventasAnalisisDataSource.distribucionVentasProducto.totalVentasProductos.length==s.Q6.Cero&&this.ventasAnalisisDataSource.distribucionVentasProducto.totalVentasProductos.length==s.Q6.Cero||this.filtroAnalisisVentasForm.invalid)return;const t=this.obtenerRequestReporte();this.isExportingReport=s.vU.True,this._detalleVentasService.GetReportePorProductosAsync(t).subscribe(r=>{if(this.isExportingReport=s.vU.False,r){const a=window.URL.createObjectURL(new Blob([r],{type:"application/vnd.ms-excel"})),n=document.createElement("a");n.download=`Reporte_Venta_Por_Productos_${this.getFechaFiltroCadenaReporte()}.xlsx`,n.href=a,n.click(),n.parentNode?.removeChild(n)}},r=>{if(r.status==s.GL.Forbidden)return this._toolService.showWarning(p.T.InvalidPermisos,p.T.Tittle),this.isExportingReport=s.vU.False=s.vU.False,void console.log(r);this._toolService.showError(p.J.Transaction,p.J.Tittle),this.isExportingReport=s.vU.False,console.log(r)})}getFechaFiltroCadenaReporte(){return`del_${this._toolService.formatoFecha(this.fechaInicio)}_hasta_${this._toolService.formatoFecha(this.fechaFin)}`.trim()}isMobilSize(){return this._toolService.isMobilSize()}obtenerRequest(){const t=new de.f;return t.destinationTimeZoneId=this._toolService.getTimeZone(),t.idUsuario=this.decodeToken.idUsuario,t.fechaVentaInicio=""==this.filtroAnalisisVentasForm.get("fechaVentaInicio").value?null:this.filtroAnalisisVentasForm.get("fechaVentaInicio").value,t.fechaVentaFin=""==this.filtroAnalisisVentasForm.get("fechaVentaFin").value?null:this.filtroAnalisisVentasForm.get("fechaVentaFin").value,t.lstProductos=[],this.selectProductos&&this.selectProductos.options.filter(a=>1==a.selected&&0!=a.value).forEach(a=>{t.lstProductos?.push(a.value.id)}),this.fechaInicio=t.fechaVentaInicio,this.fechaFin=t.fechaVentaFin,t}obtenerRequestReporte(){const t=new de.f;return t.destinationTimeZoneId=this._toolService.getTimeZone(),t.idUsuario=this.decodeToken.idUsuario,t.fechaVentaInicio=""==this.filtroAnalisisVentasForm.get("fechaVentaInicio").value?null:this.filtroAnalisisVentasForm.get("fechaVentaInicio").value,t.fechaVentaFin=""==this.filtroAnalisisVentasForm.get("fechaVentaFin").value?null:this.filtroAnalisisVentasForm.get("fechaVentaFin").value,t.lstProductos=[],this.fechaInicio=t.fechaVentaInicio,this.fechaFin=t.fechaVentaFin,this.selectProductos&&this.selectProductos.options.filter(a=>1==a.selected&&0!=a.value).forEach(a=>{t.lstProductos?.push(a.value.id)}),t}getFechaFiltroCadena(){const t=this._toolService.formatoFecha(this.fechaInicio),r=this._toolService.formatoFecha(this.fechaFin);this.filtroRangoFecha=`Desde ${t} Hasta ${r}`.trim()}obtenerInfouserInfoLogueado(){return this._securityService.getDecodetoken()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closedDrawer(){this.matDrawer.close()}showSkeleton(){this.skeleton=s.vU.Show}hideSkeleton(){this.skeleton=s.vU.Hide}obtenerInfoMoneda(){return this._securityService.getMonedaStorage()}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(R.I),e.Y36(d.QS),e.Y36(y.o),e.Y36(O.n),e.Y36(Q.I))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-reporte-ventas-productos-page"]],viewQuery:function(r,a){if(1&r&&(e.Gf(ra,5),e.Gf(ia,5)),2&r){let n;e.iGM(n=e.CRH())&&(a.selectProductos=n.first),e.iGM(n=e.CRH())&&(a.matDrawer=n.first)}},decls:57,vars:33,consts:[[1,"flex-auto","h-full"],["autoFocus","false",1,"w-90",3,"mode"],["matDrawer",""],[1,"flex","items-center","justify-between","m-4","mr-3","sm:my-5"],[1,"text-3xl","font-semibold","tracking-tight","leading-8"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"flex","flex-col","flex-auto","h-full","dark:bg-default"],[1,"flex","flex-col","flex-auto","shrink-0","pt-6","bg-card","dark:bg-transparent"],[1,"flex","flex-col","px-6",3,"formGroup"],[1,"w-full",3,"appearance"],["autocomplete","off","matInput","",3,"min","max","matDatepicker","formControlName","click"],["matSuffix","",3,"for"],["pickerInicio",""],[4,"ngIf"],["pickerFin",""],["multiple","",3,"formControlName"],["selectProductoItem",""],[3,"model","values"],[3,"value",4,"ngFor","ngForOf"],["mat-flat-button","",1,"mt-4","mb-8",3,"color","disabled","click"],["class","icon-size-2",3,"svgIcon",4,"ngIf"],["class","ml-2",4,"ngIf"],[3,"diameter","mode",4,"ngIf"],[1,"flex","flex-col"],[1,"flex","flex-col","flex-auto","w-full"],[1,"flex","flex-wrap","w-full","max-w-screen-xl","mx-auto","p-6","md:p-8"],[1,"flex","items-center","justify-between","w-full"],[1,"text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-8"],[1,"font-medium","tracking-tight","text-secondary"],[1,"flex","items-center","ml-6"],[1,"grid","grid-cols-1","xl:grid-cols-1","gap-8","w-full","mt-6"],["class"," sm:col-span-2 md:col-span-4 flex flex-col flex-auto p-6 bg-card shadow rounded-2xl overflow-hidden","count","40",3,"theme",4,"ngIf"],["class","grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 w-full min-w-0",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"color-indicator"],[3,"value"],[1,"icon-size-2",3,"svgIcon"],[1,"ml-2"],[3,"diameter","mode"],["mat-icon-button","",3,"matMenuTriggerFor"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"ml-1"],["mat-menu-item","",3,"disabled","click"],["mat-stroked-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-flat-button","",1,"hidden","sm:inline-flex","ml-3","sm:w-40","sm:h-10","sm:items-center","sm:justify-center",3,"color","disabled","click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],["count","40",1,"sm:col-span-2","md:col-span-4","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden",3,"theme"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-4","gap-6","w-full","min-w-0"],["class","sm:col-span-2 md:col-span-4 flex flex-col    overflow-hidden"],[1,"sm:col-span-2","md:col-span-4","flex","flex-col","overflow-hidden"],[1,"grid","grid-cols-1","lg:grid-cols-1","grid-flow-row","gap-6","w-full","mt-8","sm:mt-4"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","items-center"],["alt","No hay datos disponibles",1,"w-72","object-cover",3,"src"],[1,"mt-4","sm:mt-8","text-2xl","md:text-2xl","font-semibold","tracking-tight","leading-tight","md:leading-none","text-center"],[1,"mt-2","text-gray-500","text-center"],[1,"sm:col-span-2","md:col-span-4","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"flex","justify-between","items-center"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate"],[3,"plotOptions","series","chart","xaxis","yaxis","tooltip","dataLabels","labels","noData","grid"],[1,"sm:col-span-2","lg:col-span-2","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate","text-black"],["mat-icon-button","","color","primary"],[1,"flex-auto","w-full","h-80",3,"series","chart","labels","responsive","noData","colors","tooltip","dataLabels","plotOptions"],[3,"series","chart","colors","dataLabels","plotOptions","tooltip","noData","xaxis"]],template:function(r,a){if(1&r){const n=e.EpF();e.TgZ(0,"mat-drawer-container",0)(1,"mat-drawer",1,2)(3,"div",3)(4,"div",4),e._uU(5,"Filtrar por:"),e.qZA(),e.TgZ(6,"div")(7,"button",5),e.NdJ("click",function(){e.CHM(n);const c=e.MAs(2);return e.KtG(c.close())}),e._UZ(8,"mat-icon",6),e.qZA()()(),e.TgZ(9,"div",7)(10,"div",8)(11,"form",9)(12,"mat-form-field",10)(13,"mat-label"),e._uU(14,"Fecha Venta Inicio"),e.qZA(),e.TgZ(15,"input",11),e.NdJ("click",function(){e.CHM(n);const c=e.MAs(18);return e.KtG(c.open())}),e.qZA(),e._UZ(16,"mat-datepicker-toggle",12)(17,"mat-datepicker",null,13),e.YNc(19,na,2,0,"mat-error",14),e.qZA(),e.TgZ(20,"mat-form-field",10)(21,"mat-label"),e._uU(22,"Fecha Venta Fin"),e.qZA(),e.TgZ(23,"input",11),e.NdJ("click",function(){e.CHM(n);const c=e.MAs(26);return e.KtG(c.open())}),e.qZA(),e._UZ(24,"mat-datepicker-toggle",12)(25,"mat-datepicker",null,15),e.YNc(27,sa,2,0,"mat-error",14),e.qZA(),e.TgZ(28,"mat-form-field",10)(29,"mat-label"),e._uU(30,"Productos"),e.qZA(),e.TgZ(31,"mat-select",16,17)(33,"mat-select-trigger"),e.YNc(34,ma,2,1,"ng-container",14),e.qZA(),e._UZ(35,"app-selectAll",18),e.YNc(36,da,3,4,"mat-option",19),e.qZA(),e.YNc(37,pa,2,0,"mat-error",14),e.qZA(),e.TgZ(38,"button",20),e.NdJ("click",function(){return a.getResumen(!0)}),e.YNc(39,ua,1,1,"mat-icon",21)(40,ga,2,0,"span",22)(41,ha,1,2,"mat-progress-spinner",23),e.qZA()()()()(),e.TgZ(42,"mat-drawer-content",24)(43,"div",25)(44,"div",26)(45,"div",27)(46,"div")(47,"h2",28),e._uU(48,"Reporte de Ventas por Productos "),e.qZA(),e.TgZ(49,"div",29),e._uU(50),e.qZA()(),e.TgZ(51,"div",30),e.YNc(52,fa,12,5)(53,va,8,6),e.qZA()(),e.TgZ(54,"div",31),e.YNc(55,Ta,1,2,"ngx-skeleton-loader",32)(56,Fa,3,1,"div",33),e.qZA()()()()()}if(2&r){const n=e.MAs(18),l=e.MAs(26),c=e.MAs(32);e.xp6(1),e.Q6J("mode","over"),e.xp6(7),e.Q6J("svgIcon","heroicons_outline:x-mark"),e.xp6(3),e.Q6J("formGroup",a.filtroAnalisisVentasForm),e.xp6(1),e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",n)("formControlName","fechaVentaInicio"),e.xp6(1),e.Q6J("for",n),e.xp6(3),e.Q6J("ngIf",a.filtroAnalisisVentasForm.get("fechaVentaInicio").hasError("required")),e.xp6(1),e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("min",a.minDate)("max",a.maxDate)("matDatepicker",l)("formControlName","fechaVentaFin"),e.xp6(1),e.Q6J("for",l),e.xp6(3),e.Q6J("ngIf",a.filtroAnalisisVentasForm.get("fechaVentaFin").hasError("required")),e.xp6(1),e.Q6J("appearance","outline"),e.xp6(3),e.Q6J("formControlName","productos"),e.xp6(3),e.Q6J("ngIf",(null==c.value?null:c.value.length)>0),e.xp6(1),e.Q6J("model",a.filtroAnalisisVentasForm.get("productos"))("values",a.allProductosDataSource),e.xp6(1),e.Q6J("ngForOf",a.allProductosDataSource),e.xp6(1),e.Q6J("ngIf",a.filtroAnalisisVentasForm.get("productos").hasError("required")),e.xp6(1),e.Q6J("color","primary")("disabled",a.filtroAnalisisVentasForm.invalid||a.disabledBuscar),e.xp6(1),e.Q6J("ngIf",!a.disabledBuscar),e.xp6(1),e.Q6J("ngIf",!a.disabledBuscar),e.xp6(1),e.Q6J("ngIf",a.disabledBuscar),e.xp6(9),e.hij("",a.filtroRangoFecha," "),e.xp6(2),e.um2(52,a.isMobilSize()?52:53),e.xp6(3),e.Q6J("ngIf",a.skeleton),e.xp6(1),e.Q6J("ngIf",!a.skeleton)}},dependencies:[g.sg,g.O5,N.K,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,q.Nt,f.KE,f.hX,f.TO,f.R9,v.VK,v.OP,v.p6,S.gD,S.$L,I.ey,Y.x,J.Ou,b.jA,b.kh,b.LW,Z.lW,Z.RK,D.Hw,T.Mq,T.hl,T.nW,z.xr]})}return o})(),data:{title:"Reporte de Compras por Productos"}}]}];let ue=(()=>{class o{static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275mod=e.oAB({type:o});static#o=this.\u0275inj=e.cJS({imports:[$.Bz.forChild(wa),$.Bz]})}return o})();const Sa=[g.ez,j.m,ue],Pa=[{provide:I.Ad,useFactory:o=>o.getuserInfoLogueadoCultureInfo(),deps:[y.o]}];let ya=(()=>{class o{static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275mod=e.oAB({type:o});static#o=this.\u0275inj=e.cJS({providers:[g.uU,Pa],imports:[Sa,g.ez,j.m,ue]})}return o})()}}]);